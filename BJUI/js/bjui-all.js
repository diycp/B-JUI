+function(i){"use strict";var e={JSPATH:"BJUI/",PLUGINPATH:"BJUI/plugins/",IS_DEBUG:!1,KeyPressed:{ctrl:!1,shift:!1},keyCode:{ENTER:13,ESC:27,END:35,HOME:36,SHIFT:16,CTRL:17,TAB:9,LEFT:37,RIGHT:39,UP:38,DOWN:40,DELETE:46,BACKSPACE:8},eventType:{initUI:"bjui.initUI",beforeInitUI:"bjui.beforeInitUI",afterInitUI:"bjui.afterInitUI",ajaxStatus:"bjui.ajaxStatus",resizeGrid:"bjui.resizeGrid",beforeAjaxLoad:"bjui.beforeAjaxLoad",beforeLoadNavtab:"bjui.beforeLoadNavtab",beforeLoadDialog:"bjui.beforeLoadDialog",afterLoadNavtab:"bjui.afterLoadNavtab",afterLoadDialog:"bjui.afterLoadDialog",beforeCloseNavtab:"bjui.beforeCloseNavtab",beforeCloseDialog:"bjui.beforeCloseDialog",afterCloseNavtab:"bjui.afterCloseNavtab",afterCloseDialog:"bjui.afterCloseDialog"},pageInfo:{pageCurrent:"pageCurrent",pageSize:"pageSize",orderField:"orderField",orderDirection:"orderDirection"},alertMsg:{displayPosition:"topcenter",alertTimeout:6e3},ajaxTimeout:3e4,statusCode:{ok:200,error:300,timeout:301},keys:{statusCode:"statusCode",message:"message"},ui:{windowWidth:0,showSlidebar:!0,clientPaging:!0,overwriteHomeTab:!1},debug:function(i){this.IS_DEBUG&&("undefined"!=typeof console?console.log(i):alert(i))},loginInfo:{url:"login.html",title:"Login",width:420,height:260,mask:!0},loadLogin:function(){var e=this.loginInfo;i("body").dialog({id:"bjui-login",url:e.url,title:e.title,width:e.width,height:e.height,mask:e.mask})},init:function(t){var a=i.extend({},t);i.extend(e.statusCode,a.statusCode),i.extend(e.pageInfo,a.pageInfo),i.extend(e.alertMsg,a.alertMsg),i.extend(e.loginInfo,a.loginInfo),i.extend(e.keys,a.keys),i.extend(e.ui,a.ui),a.JSPATH&&(this.JSPATH=a.JSPATH),a.PLUGINPATH&&(this.PLUGINPATH=a.PLUGINPATH),a.ajaxTimeout&&(this.ajaxTimeout=a.ajaxTimeout),this.IS_DEBUG=a.debug||!1,this.initEnv(),i.cookie&&i.cookie("bjui_theme")||!a.theme||i(this).theme("setTheme",a.theme)},initEnv:function(){i(window).resize(function(){var t=i(this).width();e.ui.windowWidth&&e.ui.windowWidth>600&&e.ui.windowWidth<t&&(t=e.ui.windowWidth),e.initLayout(t),setTimeout(function(){i(this).trigger(e.eventType.resizeGrid)},30)}),setTimeout(function(){var t=i(window).width();e.ui.windowWidth&&e.ui.windowWidth>600&&e.ui.windowWidth<t&&(t=e.ui.windowWidth),e.initLayout(t),i(document).initui()},10)},initLayout:function(t){var a=t-(e.ui.showSlidebar?i("#bjui-sidebar").width()+6:6),o=i(window).height()-i("#bjui-header").height()-i("#bjui-footer").outerHeight(),n=i("#bjui-navtab").find(".tabsPageHeader").height();e.ui.windowWidth&&i("#bjui-window").width(t),e.windowWidth=t,i("#bjui-container").height(o),i("#bjui-navtab").width(a),i("#bjui-leftside, #bjui-sidebar, #bjui-sidebar-s, #bjui-splitBar, #bjui-splitBarProxy").css({height:"100%"}),i("#bjui-navtab .tabsPageContent").height(o-n-1),setTimeout(function(){i("#bjui-navtab > .tabsPageContent > .navtabPage").resizePageH(),i("#bjui-navtab > .tabsPageContent > .navtabPage").find(".bjui-layout").resizePageH()},10);var r=i("body").data("bjui.navbar.width"),d=i("#bjui-header"),u=d.find(".bjui-navbar-toggle"),b=d.find(".bjui-navbar-logo"),s=i("#bjui-navbar-collapse"),h=s.find(".bjui-navbar-right");r||(r={logoW:b.outerWidth(),navW:h.outerWidth()},i("body").data("bjui.navbar.width",r)),r&&(t-r.logoW<r.navW?(u.show(),s.addClass("collapse menu")):(u.hide(),s.removeClass("collapse menu in")));var l=i("#bjui-hnav-navbar-box"),g=l.find("> #bjui-hnav-navbar"),f=l.prev(),j=l.next(),v=l.width(),w=0;g.find("> li").each(function(e){var t=i(this);w+=t.outerWidth(),w>v?(j.show(),l.data("hnav.move",!0).data("hnav.liw",w)):(f.hide(),j.hide(),l.removeData("hnav.move"))})},regional:{},setRegional:function(i,t){e.regional[i]=t},getRegional:function(i){if(String(i).indexOf(".")>=0){for(var t,a=String(i).split("."),o=0;o<a.length;o++)t=t?t[a[o]]:e.regional[a[o]];return t}return e.regional[i]},doRegional:function(e,t){return i.each(t,function(i,t){e=e.replaceAll("#"+i+"#",t)}),e}};window.BJUI=e}(jQuery);
+function(e){"use strict";e(function(){BJUI.setRegional("alertmsg",{title:{error:"错误提示",info:"信息提示",warn:"警告信息",correct:"成功信息",confirm:"确认信息"},btnMsg:{ok:"确定",yes:"是",no:"否",cancel:"取消"}}),BJUI.setRegional("dialog",{close:"关闭",maximize:"最大化",restore:"还原",minimize:"最小化",title:"弹出窗口"}),BJUI.setRegional("orderby",{asc:"升序",desc:"降序"}),BJUI.setRegional("pagination",{total:"总记录数/总页数",first:"首页",last:"末页",prev:"上一页",next:"下一页",jumpto:"输入跳转页码，回车确认",jump:"跳转",page:"页",refresh:"刷新"}),BJUI.setRegional("datagrid",{asc:"升序",desc:"降序",showhide:"显示/隐藏 列",filter:"过滤",clear:"清除",lock:"锁定列",unlock:"解除锁定",add:"添加",edit:"编辑",save:"保存",update:"更新",cancel:"取消",del:"删除",prev:"上一条",next:"下一条",refresh:"刷新",query:"查询","import":"导入","export":"导出",all:"全部","true":"是","false":"否",selectMsg:"未选中任何行！",editMsg:"请先保存编辑行！",saveMsg:"没有需要保存的行！",delMsg:"确定要删除该行吗？",delMsgM:"确定要删除选中行？"}),BJUI.setRegional("progressmsg","正在努力加载数据，请稍等..."),BJUI.setRegional("datepicker",{close:"关闭",prev:"上月",next:"下月",clear:"清空",ok:"确定",dayNames:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]}),BJUI.setRegional("navtabCM",{refresh:"刷新本标签",close:"关闭本标签",closeother:"关闭其他标签",closeall:"关闭所有标签"}),BJUI.setRegional("dialogCM",{refresh:"刷新本窗口",close:"关闭本窗口",closeother:"关闭其他窗口",closeall:"关闭所有窗口"}),BJUI.setRegional("upload",{upConfirm:"开始上传",upPause:"暂停上传",upCancel:"取消上传"}),BJUI.setRegional("statusCode_503","服务器当前负载过大或者正在维护！"),BJUI.setRegional("sessiontimeout","会话超时，请重新登陆！"),BJUI.setRegional("plhmsg","占位符对应的选择器无有效值！"),BJUI.setRegional("nocheckgroup",'未定义选中项的组名[复选框的"data-group"]！'),BJUI.setRegional("notchecked","未选中任何一项！"),BJUI.setRegional("selectmsg","请选择一个选项！"),BJUI.setRegional("validatemsg","提交的表单中 [{0}] 个字段有错误，请更正后再提交！"),BJUI.setRegional("uititle","B-JUI"),BJUI.setRegional("maintab","我的主页"),e.validator&&e.validator.config({defaultMsg:"{0}格式不正确",loadingMsg:"正在验证...",rules:{digits:[/^\d+$/,"请输入整数"],number:[/^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/,"请输入有效的数字"],letters:[/^[a-z]+$/i,"{0}只能输入字母"],tel:[/^(?:(?:0\d{2,3}[\- ]?[1-9]\d{6,7})|(?:[48]00[\- ]?[1-9]\d{6}))$/,"电话格式不正确"],mobile:[/^(((1[38][0-9])|17[0678]|14[57]|(15[123567890]))\d{8})$/,"手机号格式不正确"],email:[/^[\w\+\-]+(\.[\w\+\-]+)*@[a-z\d\-]+(\.[a-z\d\-]+)*\.([a-z]{2,4})$/i,"邮箱格式不正确"],qq:[/^[1-9]\d{4,}$/,"QQ号格式不正确"],date:[/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/,"请输入正确的日期，例：yyyy-MM-dd"],time:[/^(2[0123]|(1|0?)[0-9]){1}:([0-5][0-9]){1}:([0-5][0-9]){1}$/,"请输入正确的时间，例：HH:mm:ss"],datetime:[/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])\s+(2[0123]|(1|0?)[0-9]){1}:([0-5][0-9]){1}:([0-5][0-9]){1}$/,"请输入正确的日期时间，例：yyyy-MM-dd HH:mm:ss"],ID_card:[/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[A-Z])$/,"请输入正确的身份证号码"],url:[/^(https?|ftp):\/\/[^\s]+$/i,"网址格式不正确"],postcode:[/^[1-9]\d{5}$/,"邮政编码格式不正确"],chinese:[/^[\u0391-\uFFE5]+$/,"请输入中文"],username:[/^\w{3,12}$/,"请输入3-12位数字、字母、下划线"],password:[/^[0-9a-zA-Z]{8,16}$/,"密码由8-16位数字、字母组成"],pattern:function(e,t){if(!t)return!0;var a=e.value.parseDate(t);return a?!0:this.renderMsg("错误的日期时间格式！",t)},accept:function(e,t){if(!t)return!0;var a=t[0];return"*"===a||new RegExp(".(?:"+(a||"png|jpg|jpeg|gif")+")$","i").test(e.value)||this.renderMsg("只接受{1}后缀",a.replace("|",","))}}}),e.validator&&e.validator.config({messages:{required:"{0}不能为空",remote:"{0}已被使用",integer:{"*":"请输入整数","+":"请输入正整数","+0":"请输入正整数或0","-":"请输入负整数","-0":"请输入负整数或0"},match:{eq:"{0}与{1}不一致",neq:"{0}与{1}不能相同",lt:"{0}必须小于{1}",gt:"{0}必须大于{1}",lte:"{0}必须小于或等于{1}",gte:"{0}必须大于或等于{1}"},range:{rg:"请输入{1}到{2}的数",gte:"请输入大于或等于{1}的数",lte:"请输入小于或等于{1}的数"},checked:{eq:"请选择{1}项",rg:"请选择{1}到{2}项",gte:"请至少选择{1}项",lte:"请最多选择{1}项"},length:{eq:"请输入{1}个字符",rg:"请输入{1}到{2}个字符",gte:"请至少输入{1}个字符",lte:"请最多输入{1}个字符",eq_2:"",rg_2:"",gte_2:"",lte_2:""}}})})}(jQuery);
+function(a){"use strict";BJUI.setRegional("alertmsg",{title:{error:"Error",info:"Info",warn:"Warning",correct:"Correct",confirm:"Confirm"},btnMsg:{ok:"OK",yes:"YES",no:"NO",cancel:"Cancel"}}),BJUI.setRegional("dialog",{close:"Close",maximize:"Maximize",restore:"Restore",minimize:"Minimize",title:"Popup window"}),BJUI.setRegional("orderby",{asc:"Asc",desc:"Desc"}),BJUI.setRegional("pagination",{first:"First page",last:"Last page",prev:"Prev page",next:"Next page",jumpto:"Jump page number",jump:"Jump"}),BJUI.setRegional("datagrid",{asc:"ASC",desc:"DESC",showhide:"Show/Hide columns",filter:"Filter",clear:"Clear",lock:"Lock",unlock:"Unlock",add:"Add",edit:"Edit",save:"Save",update:"Update",cancel:"Cancel",del:"Delete",prev:"Prev",next:"Next",refresh:"Refresh",query:"Query","import":"Import","export":"Export",all:"All","true":"True","false":"False",selectMsg:"Not selected any rows!",saveMsg:"No rows need to save!",editMsg:"Please save the edited row!",delMsg:"Sure you want to delete this row?",delMsgM:"Sure you want to delete selected rows?"}),BJUI.setRegional("progressmsg","Data loading, please waiting..."),BJUI.setRegional("datepicker",{close:"Close",prev:"Prev month",next:"Next month",clear:"Clear",ok:"OK",dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),BJUI.setRegional("navtabCM",{refresh:"Refresh navtab",close:"Close navtab",closeother:"Close other navtab",closeall:"Close all navtab"}),BJUI.setRegional("dialogCM",{refresh:"Refresh dialog",close:"Close dialog",closeother:"Close other dialog",closeall:"Close all dialog"}),BJUI.setRegional("upload",{upConfirm:"Start upload",upPause:"Pause upload",upCancel:"Cancel upload"}),BJUI.setRegional("statusCode_503","The current server load is too large or is down for maintenance!"),BJUI.setRegional("sessiontimeout","Session timeout, please login!"),BJUI.setRegional("plhmsg","Placeholder corresponding selector None Valid!"),BJUI.setRegional("nocheckgroup",'Undefined group name selected item [check box "data-group"]!'),BJUI.setRegional("notchecked","Unchecked any one!"),BJUI.setRegional("selectmsg","Please select one option!"),BJUI.setRegional("validatemsg","Submitted form data has [{0}] field an error, please after modified submitting!"),BJUI.setRegional("uititle","B-JUI"),BJUI.setRegional("maintab","My home"),window.FRAG={dialog:'<div class="bjui-dialog bjui-dialog-container" style="top:150px; left:300px;">    <div class="dialogHeader" onselectstart="return false;" oncopy="return false;" onpaste="return false;" oncut="return false;">        <a class="close" href="#close" title="#close#"><i class="fa fa-times-circle"></i></a>        <a class="maximize" href="#maximize" title="#maximize#"><i class="fa fa-plus-circle"></i></a>        <a class="restore" href="#restore" title="#restore#"><i class="fa fa-history"></i></a>        <a class="minimize" href="#minimize" title="#minimize#"><i class="fa fa-minus-circle"></i></a>        <h1><span><i class="fa fa-th-large"></i></span> <span class="title">#title#</span></h1>    </div>    <div class="dialogContent unitBox"></div>    <div class="resizable_h_l" tar="nw"></div>    <div class="resizable_h_r" tar="ne"></div>    <div class="resizable_h_c" tar="n"></div>    <div class="resizable_c_l" tar="w" style="height:100%;"></div>    <div class="resizable_c_r" tar="e" style="height:100%;"></div>    <div class="resizable_f_l" tar="sw"></div>    <div class="resizable_f_r" tar="se"></div>    <div class="resizable_f_c" tar="s"></div></div>',taskbar:'<div id="bjui-taskbar" style="left:0px; display:none;">    <div class="taskbarContent">        <ul></ul>    </div>    <div class="taskbarLeft taskbarLeftDisabled"><i class="fa fa-angle-double-left"></i></div>    <div class="taskbarRight"><i class="fa fa-angle-double-right"></i></div></div>',splitBar:'<div id="bjui-splitBar"></div>',splitBarProxy:'<div id="bjui-splitBarProxy"></div>',resizable:'<div id="bjui-resizable" class="bjui-resizable"></div>',alertBackground:'<div class="bjui-alertBackground"></div>',maskBackground:'<div class="bjui-maskBackground bjui-ajax-mask"></div>',maskProgress:'<div class="bjui-maskProgress bjui-ajax-mask"><i class="fa fa-cog fa-spin"></i>&nbsp;&nbsp;#msg#<div class="progressBg"><div class="progress"></div></div></div>',progressBar_custom:'<div id="bjui-progressBar-custom" class="progressBar"><i class="fa fa-cog fa-spin"></i> <span></span></div>',dialogMask:'<div class="bjui-dialogBackground"></div>',orderby:'<a href="javascript:;" class="order asc" data-order-direction="asc" title="#asc#"><i class="fa fa-angle-up"></i></a><a href="javascript:;" class="order desc" data-order-direction="desc" title="#desc#"><i class="fa fa-angle-down"></i></a>',slidePanel:'<div class="panel panel-default">    <div class="panel-heading">        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#bjui-accordionmenu" href="##id#" class="#class#">#icon#&nbsp;#title#<b>#righticon#</b></a></h4>    </div>    <div id="#id#" class="panel-collapse collapse#bodyclass#">        <div class="panel-body">        </div>    </div></div>',pagination:'<ul class="pagination">    <li class="j-first">        <a class="first" href="javascript:;"><i class="fa fa-step-backward"></i> #first#</a>        <span class="first"><i class="fa fa-step-backward"></i> #first#</span>    </li>    <li class="j-prev">        <a class="previous" href="javascript:;"><i class="fa fa-backward"></i> #prev#</a>        <span class="previous"><i class="fa fa-backward"></i> #prev#</span>    </li>    #pageNumFrag#    <li class="j-next">        <a class="next" href="javascript:;">#next# <i class="fa fa-forward"></i></a>        <span class="next">#next# <i class="fa fa-forward"></i></span>    </li>    <li class="j-last">        <a class="last" href="javascript:;">#last# <i class="fa fa-step-forward"></i></a>        <span class="last">#last# <i class="fa fa-step-forward"></i></span>    </li>    <li class="jumpto"><span class="p-input"><input class="form-control input-sm-pages" type="text" size="2.6" value="#pageCurrent#" title="#jumpto#"></span><a class="goto" href="javascript:;" title="#jump#"><i class="fa fa-chevron-right"></i></a></li></ul>',gridPaging:'<ul class="pagination">    <li class="page-total">        <span title="#total#">#count#</span>    </li>    <li class="page-jumpto"><span class="page-input"><input class="form-control input-sm-pages" type="text" size="3.2" value="#pageCurrent#" title="#jumpto#"></span></li>    <li class="page-first btn-nav">        <a href="javascript:;" title="#first#"><i class="fa fa-step-backward"></i></a>    </li>    <li class="page-prev btn-nav">        <a href="javascript:;" title="#prev#"><i class="fa fa-backward"></i></a>    </li>    <li class="page-next btn-nav">        <a href="javascript:;" title="#next#"><i class="fa fa-forward"></i></a>    </li>    <li class="page-last btn-nav">        <a href="javascript:;" title="#last#"><i class="fa fa-step-forward"></i></a>    </li></ul>',gridPageNum:'<li class="page-num#active#"><a href="javascript:;">#num#</a></li>',gridMenu:'<div class="datagrid-menu-box">    <ul>        <li class="datagrid-li-asc"><a href="javascript:;"><span class="icon"><i class="fa fa-sort-amount-asc"></i></span><span class="title">#asc#</span></a></li>        <li class="datagrid-li-desc"><a href="javascript:;"><span class="icon"><i class="fa fa-sort-amount-desc"></i></span><span class="title">#desc#</span></a></li>        <li class="datagrid-li-filter"><a href="javascript:;"><span class="icon"><i class="fa fa-filter"></i></span><span class="title">#filter#</span><span class="arrow"></span></a></li>        <li class="datagrid-li-showhide"><a href="javascript:;"><span class="icon"><i class="fa fa-check-square-o"></i></span><span class="title">#showhide#</span><span class="arrow"></span></a></li>        <li class="datagrid-li-lock"><a href="javascript:;"><span class="icon"><i class="fa fa-lock"></i></span><span class="title">#lock#</span></a></li>        <li class="datagrid-li-unlock disable"><a href="javascript:;"><span class="icon"><i class="fa fa-unlock"></i></span><span class="title">#unlock#</span></a></li>    </ul></div>',gridFilter:'<div class="datagrid-filter-box"><fieldset><legend>#label#</legend><span class="filter-a"></span><span class="filter-and"><select data-toggle="selectpicker" data-container="true" data-width="100%"><option value="and">AND</option><option value="or">OR</option></select></span><span class="filter-b"></span><span class="filter-ok"><button type="button" class="btn-green ok" data-icon="check">#filter#</button><button type="button" class="btn-orange clear" data-icon="remove">#clear#</button></span></fieldset></div>',gridShowhide:'<li data-index="#index#" class="datagrid-col-check"><a href="javascript:;"><i class="fa fa-check-square-o"></i>#label#</a></li>',gridEditBtn:'<button type="button" class="btn-green edit" data-icon="edit">#edit#</button><button type="button" class="btn-green update" data-icon="edit">#update#</button><button type="button" class="btn-green save" data-icon="check">#save#</button><button type="button" class="btn-orange cancel" data-icon="undo">#cancel#</button><button type="button" class="btn-orange delete" data-icon="remove">#del#</button>',gridDialogEditBtns:'<ul>    <li class="pull-left"><button type="button" class="btn btn-orange prev" data-icon="arrow-up">#prev#</button></li>    <li class="pull-left"><button type="button" class="btn btn-orange next" data-icon="arrow-down">#next#</button></li>    <li><button type="button" class="btn btn-red cancel" data-icon="remove">#cancel#</button></li>    <li><button type="button" class="btn btn-default save" data-icon="save">#save#</button></li></ul>',alertBoxFrag:'<div id="bjui-alertMsgBox" class="bjui-alert"><div class="alertContent"><div class="#type#"><div class="alertInner"><h1><i class="fa #fa#"></i>#title#</h1><div class="msg">#message#</div></div><div class="toolBar"><ul>#btnFragment#</ul></div></div></div></div>',alertBtnFrag:'<li><button class="btn btn-#class#" rel="#callback#" type="button">#btnMsg#</button></li>',calendarFrag:'<div id="bjui-calendar">    <div class="main">        <a class="close" href="javascript:;" title="#close#"><i class="fa fa-times-circle"></i></a>        <div class="head">            <table width="100%" border="0" cellpadding="0" cellspacing="2">                <tr>                    <td width="20"><a class="prev" href="javascript:;" title="#prev#"><i class="fa fa-arrow-left"></i></a></td>                    <td><select name="year"></select></td>                    <td><select name="month"></select></td>                    <td width="20"><a class="next" href="javascript:;" title="#next#"><i class="fa fa-arrow-right"></i></a></td>                </tr>            </table>        </div>        <div class="body">            <dl class="dayNames"><dt>7</dt><dt>1</dt><dt>2</dt><dt>3</dt><dt>4</dt><dt>5</dt><dt>6</dt></dl>            <dl class="days"><!-- date list --></dl>            <div style="clear:both;height:0;line-height:0"></div>        </div>        <div class="foot">            <table class="time">                <tr>                    <td>                        <input type="text" class="hh" maxlength="2" data-type="hh" data-start="0" data-end="23">:<input                         type="text" class="mm" maxlength="2" data-type="mm" data-start="0" data-end="59">:<input                         type="text" class="ss" maxlength="2" data-type="ss" data-start="0" data-end="59">                    </td>                    <td><ul><li class="up" data-add="1">&and;</li><li class="down">&or;</li></ul></td>                </tr>            </table>            <button type="button" class="clearBtn btn btn-orange">#clear#</button>            <button type="button" class="okBtn btn btn-default">#ok#</button>        </div>        <div class="tm">            <ul class="hh">                <li>0</li>                <li>1</li>                <li>2</li>                <li>3</li>                <li>4</li>                <li>5</li>                <li>6</li>                <li>7</li>                <li>8</li>                <li>9</li>                <li>10</li>                <li>11</li>                <li>12</li>                <li>13</li>                <li>14</li>                <li>15</li>                <li>16</li>                <li>17</li>                <li>18</li>                <li>19</li>                <li>20</li>                <li>21</li>                <li>22</li>                <li>23</li>            </ul>            <ul class="mm">                <li>0</li>                <li>5</li>                <li>10</li>                <li>15</li>                <li>20</li>                <li>25</li>                <li>30</li>                <li>35</li>                <li>40</li>                <li>45</li>                <li>50</li>                <li>55</li>            </ul>            <ul class="ss">                <li>0</li>                <li>10</li>                <li>20</li>                <li>30</li>                <li>40</li>                <li>50</li>            </ul>        </div>    </div></div>',spinnerBtn:'<ul class="bjui-spinner"><li class="up" data-add="1">&and;</li><li class="down">&or;</li></ul>',lookupBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="lookupbtn"><i class="fa fa-search"></i></a>',dateBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="datepickerbtn"><i class="fa fa-calendar"></i></a>',navtabCM:'<ul id="bjui-navtabCM">    <li rel="reload"><span class="icon"><i class="fa fa-refresh"></i></span><span class="title">#refresh#</span></li>    <li rel="closeCurrent"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#close#</li>    <li rel="closeOther"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeother#</li>    <li rel="closeAll"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeall#</li></ul>',dialogCM:'<ul id="bjui-dialogCM">    <li rel="reload"><span class="icon"><i class="fa fa-refresh"></i></span><span class="title">#refresh#</span></li>    <li rel="closeCurrent"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#close#</span></li>    <li rel="closeOther"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeother#</span></li>    <li rel="closeAll"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeall#</span></li></ul>',externalFrag:'<iframe src="{url}" style="width:100%;height:{height};" frameborder="no" border="0" marginwidth="0" marginheight="0"></iframe>',uploadTemp:'<div id="{fileId}" class="item">    <div class="info">        <span class="up_filename">{fileName}</span><span class="up_confirm" title="#upConfirm#"><i class="fa fa-play-circle-o"></i></span><span class="up_pause" title="#upPause#"><span class="glyphicon glyphicon-pause"></span></span><span class="up_cancel" title="#upCancel#"><i class="fa fa-times-circle-o"></i></span>    </div>    <div class="preview"><span class="img"></span></div>    <div class="progress"><div class="bar"></div></div>    <span class="percent">{percent}</span>    <span class="filesize"><span class="uploadedsize">{uploadedSize}</span>/<span class="totalsize">{fileSize}</span></span></div>',uploadFrag:'<input class="bjui-upload-select-file" style="display:none;" type="file" name="fileselect[]" #multi# accept="#accept#"><a href="javascript:void(0)" class="btn btn-default bjui-upload-select">#btnTxt#</a><div class="queue"></div>',statusCode_503:"HTTP status 503, #statusCode_503#",sessionTimout:"#sessiontimeout#",alertPlhMsg:"#plhmsg#",alertNoCheckGroup:"#nocheckgroup#",alertNotChecked:"#notchecked#",alertSelectMsg:"#selectmsg#",validateErrorMsg:"#validatemsg#",uiTitle:"#uititle#",mainTabTitle:"#mynavtab#"}}(jQuery);
+function(t){"use strict";t.fn.extend({ajaxUrl:function(e){var n=t(this);n.trigger(BJUI.eventType.beforeAjaxLoad),e.loadingmask&&n.trigger(BJUI.eventType.ajaxStatus),t.ajax({type:e.type||"GET",url:e.url,data:e.data||{},cache:!1,dataType:"html",timeout:BJUI.ajaxTimeout,success:function(r){var i=r.toJson(),a=n.find("> .bjui-ajax-mask");i[BJUI.keys.statusCode]?(i[BJUI.keys.statusCode]==BJUI.statusCode.error?(i[BJUI.keys.message]&&n.alertmsg("error",i[BJUI.keys.message]),n.closest(".bjui-layout").length||(n.closest(".navtab-panel").length?n.navtab("closeCurrentTab"):n.dialog("closeCurrent"))):i[BJUI.keys.statusCode]==BJUI.statusCode.timeout&&(n.closest(".bjui-dialog").length&&n.dialog("closeCurrent"),BJUI.loadLogin()),a.fadeOut("normal",function(){t(this).remove()})):(n.empty().html(r).append(a).initui(),t.isFunction(e.callback)&&e.callback(r))},error:function(t,e,r){n.bjuiajax("ajaxError",t,e,r),n.closest(".bjui-layout").length||(n.closest(".navtab-panel").length?n.navtab("closeCurrentTab"):n.dialog("closeCurrent")),n.trigger("bjui.ajaxError")},statusCode:{503:function(t,e,r){n.alertmsg("error",FRAG.statusCode_503.replace("#statusCode_503#",BJUI.regional.statusCode_503)||r)}}})},loadUrl:function(e,n,r){t(this).ajaxUrl({url:e,data:n,callback:r})},doAjax:function(e){var n,r,i=t(this);return e.url?e.callback?(e.callback=e.callback.toFunc(),e.loadingmask&&(n=i.getPageTarget(),n.trigger(BJUI.eventType.ajaxStatus),r=n.find("> .bjui-ajax-mask")),e.type||(e.type="POST"),e.dataType||(e.dataType="json"),e.cache||(e.cache=!1),e.timeout=BJUI.ajaxTimeout,e.success=function(i){r?e.callback?t.when(e.callback(i,e.element)).done(function(){n.trigger("bjui.ajaxStop")}):n.trigger("bjui.ajaxStop"):e.callback(i,e.element)},e.error=e.error||function(t,e,a){i.bjuiajax("ajaxError",t,e,a),r&&n.trigger("bjui.ajaxError")},void t.ajax(e)):void BJUI.debug("The ajax callback is undefined!"):void BJUI.debug("The ajax url is undefined!")},getPageTarget:function(){var e;return e=this.closest(".bjui-layout").length?this.closest(".bjui-layout"):this.closest(".navtab-panel").length?t.CurrentNavtab:t.CurrentDialog},resizePageH:function(){return this.each(function(){if(!t(this).closest(".tab-content").length){var e=t(this),n=e.find("> .bjui-pageHeader"),r=e.find("> .bjui-pageContent"),i=e.find("> .bjui-pageFooter"),a=n.outerHeight()||0,s=i.outerHeight()||0;e.hasClass("navtabPage")&&e.is(":hidden")&&(e.show(),a=n.outerHeight()||0,s=i.outerHeight()||0,e.hide()),i.css("bottom")&&(s+=parseInt(i.css("bottom"))||0),0==s&&e.hasClass("dialogContent")&&(s=5),r.css({top:a,bottom:s})}})},getMaxIndexObj:function(e){var n=0,r=0;return e.each(function(e){var i=parseInt(t(this).css("zIndex"))||1;i>n&&(n=i,r=e)}),e.eq(r)},serializeJson:function(){var e={},n=this.serializeArray();return t.each(n,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},isTag:function(e){return e&&t(this).prop("tagName")&&t(this)[0].tagName.toLowerCase()==e?!0:!1},isBind:function(e){var n=t(this).data("events");return n&&e&&n[e]},log:function(t){return this.each(function(){console&&console.log("%s: %o",t,this)})}}),t.extend(String.prototype,{isPositiveInteger:function(){return new RegExp(/^[1-9]\d*$/).test(this)},isInteger:function(){return new RegExp(/^\d+$/).test(this)},isNumber:function(){return new RegExp(/^([-]{0,1}(\d+)[\.]+(\d+))|([-]{0,1}(\d+))$/).test(this)},includeChinese:function(){return new RegExp(/[\u4E00-\u9FA5]/).test(this)},trim:function(){return this.replace(/(^\s*)|(\s*$)|\r|\n/g,"")},startsWith:function(t){return 0===this.indexOf(t)},endsWith:function(t){var e=this.length-t.length;return e>=0&&this.lastIndexOf(t)===e},replaceSuffix:function(t){return this.replace(/\[[0-9]+\]/,"["+t+"]").replace("#index#",t)},replaceSuffix2:function(t){return this.replace(/\-(i)([0-9]+)$/,"-i"+t).replace("#index#",t)},trans:function(){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},encodeTXT:function(){return this.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll(" ","&nbsp;")},replaceAll:function(t,e){return this.replace(new RegExp(t,"gm"),e)},replacePlh:function(e){return e=e||t(document),this.replace(/{\/?[^}]*}/g,function(t){var n=e.find(t.replace(/[{}]+/g,""));return n&&n.val()?n.val():t})},replaceMsg:function(t){return this.replace(new RegExp("({.*})","g"),t)},replaceTm:function(t){return t?this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_-]*})","g"),function(e){return t[e.replace(/[{}]+/g,"")]}):this},replaceTmById:function(e){var n=e||t(document);return this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_-]*})","g"),function(t){var e=n.find("#"+t.replace(/[{}]+/g,""));return e.val()?e.val():t})},isFinishedTm:function(){return!new RegExp("{/?[^}]*}").test(this)},skipChar:function(t){return this&&0!==this.length?this.charAt(0)===t?this.substring(1).skipChar(t):this:""},isValidPwd:function(){return new RegExp(/^([_]|[a-zA-Z0-9]){6,32}$/).test(this)},isValidMail:function(){return new RegExp(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/).test(this.trim())},isSpaces:function(){for(var t=0;t<this.length;t+=1){var e=this.charAt(t);if(" "!=e&&"\n"!=e&&"	"!=e&&"\r"!=e)return!1}return!0},isPhone:function(){return new RegExp(/(^([0-9]{3,4}[-])?\d{3,8}(-\d{1,6})?$)|(^\([0-9]{3,4}\)\d{3,8}(\(\d{1,6}\))?$)|(^\d{3,8}$)/).test(this)},isUrl:function(){return new RegExp(/^[a-zA-z]+:\/\/([a-zA-Z0-9\-\.]+)([-\w .\/?%&=:]*)$/).test(this)},isExternalUrl:function(){return this.isUrl()&&-1==this.indexOf("://"+document.domain)},toBool:function(){return"true"===this.toLowerCase()?!0:!1},toJson:function(){var t=this;try{return"object"==typeof t&&(t=t.toString()),t.trim().match("^{(.+:.+,*){1,}}$")?JSON.parse(this):this}catch(e){return this}},toObj:function(){var t=null;try{t=new Function("return "+this)()}catch(e){t=this,BJUI.debug('String toObj：Parse "String" to "Object" error! Your str is: '+this)}return t},toFunc:function(){if(!this||0==this.length)return void 0;if(this.startsWith("function"))return new Function("return "+this)();for(var t=this.split("."),e=window,n=0;n<t.length;n++)e=e[t[n]];return"function"==typeof e?e:void 0},setUrlParam:function(t,e){var n="",r=this;if(-1==r.indexOf("?"))return r+"?"+t+"="+e;n=r.substr(r.indexOf("?")+1);var i,a="",s="",u="0";if(-1!=n.indexOf("&")){i=n.split("&");for(var o in i)i[o].split("=")[0]==t?(s=e,u="1"):s=i[o].split("=")[1],a=a+i[o].split("=")[0]+"="+s+"&";a=a.substr(0,a.length-1),"0"==u&&a==n&&(a=a+"&"+t+"="+e)}else-1!=n.indexOf("=")?(i=n.split("="),i[0]==t?(s=e,u="1"):s=i[1],a=i[0]+"="+s,"0"==u&&a==n&&(a=a+"&"+t+"="+e)):a=t+"="+e;return r.substr(0,r.indexOf("?"))+"?"+a},format:function(){var t=arguments;return this.replace(/{(\d+)}/g,function(e,n){return"undefined"!=typeof t[n]?t[n]:e})}}),t.extend(Function.prototype,{toFunc:function(){return this}}),t.extend(Array.prototype,{remove:function(t){return 0>t?this:this.slice(0,t).concat(this.slice(t+1,this.length))},unique:function(){var t=new Array;this.sort();for(var e=0;e<this.length;e++)this[e]!=this[e+1]&&(t[t.length]=this[e]);return t},myIndexOf:function(t){if(!this||!this.length)return-1;for(var e,n=0;e=this[n];n++)if(e==t)return n;return-1},toJson:function(){var e={},n=this;return t.each(n,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e}}),t.isJson=function(e){var n=!0;try{n=t.parseJSON(e)}catch(r){return!1}return n?!0:!1}}(jQuery);
+function(t){"use strict";function e(e){var o=arguments,s=e;return this.each(function(){var i=t(this),r=t.extend({},i.data(),"object"==typeof e&&e),a=i.data("bjui.basedrag");a||i.data("bjui.basedrag",a=new n(this,r)),"string"==typeof s&&t.isFunction(a[s])?([].shift.apply(o),o?a[s].apply(a,o):a[s]()):a.init()})}var n=function(e,n){this.$element=t(e),this.options=n};n.prototype.init=function(){var t=this;this.options.$obj=this.$element,this.options.obj&&(this.options.$obj=this.options.obj),this.options.event?this.start(this.options.event):this.$element.find(this.options.selector).bind("mousedown",function(e){t.start.apply(t,[e])})},n.prototype.start=function(e){document.onselectstart=function(t){return!1};var n=this;this.options.oleft=parseInt(this.$element.css("left"))||0,this.options.otop=parseInt(this.$element.css("top"))||0,t(document).bind("mouseup.bjui.basedrag",function(t){n.stop.apply(n,[t])}).bind("mousemove.bjui.basedrag",function(t){n.drag.apply(n,[t])})},n.prototype.drag=function(e){e||(e=window.event);var n=this.options,o=n.oleft+(e.pageX||e.clientX)-n.event.pageX,s=n.otop+(e.pageY||e.clientY)-n.event.pageY;if(1>s&&(s=0),"horizontal"==n.move)n.minW&&o>=parseInt(this.options.$obj.css("left"))+n.minW&&n.maxW&&o<=parseInt(this.options.$obj.css("left"))+n.maxW?this.$element.css("left",o):n.scop&&n.relObj&&(o-parseInt(n.relObj.css("left"))>n.cellMinW?this.$element.css("left",o):this.$element.css("left",o));else if("vertical"==n.move)this.$element.css("top",s);else{var i=n.selector?this.options.$obj.find(n.selector):this.options.$obj;o>=2*-i.outerWidth()/3&&s>=0&&o+i.outerWidth()/3<t(window).width()&&s+i.outerHeight()<t(window).height()&&this.$element.css({left:o,top:s})}return n.drag&&n.drag.apply(this.$element,[this.$element,e]),this.preventEvent(e)},n.prototype.stop=function(e){return t(document).unbind("mousemove.bjui.basedrag").unbind("mouseup.bjui.basedrag"),this.options.stop&&this.options.stop.apply(this.$element,[this.$element,e]),this.options.event&&this.destroy(),document.onselectstart=function(t){return!0},this.preventEvent(e)},n.prototype.preventEvent=function(t){return t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),!1},n.prototype.destroy=function(){this.$element.removeData("bjui.basedrag"),this.options.nounbind||this.$element.unbind("mousedown")};var o=t.fn.basedrag;t.fn.basedrag=e,t.fn.basedrag.Constructor=n,t.fn.basedrag.noConflict=function(){return t.fn.basedrag=o,this}}(jQuery);
+function(t){"use strict";function i(i){var n=arguments,e=i;return this.each(function(){var o=t(this),s=t.extend({},o.data(),"object"==typeof i&&i),l=o.data("bjui.slidebar");l||o.data("bjui.slidebar",l=new a(this,s)),"string"==typeof e&&t.isFunction(l[e])?([].shift.apply(n),n?l[e].apply(l,n):l[e]()):l.init()})}t(function(){t("#bjui-leftside").after("<!-- Adjust the width of Left slide -->").after(FRAG.splitBar).after(FRAG.splitBarProxy)});var a=function(i,a){this.$element=t(i),this.$bar=this.$element.find("#bjui-sidebar"),this.$sbar=this.$element.find("#bjui-sidebar-s"),this.$lock=this.$bar.find("> .toggleCollapse > .lock"),this.$navtab=t("#bjui-navtab"),this.$collapse=this.$sbar.find(".collapse"),this.$split=t("#bjui-splitBar"),this.$split2=t("#bjui-splitBarProxy"),this.isfloat=!1,this.options=a};a.prototype.lock=function(){var i=this,a=i.$bar.outerWidth()+4,n=BJUI.windowWidth-t("#bjui-sidebar").width()-6;i.faLock(),i.hoverLock(),i.$sbar.animate({left:-10},20),i.$bar.removeClass("shadown"),i.isfloat=!1,i.$navtab.animate({left:a,width:n},500,function(){t(window).trigger(BJUI.eventType.resizeGrid)}),i.$split.show()},a.prototype.unlock=function(){var i=this,a=0-i.$bar.outerWidth()-0,n=BJUI.windowWidth-6;i.faUnLock(),i.hoverUnLock(),i.$navtab.animate({left:6,width:n},400),i.$bar.animate({left:a},500,function(){i.$sbar.animate({left:0},200),i.$split.hide(),t(window).trigger(BJUI.eventType.resizeGrid)}),i.isfloat=!1},a.prototype["float"]=function(){var t=this;t.$sbar.animate({left:-10},200),t.$bar.addClass("shadown").animate({left:0},500),t.isfloat=!0},a.prototype.hideFloat=function(){var t=this,i=0-t.$bar.outerWidth()-0;t.$bar.animate({left:i-10},500,function(){t.$sbar.animate({left:0},100)}),t.isfloat=!1},a.prototype.hoverLock=function(){var t=this;t.$lock.hover(function(){t.tipUnLock(),t.faUnLock()},function(){t.tipLock(),t.faLock()})},a.prototype.hoverUnLock=function(){var t=this;t.$lock.hover(function(){t.tipLock(),t.faLock()},function(){t.tipUnLock(),t.faUnLock()})},a.prototype.tipLock=function(){this.$lock.tooltip("destroy").tooltip({title:"保持锁定，始终显示导航栏",container:"body"})},a.prototype.tipUnLock=function(){this.$lock.tooltip("destroy").tooltip({title:"解除锁定，自动隐藏导航栏",container:"body"})},a.prototype.faLock=function(){this.$lock.find("> i").attr("class","fa fa-lock")},a.prototype.faUnLock=function(){this.$lock.find("> i").attr("class","fa fa-unlock-alt")},a.prototype.init=function(){var i=this;BJUI.ui.showSlidebar?i.hoverLock():i.unlock(),this.$lock.off("click.bjui.slidebar").on("click.bjui.slidebar",function(){i.isfloat?i.lock():i.unlock(),BJUI.ui.showSlidebar=!BJUI.ui.showSlidebar}),this.$collapse.hover(function(){i["float"](),i.$navtab.click(function(){i.isfloat&&i.hideFloat()})}),this.$split.mousedown(function(a){i.$split2.each(function(){var n=t(this);return setTimeout(function(){n.show()},100),n.css({visibility:"visible",left:i.$split.css("left")}).basedrag(t.extend(i.options,{obj:i.$bar,move:"horizontal",event:a,stop:function(){t(this).css("visibility","hidden");var a=parseInt(t(this).css("left"))-parseInt(i.$split.css("left")),n=i.$bar.outerWidth()+a,e=parseInt(i.$navtab.css("left"))+a,o=i.$navtab.outerWidth()-a;i.$bar.css("width",n),i.$split.css("left",t(this).css("left")),i.$navtab.css({left:e,width:o})}})),!1})}),t("#bjui-hnav-navbar-box").length&&i.moveHnav()},a.prototype.moveHnav=function(){var i=t("#bjui-hnav-navbar-box"),a=i.find("> #bjui-hnav-navbar"),n=i.prev(),e=i.next();n.hover(function(){a.stop().animate({left:0},2e3,function(){n.hide()})},function(){a.stop(),i.data("hnav.move")&&e.show()}).on("click",function(){return a.stop().animate({left:0},"fast",function(){n.hide()}),!1}),e.hover(function(){a.stop().animate({left:i.width()-i.data("hnav.liw")-10},2e3,function(){e.hide()})},function(){a.stop(),"0px"!=a.css("left")&&n.show()}).on("click",function(){return a.stop().animate({left:i.width()-i.data("hnav.liw")-10},"fast",function(){e.hide()}),!1})},a.prototype.initHnav=function(){var i,a,n,e,o=this,s=o.$element.text().trim(),l=o.$element.parent(),c=t("#bjui-accordionmenu");i=l.find("> .items > ul.ztree"),a=l.find("> .items > ul.menu-items"),(i.length||a.length)&&(i.length&&(e=i),a.length&&(e=e?e.add(a):a,a.find("a").each(function(){var i=t(this),a=i.data("options");!i.data("icon.init")&&a&&"string"==typeof a&&(a=a.toObj(),a&&a.faicon&&(a.faicon=a.faicon.trim(),a.faicon.startsWith("icon-")?(a.faicon=a.faicon.substr(5),i.prepend('<i class="icon iconfont icon-'+a.faicon+'"></i>').data("icon.init",!0).attr("title",i.text())):(a.faicon.startsWith("fa-")&&(a.faicon=a.faicon.substr(3)),i.prepend('<i class="fa fa-'+a.faicon+'"></i>').data("icon.init",!0).attr("title",i.text()))))})),c.empty(),e.each(function(i){var a,e,o,l=t(this),r=l.data("faicon"),f=(l.data("faiconClose"),r?r:"dot-circle-o");l.data("tit")&&(s=l.data("tit")),e=i?"collapsed":"",o=i?"":" in",a=FRAG.slidePanel.replaceAll("#id#","bjui-collapse"+i).replaceAll("#title#",s).replaceAll("#righticon#",'<i class="fa fa-angle-down"></i>').replaceAll("#class#",e).replaceAll("#bodyclass#",o);var d;f.startsWith("icon-")?(f=f.substr(5),d='<i class="icon iconfont icon-'+f+'"></i>'):(f.startsWith("fa-")&&(f=f.substr(3)),d='<i class="fa fa-'+f+'"></i>'),a=f?a.replaceAll("#icon#",d):a.replaceAll("#icon#",""),n=t(a),n.find("> .panel-collapse > .panel-body").append(l.removeAttr("data-noinit")),c.append(n),i||n.collapse("show")}),t("#bjui-sidebar").initui(),l.addClass("active").data("bjui.slidebar.hnav.panels",c.find("> .panel")).siblings().removeClass("active"))};var n=t.fn.slidebar;t.fn.slidebar=i,t.fn.slidebar.Constructor=a,t.fn.basedrag.noConflict=function(){return t.fn.slidebar=n,this},t(document).one(BJUI.eventType.afterInitUI,function(i){t("#bjui-leftside").slidebar({minW:150,maxW:700})}),t(document).on("click.bjui.slidebar.data-api",'[data-toggle="slidebar"]',function(a){var n=t(this).parent(),e=t("#bjui-accordionmenu"),o=n.data("bjui.slidebar.hnav.panels");e.find("> .panel").detach(),o&&o.length?(e.append(o),n.addClass("active").siblings().removeClass("active")):i.call(t(this),"initHnav"),a.preventDefault()})}(jQuery);
+function(t){"use strict";function i(i){var n=arguments,e=i;return this.each(function(){var o=t(this),h=t.extend({},c.DEFAULTS,o.data(),"object"==typeof i&&i),u=o.data("bjui.contextmenu");u||o.data("bjui.contextmenu",u=new c(this,h)),"string"==typeof e&&t.isFunction(u[e])?([].shift.apply(n),n?u[e].apply(u,n):u[e]()):u.init()})}var n,e,o;t(function(){var i=function(){n=t('<div id="bjui-contextmenu"></div>').hide(),e=t('<div id="bjui-contextmenuShadow"></div>').hide(),o=[],t("body").append("<!-- contextmenu -->").append(n).append(e)};i()});var c=function(i,n){this.$element=t(i),this.options=n};c.DEFAULTS={id:void 0,shadow:!0,bindings:{},ctrSub:null},c.prototype.init=function(){var t=this,i=this.options;if(i.id){o.push({id:i.id,shadow:i.shadow,bindings:i.bindings||{},ctrSub:i.ctrSub});var n=o.length-1;this.$element.on("contextmenu",function(e){return t.display(n,this,e,i),!1})}},c.prototype.display=function(i,c,h,u){var d=this,s=o[i],a=BJUI.regional[s.id],r=FRAG[s.id];t.each(a,function(t,i){r=r.replace("#"+t+"#",a[t])}),n.html(r),t.each(s.bindings,function(i,e){t('[rel="'+i+'"]',n).on("click",function(i){d.hide(),e(t(c),t("#bjui-"+s.id))})});var p=h.pageX,f=h.pageY;t(window).width()<p+n.width()&&(p-=n.width()),t(window).height()<f+n.height()&&(f-=n.height()),n.css({left:p,top:f}).show(),s.shadow&&e.css({width:n.width(),height:n.height(),left:p+3,top:f+3}).show(),t(document).one("click",d.hide),t.isFunction(s.ctrSub)&&s.ctrSub(t(c),t("#bjui-"+s.id))},c.prototype.hide=function(){n.hide(),e.hide()},c.prototype.show=function(i){var n=this;i.items&&i.items.length&&n.$element.on("contextmenu",function(e){var o=!0;return i.exclude&&n.$element.find(i.exclude).each(function(){return this==e.target||t(this).find(e.target).length?void(o=!1):void 0}),o?(n.custom(i.items,e),!1):(e.stopPropagation(),!o)})},c.prototype.custom=function(i,o){n.empty().html("<ul></ul>");var c,h=this,u=h.options,d=n.find("> ul");t.each(i,function(i,n){var e="";n.icon&&(e='<i class="fa fa-'+n.icon+'"></i>'),"diver"==n.title?c=t('<li class="diver"></li>'):(c=t('<li><span class="icon">'+e+'</span><span class="title">'+n.title+"</span></li>"),n.func&&"string"==typeof n.func&&(n.func=n.func.toFunc()),n.func&&c.on("click",function(t){h.hide(),n.func(h.$element,c)})),c.appendTo(d)});var s=o.pageX,a=o.pageY;t(window).width()<s+n.width()&&(s-=n.width()),t(window).height()<a+n.height()&&(a-=n.height()),n.css({left:s,top:a}).show(),u.shadow&&e.css({width:n.width(),height:n.height(),left:s+3,top:a+3}).show(),t(document).one("click",h.hide)};var h=t.fn.contextmenu;t.fn.contextmenu=i,t.fn.contextmenu.Constructor=c,t.fn.contextmenu.noConflict=function(){return t.fn.contextmenu=h,this}}(jQuery);
+function(t){"use strict";function e(e){var a=arguments,i=e;return this.each(function(){var n=t(this),o=t.extend({},v.DEFAULTS,"object"==typeof e&&e),s=n.data("bjui.navtab");s||n.data("bjui.navtab",s=new v(this,o)),"string"==typeof i&&t.isFunction(s[i])?([].shift.apply(a),a?s[i].apply(s,a):s[i]()):(s=new v(this,o),s.openTab())})}var a,i,n,o,s,r,l,c,d,u,h,f,b;t(function(){var e=function(){a=0,o=t("#bjui-navtab"),s=o.find(".navtab-tab"),r=o.find(".navtab-panel"),l=o.find(".tabsLeft"),c=o.find(".tabsRight"),d=o.find(".tabsMore"),u=o.find(".tabsMoreList"),h=s.find("li:first"),f=u.find("li:first"),l.click(function(){t(this).navtab("scrollPrev")}),c.click(function(){t(this).navtab("scrollNext")}),d.click(function(){u.show()}),t(document).on("click.bjui.navtab.switchtab",function(e){var a="I"==e.target.tagName?t(e.target).parent():t(e.target);d[0]!=a[0]&&u.hide()});var e,i;h.navtab("contextmenu",h).click(function(){t(this).navtab("switchTab","main")}).find("> a > span").html(function(t,a){return e=a.replace("#maintab#",BJUI.regional.maintab)}),i=t.extend({},v.DEFAULTS,h.data(),{id:"main",title:e}),h.data("initOptions",i).data("options",i),h.attr("data-url")&&t(document).one(BJUI.eventType.initUI,function(t){h.removeAttr("data-url").navtab("reload",i)}),setTimeout(function(){h.navtab("switchTab","main")},50),f.click(function(){t(this).hasClass("active")?u.hide():t(this).navtab("switchTab","main")}).find("> a").html(function(t,e){return e.replace("#maintab#",BJUI.regional.maintab)})};e()});var v=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS()};v.DEFAULTS={id:void 0,title:"New tab",url:void 0,type:"GET",data:{},loadingmask:!0,fresh:!1,autorefresh:!1,onLoad:null,beforeClose:null,onClose:null},v.prototype.TOOLS=function(){var e=this,d={getDefaults:function(){return v.DEFAULTS},getTabs:function(){return s.find("> li")},getPanels:function(){return r.find("> div")},getMoreLi:function(){return u.find("> li")},getTab:function(t){var e=this.indexTabId(t);return e>=0?this.getTabs().eq(e):void 0},getPanel:function(t){var e=this.indexTabId(t);return e>=0?this.getPanels().eq(e):void 0},getTabsW:function(t,e){return this.tabsW(this.getTabs().slice(t,e))},tabsW:function(e){var a=0;return e.each(function(){a+=t(this).outerWidth(!0)}),a},indexTabId:function(e){if(!e)return-1;var a=-1;return this.getTabs().each(function(i){return t(this).data("initOptions").id==e?void(a=i):void 0}),a},getLeft:function(){return s.position().left},getScrollBarW:function(){return o.width()-55},visibleStart:function(){for(var t=this.getLeft(),e=0,a=this.getTabs(),i=0;i<a.size();i++){if(e+t>=0)return i;e+=a.eq(i).outerWidth(!0)}return 0},visibleEnd:function(){for(var t=this.getLeft(),e=0,a=this.getTabs(),i=0;i<a.size();i++)if(e+=a.eq(i).outerWidth(!0),e+t>this.getScrollBarW())return i;return a.size()},scrollPrev:function(){var t=this.visibleStart();t>0&&this.scrollTab(-this.getTabsW(0,t-1))},scrollNext:function(){var t=this.visibleEnd();t<this.getTabs().size()&&this.scrollTab(-this.getTabsW(0,t+1)+this.getScrollBarW())},scrollTab:function(t,a){s.animate({left:t},200,function(){e.tools.ctrlScrollBtn()})},scrollCurrent:function(){var t=this.tabsW(this.getTabs()),e=this.getScrollBarW();e>=t?this.scrollTab(0):this.getLeft()<e-t?this.scrollTab(e-t):a<this.visibleStart()?this.scrollTab(-this.getTabsW(0,a)):a>=this.visibleEnd()&&this.scrollTab(e-this.getTabs().eq(a).outerWidth(!0)-this.getTabsW(0,a))},ctrlScrollBtn:function(){var t=this.tabsW(this.getTabs());this.getScrollBarW()>t?(l.hide(),c.hide(),s.parent().removeClass("tabsPageHeaderMargin")):(l.show().removeClass("tabsLeftDisabled"),c.show().removeClass("tabsRightDisabled"),s.parent().addClass("tabsPageHeaderMargin"),this.getLeft()>=0?l.addClass("tabsLeftDisabled"):this.getLeft()<=this.getScrollBarW()-t&&c.addClass("tabsRightDisabled"))},switchTab:function(o){var s=this.getTabs().removeClass("active").eq(o).addClass("active"),r=this.getPanels(),l=r.eq(o),c=e.options.onSwitch?e.options.onSwitch.toFunc():null;s.data("reloadFlag")?(r.hide(),l.show(),e.refresh(s.data("initOptions").id)):(r.hide(),l.find(".bjui-ajax-mask").length?l.show():(l.addClass("fade").removeClass("in").show(),t.support.transition?l.one("bsTransitionEnd",function(){l.addClass("in")}).emulateTransitionEnd(10):l.removeClass("fade"))),this.getMoreLi().removeClass("active").eq(o).addClass("active"),a=o,this.scrollCurrent(),i=s,t.CurrentNavtab=n=l,c&&c.apply(e),l.trigger("bjui.navtab.switch")},closeTab:function(t,i){var n=this.getTabs().eq(t),o=this.getMoreLi().eq(t),s=this.getPanels().eq(t),r=n.data("options"),l=r.beforeClose?r.beforeClose.toFunc():null,c=r.onClose?r.onClose.toFunc():null,d=!0;if(l&&(d=l.apply(e,[s])),!d)return void e.tools.switchTab(t);if(n.remove(),o.remove(),s.trigger(BJUI.eventType.beforeCloseNavtab).remove(),b&&clearInterval(b),c&&c.apply(e),a>=t&&a--,i){var u=this.indexTabId(i);u>0&&(a=u)}this.scrollCurrent(),this.switchTab(a)},closeOtherTab:function(e){e=e||a,this.getTabs().each(function(a){a>0&&e!=a&&t(this).find("> .close").trigger("click")})},loadUrlCallback:function(t){t.find(":button.btn-close").click(function(){e.closeCurrentTab()})},reload:function(t,a){a=a||t.data("reloadFlag");var i=t.data("options");if(a){t.data("reloadFlag",!1);var n=e.tools.getPanel(i.id);t.hasClass("external")?e.openExternal(i.url,n):e.tools.reloadTab(n,i)}},reloadTab:function(t,a){var i=a.onLoad?a.onLoad.toFunc():null,n=a.autorefresh&&(isNaN(String(a.autorefresh))?15:a.autorefresh);t.trigger(BJUI.eventType.beforeLoadNavtab).ajaxUrl({type:a.type||"GET",url:a.url,data:a.data||{},loadingmask:a.loadingmask,callback:function(a){e.tools.loadUrlCallback(t),i&&i.apply(e,[t]),b&&clearInterval(b),n&&(b=setInterval(function(){t.navtab("refresh")},1e3*n)),BJUI.ui.clientPaging&&t.data("bjui.clientPaging")&&t.pagination("setPagingAndOrderby",t)}})}};return d},v.prototype.contextmenu=function(t){var e=this;t.contextmenu({id:"navtabCM",bindings:{reload:function(t,a){e.refresh(t.data("initOptions").id)},closeCurrent:function(t,a){var i=t.data("initOptions").id;i?e.closeTab(i):e.closeCurrentTab()},closeOther:function(t,i){if(0==t.index())e.closeAllTab();else{var n=e.tools.indexTabId(t.data("initOptions").id);e.tools.closeOtherTab(n>0?n:a)}},closeAll:function(t,a){e.closeAllTab()}},ctrSub:function(t,a){{var i=a.find('[rel="reload"]'),n=a.find('[rel="closeCurrent"]');a.find('[rel="closeOther"]'),a.find('[rel="closeAll"]'),e.tools.getTabs()}0==t.index()&&(n.addClass("disabled"),t.data("url")||i.addClass("disabled"))}})},v.prototype.openTab=function(){var e=this,i=this.$element,n=this.options,o=this.tools;if(!n.url&&n.href&&(n.url=n.href),!n.url)return void BJUI.debug("Navtab Plugin: Error trying to open a navtab, url is undefined!");if(n.url=decodeURI(n.url).replacePlh(i.closest(".unitBox")),!n.url.isFinishedTm())return i.alertmsg("error",n.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("Navtab Plugin: The new navtab's url is incorrect, url: "+n.url);n.url=encodeURI(n.url);var l=n.id?o.indexTabId(n.id):a;if(n.id||BJUI.ui.overwriteHomeTab||0!=l||(n.id="navtab",l=-1),l>=0){n.id||delete n.id;var c=o.getTabs().eq(l),d=o.getPanels().eq(l),h=c.data("initOptions"),f=t.extend({},h,n);(h.fresh||n.fresh||h.url!=n.url)&&e.reload(f),a=l}else{var b='<li><a href="javascript:" title="#title#"><span>#title#</span></a><span class="close">&times;</span></li>',c=t(b.replaceAll("#title#",n.title)),d=t('<div class="navtabPage unitBox"></div>'),v=t('<li><a href="javascript:" title="#title#">#title#</a></li>'.replaceAll("#title#",n.title));c.appendTo(s),d.appendTo(r),v.appendTo(u),c.data("options",n).data("initOptions",n),n.external||n.url&&n.url.isExternalUrl()?(c.addClass("external"),this.openExternal(n.url,d)):(c.removeClass("external"),o.reloadTab(d,n)),a=o.getTabs().length-1,this.contextmenu(c),c.on("click",function(a){var i=t(a.target);if(i.hasClass("close"))e.closeTab(n.id);else{if(i.closest("li").hasClass("active"))return!1;e.switchTab(n.id)}}),v.on("click",function(){e.switchTab(n.id)})}o.switchTab(a),o.scrollCurrent()},v.prototype.closeTab=function(t){var e=this.tools.indexTabId(t);e>0&&this.tools.closeTab(e)},v.prototype.closeCurrentTab=function(t){a>0&&this.tools.closeTab(a,t)},v.prototype.closeAllTab=function(){this.tools.getTabs().find("> .close").each(function(){t(this).trigger("click")})},v.prototype.reloadFlag=function(t){for(var e=t.split(","),i=0;i<e.length;i++){var n=this.tools.getTab(e[i].trim());n&&(this.tools.indexTabId(e[i])==a?this.tools.reload(n,!0):n.data("reloadFlag",!0))}},v.prototype.switchTab=function(t){var e=this.tools.indexTabId(t);this.tools.switchTab(e)},v.prototype.scrollPrev=function(){this.tools.scrollPrev()},v.prototype.scrollNext=function(){this.tools.scrollNext()},v.prototype.refresh=function(t){var e,a;e=t?"string"==typeof t?this.tools.getTab(t):t:i,e&&e.length&&(a=this.tools.getPanel(e.data("initOptions").id),a.removeData("bjui.clientPaging"),this.reload(e.data("initOptions")))},v.prototype.reload=function(e,i){var n=this,o=t.extend({},"object"==typeof e&&e),s=o.id?this.tools.getTab(o.id):this.tools.getTabs().eq(a);if(s){var r=s.data("initOptions")||{},l=t.extend({},r,o),c=function(){r.title!=l.title&&s.find("> a").attr("title",l.title).find("> span").html(l.title),i||s.data("initOptions",l),s.data("options",l),n.tools.reload(s,!0)};o.reloadWarn?this.$element.alertmsg("confirm",o.reloadWarn,{okCall:function(){c()}}):c()}},v.prototype.reloadForm=function(e,i){var n,o,s=t.extend({},"object"==typeof i&&i);if("string"==typeof i?(n=this.tools.getTab(i),o=this.tools.getPanel(i)):(n=s.id?this.tools.getTab(s.id):this.tools.getTabs().eq(a),o=s.id?this.tools.getPanel(s.id):this.tools.getPanels().eq(a)),n&&o){if(!n.hasClass("external")){var r=o.find("#pagerForm"),l={},c={};if(r.attr("action")&&(s.url=r.attr("action")),r&&r.length){if(c=r.serializeJson(),i&&i.type||(s.type=r.attr("method")||"POST"),e){var d=BJUI.pageInfo;for(var u in d)l[d[u]]=c[d[u]]}else l=c;s.data=t.extend({},s.data||{},l)}}this.reload(s,!0)}},v.prototype.getCurrentPanel=function(){return this.tools.getPanels().eq(a)},v.prototype.checkTimeout=function(){var t=JSON.parse(n.html());t&&t[BJUI.keys.statusCode]==BJUI.statusCode.timeout&&this.closeCurrentTab()},v.prototype.openExternal=function(t,e){var a=e.closest(".navtab-panel").height();e.html(FRAG.externalFrag.replaceAll("{url}",t).replaceAll("{height}",a+"px"))};var g=t.fn.navtab;t.fn.navtab=e,t.fn.navtab.Constructor=v,t.fn.navtab.noConflict=function(){return t.fn.navtab=g,this},t(document).on("click.bjui.navtab.data-api",'[data-toggle="navtab"]',function(a){var i=t(this),n=i.attr("href"),o=i.data(),s=o.options;s&&("string"==typeof s&&(s=s.toObj()),"object"==typeof s&&t.extend(o,s)),o.title||(o.title=i.text()),n&&!o.url&&(o.url=n),e.call(i,o),a.preventDefault()})}(jQuery);
+function(i){"use strict";function t(t){var e=arguments,a=t;return this.each(function(){var o=i(this),n=i.extend({},s.DEFAULTS,"object"==typeof t&&t),r=o.data("bjui.dialog");r||o.data("bjui.dialog",r=new s(this,n)),"string"==typeof a&&i.isFunction(r[a])?([].shift.apply(e),e?r[a].apply(r,e):r[a]()):(r=new s(this,n),r.open())})}var e,a,o,n;i(function(){var t=function(){e=i("#bjui-resizable"),o="dialogShadow",n=s.ZINDEX,i("body").append("<!-- dialog resizable -->").append(FRAG.resizable)};t()});var s=function(t,e){this.$element=i(t),this.options=e,this.tools=this.TOOLS()};s.DEFAULTS={id:"dialog",title:"New Dialog",url:void 0,type:"GET",data:{},loadingmask:!0,width:500,height:300,minW:65,minH:40,max:!1,mask:!1,resizable:!0,drawable:!0,maxable:!0,minable:!0,fresh:!1,onLoad:null,beforeClose:null,onClose:null},s.ZINDEX=30,s.prototype.TOOLS=function(){var t=this,e={getDefaults:function(){return s.DEFAULTS},init:function(e){var a=t.options.width>t.options.minW?t.options.width:t.options.minW,n=t.options.height>t.options.minH?t.options.height:t.options.minH,s=i(window).width(),r=i(window).height(),d=t.options.max?0:(r-n)/2;a>s&&(a=s),n>r&&(n=r),e.height(n).width(a).show().css({left:(s-a)/2,top:0,opacity:.1}).animate({top:d>0?d:0,opacity:1}).addClass(o).find("> .dialogContent").height(n-i("> .dialogHeader",e).outerHeight()-6),i("body").find("> .bjui-dialog-container").not(e).removeClass(o)},reload:function(e,a){var o,n=e.find("> .dialogContent");if(a=a||e.data("initOptions"),o=a.onLoad?a.onLoad.toFunc():null,e.trigger(BJUI.eventType.beforeLoadDialog),a.url)n.ajaxUrl({type:a.type||"GET",url:a.url,data:a.data||{},loadingmask:a.loadingmask,callback:function(i){o&&o.apply(t,[e]),BJUI.ui.clientPaging&&e.data("bjui.clientPaging")&&e.pagination("setPagingAndOrderby",e)}});else if(a.target){var s=i(a.target).html()||e.data("bjui.dialog.target");i(a.target).empty(),e.data("bjui.dialog.target",s),n.trigger(BJUI.eventType.beforeAjaxLoad).html(s).initui(),o&&o.apply(t,[e])}},resizeContent:function(t,e,a){var o=t.find("> .dialogContent");o.css({width:e-12,height:a-t.find("> .dialogHeader").outerHeight()-6}).resizePageH(),i(window).trigger(BJUI.eventType.resizeGrid)}};return e},s.prototype.open=function(){var t=this,e=t.options,o=i("body"),s=o.data(e.id);if(e.target&&i(e.target).length)e.url=void 0;else{if(!e.url&&e.href&&(e.url=e.href),!e.url)return void BJUI.debug("Dialog Plugin: Error trying to open a dialog, url is undefined!");if(e.url=decodeURI(e.url).replacePlh(t.$element.closest(".unitBox")),!e.url.isFinishedTm())return t.$element.alertmsg("error",e.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("Dialog Plugin: The new dialog's url is incorrect, url: "+e.url);e.url=encodeURI(e.url)}if(s){var r=s.data("initOptions")||e;this.switchDialog(s),s.is(":hidden")&&s.show(),(r.fresh||e.fresh||!r.url||r.url!=e.url)&&(t.reload(e),s.data("initOptions",e))}else{var d=BJUI.regional.dialog,l=FRAG.dialog.replace("#close#",d.close).replace("#maximize#",d.maximize).replace("#restore#",d.restore).replace("#minimize#",d.minimize).replace("#title#",d.title);s=i(l).data("options",e).data("initOptions",e).css("zIndex",n+=1).hide().appendTo(o),s.find("> .dialogHeader > h1 > span.title").html(e.title),this.tools.init(s),e.maxable?s.find("a.maximize").show():s.find("a.maximize").hide(),e.minable?s.find("a.minimize").show():s.find("a.minimize").hide(),e.max&&t.maxsize(s),e.mask?this.addMask(s):e.minable&&i.fn.taskbar&&this.$element.taskbar({id:e.id,title:e.title}),s.on("click",function(e){i(e.target).data("bjui.dialog")||a&&a[0]!=s[0]&&t.switchDialog(s)}).on("click",".btn-close",function(i){t.close(s),i.preventDefault()}).on("click",".dialogHeader > a",function(e){var a=i(this);a.hasClass("close")&&t.close(s),a.hasClass("minimize")&&t.minimize(s),a.hasClass("maximize")&&(t.switchDialog(s),t.maxsize(s)),a.hasClass("restore")&&t.restore(s),e.preventDefault(),e.stopPropagation()}).on("dblclick",".dialogHeader > h1",function(i){e.maxable&&(s.find("> .dialogHeader > a.restore").is(":hidden")?s.find("a.maximize").trigger("click"):s.find("> .dialogHeader > a.restore").trigger("click"))}).on("mousedown.bjui.dialog.drag",".dialogHeader > h1",function(a){t.switchDialog(s),e.drawable&&!s.data("max")&&(s.data("bjui.dialog.task",!0),setTimeout(i.proxy(function(){s.data("bjui.dialog.task")&&t.drag(a,s)},t),150),a.preventDefault())}).on("mouseup.bjui.dialog.drag",".dialogHeader > h1",function(i){s.data("bjui.dialog.task",!1)}).on("mousedown.bjui.dialog.resize",'div[class^="resizable"]',function(a){if(e.drawable&&!s.data("max")){var o=i(this);t.switchDialog(s),t.resizeInit(a,i("#bjui-resizable"),s,o),o.show(),a.preventDefault()}}).on("mouseup.bjui.dialog.resize",'div[class^="resizable"]',function(i){i.preventDefault()}),o.data(e.id,s),this.tools.reload(s,e)}i.CurrentDialog=a=s},s.prototype.addMask=function(t){var e=t.data("bjui.dialog.mask");t.wrap('<div style="z-index:'+n+'" class="bjui-dialog-wrap"></div>'),t.find("> .dialogHeader > a.minimize").hide(),e&&e.length||(e=i(FRAG.dialogMask),e.css("zIndex",1).show().insertBefore(t),t.data("bjui.dialog.mask",e))},s.prototype.refresh=function(t){if(t&&"string"==typeof t)for(var e=t.split(","),o=0;o<e.length;o++){var n=i("body").data(e[o].trim());n&&(n.removeData("bjui.clientPaging"),this.tools.reload(n))}else a.removeData("bjui.clientPaging"),this.tools.reload(a)},s.prototype.reload=function(t,e){var a=this,o=i.extend({},"object"==typeof t&&t),n=o.id&&i("body").data(o.id)||a.getCurrent();if(n&&n.length){var s=n.data("initOptions"),r=i.extend({},s,o),d=function(){var t=n.find("> .dialogContent");s.width!=r.width&&(r.max?(n.width(r.width),t.width(r.width)):n.animate({width:r.width},"normal",function(){t.width(r.width)})),s.height!=r.height&&(r.max?(n.height(r.height),t.height(r.height-n.find("> .dialogHeader").outerHeight()-6)):n.animate({height:r.height},"normal",function(){t.height(r.height-n.find("> .dialogHeader").outerHeight()-6).resizePageH()})),s.maxable!=r.maxable&&(r.maxable?n.find("a.maximize").show():n.find("a.maximize").hide()),s.minable!=r.minable&&(r.minable?n.find("a.minimize").show():n.find("a.minimize").hide()),s.max!=r.max&&r.max&&setTimeout(a.maxsize(n),10),s.mask!=r.mask&&(r.mask?(a.addMask(n),i.fn.taskbar&&a.$element.taskbar("closeDialog",r.id)):r.minable&&i.fn.taskbar&&a.$element.taskbar({id:r.id,title:r.title})),s.title!=r.title&&(n.find("> .dialogHeader > h1 > span.title").html(r.title),n.taskbar("changeTitle",r.id,r.title)),n.data("options",r),e||n.data("initOptions",r),a.tools.reload(n,r)};r.reloadWarn?n.alertmsg("confirm",r.reloadWarn,{okCall:function(){d()}}):d()}},s.prototype.reloadForm=function(t,e){var a,o;if("string"==typeof e?(a=i("body").data(e),o=a.data("options")):"object"==typeof e&&(a=e.id&&i("body").data(e.id)||this.getCurrent()),a){"object"==typeof e&&(e.title&&a.find("> .dialogHeader > h1 > span.title").html(e.title),o=i.extend({},e,a.data("options")));var n=a.find("#pagerForm"),s={},r={};if(n.attr("action")&&(o.url=n.attr("action")),n&&n.length){if(r=n.serializeJson(),e&&e.type||(o.type=n.attr("method")||"POST"),t){var d=BJUI.pageInfo;for(var l in d)s[d[l]]=r[d[l]]}else s=r;o.data=i.extend({},o.data||{},s)}this.reload(o,!0)}},s.prototype.getCurrent=function(){return a},s.prototype.switchDialog=function(t){var e=t.css("zIndex");if(a&&a!=t){var n=a.css("zIndex");a.css("zIndex",e),t.css("zIndex",n),i.CurrentDialog=a=t,i.fn.taskbar&&this.$element.taskbar("switchTask",t.data("options").id)}t.addClass(o),i("body").find("> .bjui-dialog-container").not(t).removeClass(o)},s.prototype.close=function(t){var e=this,o="string"==typeof t?i("body").data(t):t,r=o.data("bjui.dialog.mask"),d=o.data("options"),l=o.data("bjui.dialog.target"),g=d.beforeClose?d.beforeClose.toFunc():null,h=d.onClose?d.onClose.toFunc():null,p=!0;if(o&&d){if(g&&(p=g.apply(e,[o])),!p)return void e.switchDialog(o);d.target&&l&&i(d.target).html(l),r&&r.length?(r.remove(),o.unwrap()):i.fn.taskbar&&this.$element.taskbar("closeDialog",d.id),o.animate({top:-o.outerHeight(),opacity:.1},"normal",function(){i("body").removeData(d.id),o.trigger(BJUI.eventType.beforeCloseDialog).remove(),h&&h.apply(e);var t=i("body").find("div > .bjui-dialog-container"),r=void 0;t.length?r=e.$element.getMaxIndexObj(t):(n=s.ZINDEX,a=null),r&&r.is(":visible")&&e.switchDialog(r)})}},s.prototype.closeCurrent=function(){this.close(a)},s.prototype.checkTimeout=function(){var i=a.find("> .dialogContent"),t=JSON.parse(i.html());t&&t[BJUI.keys.statusCode]==BJUI.statusCode.timeout&&this.closeCurrent()},s.prototype.maxsize=function(t){t.data("original",{top:t.css("top"),left:t.css("left"),width:t.css("width"),height:t.css("height")}).data("max",!0),t.find("> .dialogHeader > a.maximize").hide(),t.find("> .dialogHeader > a.restore").show();var e=i(window).width(),a=i(window).height()-i("#bjui-taskbar").height()-1;t.css({top:0,left:0,width:e,height:a}),this.tools.resizeContent(t,e,a)},s.prototype.restore=function(i){var t=i.data("original"),e=parseInt(t.width),a=parseInt(t.height);i.css({top:t.top,left:t.left,width:e,height:a}),this.tools.resizeContent(i,e,a),i.find("> .dialogHeader > a.maximize").show(),i.find("> .dialogHeader > a.restore").hide(),i.data("max",!1)},s.prototype.minimize=function(t){t.hide(),i.fn.taskbar&&this.$element.taskbar("minimize",t)},s.prototype.drag=function(t,e){i("#bjui-dialogProxy");e.find("> .dialogContent").css("opacity",".3"),e.basedrag({selector:"> .dialogHeader",stop:function(){e.css({left:e.css("left"),top:e.css("top")}).find("> .dialogContent").css("opacity",1)},event:t,nounbind:!0})},s.prototype.resizeDialog=function(t,e,a){var o,n=parseInt(t.css("left")),s=parseInt(t.css("top")),r=parseInt(t.css("height")),d=parseInt(t.css("width"));if(o="n"==a||"nw"==a?parseInt(e.css("top"))-s:r-parseInt(e.css("height")),0>s&&(s=0),e.css({top:s,left:n,width:d+2,height:r+1}).find("> .dialogContent").css("width",d-10),"w"!=a&&"e"!=a){var l=e.find("> .dialogContent");l.css({height:r-e.find("> .dialogHeader").outerHeight()-6}).resizePageH()}i(window).trigger(BJUI.eventType.resizeGrid)},s.prototype.resizeInit=function(t,e,a,o){var n=this,s=o.attr("tar");i("body").css("cursor",s+"-resize"),e.css({top:a.css("top"),left:a.css("left"),height:a.outerHeight(),width:a.css("width")}).show(),this.options.dragCurrent||(this.options.dragCurrent={$resizable:e,$dialog:a,target:s,oleft:parseInt(e.css("left"))||0,owidth:parseInt(e.css("width"))||0,otop:parseInt(e.css("top"))||0,oheight:parseInt(e.css("height"))||0,ox:t.pageX||t.screenX,oy:t.pageY||t.clientY},i(document).on("mouseup.bjui.dialog.resize",i.proxy(n.resizeStop,n)),i(document).on("mousemove.bjui.dialog.resize",i.proxy(n.resizeStart,n)))},s.prototype.resizeStart=function(t){var e=this.options.dragCurrent;if(e){if(!t)var t=window.event;var a=(t.pageX||t.screenX)-e.ox,o=(t.pageY||t.clientY)-e.oy,n=e.$dialog.data("bjui.dialog.mask");if(n&&n.length||!((t.pageY||t.clientY)<=0||(t.pageY||t.clientY)>=i(window).height()-e.$dialog.find("> .dialogHeader").outerHeight())){var s=e.target,r=e.owidth,d=e.oheight;"n"!=s&&"s"!=s&&(r+=s.indexOf("w")>=0?-a:a),r>=this.options.minW&&(s.indexOf("w")>=0&&e.$resizable.css("left",e.oleft+a),"n"!=s&&"s"!=s&&e.$resizable.css("width",r)),"w"!=s&&"e"!=s&&(d+=s.indexOf("n")>=0?-o:o),d>=this.options.minH&&(s.indexOf("n")>=0&&e.$resizable.css("top",e.otop+o),"w"!=s&&"e"!=s&&e.$resizable.css("height",d))}}},s.prototype.resizeStop=function(t){var e=this.options.dragCurrent;return e?(i(document).off("mouseup.bjui.dialog.resize"),i(document).off("mousemove.bjui.dialog.resize"),this.options.dragCurrent=null,this.resizeDialog(e.$resizable,e.$dialog,e.target),i("body").css("cursor",""),void e.$resizable.hide()):!1};var r=i.fn.dialog;i.fn.dialog=t,i.fn.dialog.Constructor=s,i.fn.dialog.noConflict=function(){return i.fn.dialog=r,this},i(document).on("click.bjui.dialog.data-api",'[data-toggle="dialog"]',function(e){var a=i(this),o=a.attr("href"),n=a.data(),s=n.options;s&&("string"==typeof s&&(s=s.toObj()),"object"==typeof s&&i.extend(n,s)),n.title||(n.title=a.text()),o&&!n.url&&(n.url=o),t.call(a,n),e.preventDefault()})}(jQuery);
+function(t){"use strict";function i(i){var s=arguments,e=i;return this.each(function(){var o=t(this),n=t.extend({},f.DEFAULTS,o.data(),"object"==typeof i&&i),a=o.data("bjui.taskbar");a?a.options.id!=n.id&&o.data("bjui.taskbar",a=new f(this,n)):o.data("bjui.taskbar",a=new f(this,n)),"string"==typeof e&&t.isFunction(a[e])?([].shift.apply(s),s?a[e].apply(a,s):a[e]()):a.init()})}var s,e,o,n,a,r,l,h,c;t(function(){var i=function(){s=t("#bjui-resizable"),e=t(FRAG.taskbar),o=e.find(".taskbarContent"),n=o.find("> ul"),a=e.find(".taskbarLeft"),r=e.find(".taskbarRight"),l="disabled",h="selected",c="taskbarMargin",t("body").append("<!-- dialog task bar -->").append(e),a.click(function(i){t(this).taskbar("scrollLeft")}),r.click(function(i){t(this).taskbar("scrollRight")})};i()});var f=function(i,s){this.$element=t(i),this.$task=null,this.options=s,this.tools=this.TOOLS()};f.DEFAULTS={id:void 0,title:void 0},f.prototype.init=function(){var i=this,s=n.find("#"+this.options.id);if(this.show(),s.length)s.find("> div > span.title").html(this.options.title);else{var e='<li id="#taskid#"><div class="taskbutton"><span><i class="fa fa-th-large"></i></span> <span class="title">#title#</span></div><div class="close"><i class="fa fa-times-circle"></i></div></li>';s=t(e.replace("#taskid#",this.options.id).replace("#title#",this.options.title)),s.appendTo(n)}this.contextmenu(s),this.switchTask(s),this.tools.scrollTask(s),s.click(function(e){if(t(e.target).closest("div").hasClass("close")||t(e.target).hasClass("close"))s.dialog("close",i.options.id);else{var o=t("body").data(i.options.id);s.hasClass("selected")?o.find(".dialogHeader a.minimize").trigger("click"):o.is(":hidden")?i.restoreDialog(o):(o.trigger("click"),s.addClass(h)),i.scrollCurrent(s)}return!1})},f.prototype.TOOLS=function(){var i={scrollCurrent:function(){var t=this.tasksW(this.getTasks());if(t>this.getTaskBarW()){var i=this,s=n.find("> li:last-child"),e=this.getTaskBarW()-s.position().left-s.outerWidth(!0);n.animate({left:e},200,function(){i.ctrlScrollBtn()})}else this.ctrlScrollBtn()},getTaskBarW:function(){return o.width()-(a.is(":hidden")?a.width()+2:0)-(r.is(":hidden")?r.width()+2:0)},scrollTask:function(t){var i=this;if(t.position().left+this.getLeft()+t.outerWidth()>this.getBarWidth()){var s=this.getTaskBarW()-t.position().left-t.outerWidth(!0)-2;n.animate({left:s},200,function(){i.ctrlScrollBtn()})}else if(t.position().left+this.getLeft()<0){var s=this.getLeft()-(t.position().left+this.getLeft());n.animate({left:s},200,function(){i.ctrlScrollBtn()})}},ctrlScrollBtn:function(){var t=this.tasksW(this.getTasks());this.getTaskBarW()>t?(o.removeClass(c),r.hide(),a.hide(),this.getTasks().eq(0).length&&this.scrollTask(this.getTasks().eq(0))):(o.addClass(c),r.show().removeClass(l),a.show().removeClass(l),this.getLeft()>=0&&a.addClass(l),this.getLeft()<=this.getTaskBarW()-t&&r.addClass(l))},getLeft:function(){return n.position().left},visibleStart:function(){for(var t=this.getLeft(),i=this.getTasks(),s=0;s<i.size();s++)if(i.eq(s).position().left+i.eq(s).outerWidth(!0)+t>=0)return i.eq(s);return i.eq(0)},visibleEnd:function(){for(var t=this.getLeft(),i=this.getTasks(),s=0;s<i.size();s++)if(i.eq(s).position().left+i.eq(s).outerWidth(!0)+t>this.getBarWidth())return i.eq(s);return i.eq(i.size()-1)},getTasks:function(){return n.find("> li")},tasksW:function(i){var s=0;return i.each(function(){s+=t(this).outerWidth(!0)}),s},getBarWidth:function(){return e.innerWidth()},getCurrent:function(){return n.find("li."+h)}};return i},f.prototype.contextmenu=function(i){var s=this;i.contextmenu({id:"dialogCM",bindings:{reload:function(t){t.dialog("refresh",s.options.id)},closeCurrent:function(t,i){var e=t.isTag("li")?t:s.tools.getCurrent();e.find(".close").trigger("click")},closeOther:function(i,s){var e=n.find("> li").not(i);e.each(function(i){t(this).find(".close").trigger("click")})},closeAll:function(i,e){var o=s.tools.getTasks();o.each(function(i){t(this).find(".close").trigger("click")})}},ctrSub:function(t,i){var e=i.find('[rel="closeCurrent"]'),o=i.find('[rel="closeOther"]');s.tools.getCurrent().length?1==s.tools.getTasks().size()&&o.addClass(l):(e.addClass(l),o.addClass(l))}})},f.prototype.closeDialog=function(t){var i="string"==typeof t?this.getTask(t):t;i&&i.length&&(i.remove(),0==this.tools.getTasks().size()&&this.hide(),this.tools.scrollCurrent(),this.$element.removeData("bjui.taskbar"))},f.prototype.minimize=function(i){var e=this,o="string"==typeof i?t("body").data("dialog"):i,n=this.getTask(o.data("options").id);s.css({top:o.css("top"),left:o.css("left"),height:o.css("height"),width:o.css("width")}).show().animate({top:t(window).height()-60,left:n.position().left,width:n.outerWidth(),height:n.outerHeight()},250,function(){t(this).hide(),e.inactive(n)})},f.prototype.restoreDialog=function(i){var e=this.getTask(i.data("options").id);s.css({top:t(window).height()-60,left:e.position().left,height:e.outerHeight(),width:e.outerWidth()}).show().animate({top:i.css("top"),left:i.css("left"),width:i.css("width"),height:i.css("height")},250,function(){t(this).hide(),i.show()}),this.switchTask(e)},f.prototype.inactive=function(t){var i="string"==typeof t?this.getTask(t):t;i.removeClass(h)},f.prototype.scrollLeft=function(){var t=this.tools.visibleStart();this.tools.scrollTask(t)},f.prototype.scrollRight=function(){var t=this.tools.visibleEnd();this.tools.scrollTask(t)},f.prototype.scrollCurrent=function(t){this.tools.scrollTask(t)},f.prototype.switchTask=function(t){this.tools.getCurrent().removeClass(h);var i="string"==typeof t?this.getTask(t):t;i.addClass(h)},f.prototype.getTask=function(t){return n.find("#"+t)},f.prototype.changeTitle=function(t,i){var s=this.getTask(t);s&&i&&s.find(".title").html(i)},f.prototype.show=function(){e.is(":hidden")&&e.show().animate({bottom:0},500)},f.prototype.hide=function(){e.is(":visible")&&e.animate({bottom:-50},500,function(){e.hide()})};var d=t.fn.taskbar;t.fn.taskbar=i,t.fn.taskbar.Constructor=f,t.fn.taskbar.noConflict=function(){return t.fn.taskbar=d,this}}(jQuery);
+function(e){"use strict";function t(t){var a=arguments,o=t;return this.each(function(){var n=e(this),i=e.extend({},r.DEFAULTS,n.data(),"object"==typeof t&&t),l=n.data("bjui.bjuiajax");l||n.data("bjui.bjuiajax",l=new r(this,i)),"string"==typeof o&&e.isFunction(l[o])&&([].shift.apply(a),a?l[o].apply(l,a):l[o]())})}var a,r=function(t,a){this.$element=e(t),this.options=a,this.tools=this.TOOLS()};r.DEFAULTS={reload:!0,loadingmask:!0},r.NAVTAB="navtab",r.prototype.TOOLS=function(){var t=this,a={getPagerForm:function(t,a){var r=t.isTag("form")?t[0]:t.find("#pagerForm:first")[0],o=e.extend({},BJUI.pageInfo);if(t.data("bjui.clientPaging")&&(a=e.extend({},t.data("bjui.clientPaging"),a),t.data("bjui.clientPaging",a)),r)for(var n in o){var i="";a&&a[n]&&(i=a[n]),r[o[n]]?i&&(r[o[n]].value=i):e('<input type="hidden" name="'+o[n]+'" value="'+i+'">').appendTo(e(r))}return r},getTarget:function(){return t.$element.closest(".navtab-panel").length?r.NAVTAB:"dialog"}};return a},r.prototype.ajaxForm=function(t){var a=this,r=this.$element,o=t&&t.callback,n=r.attr("enctype");t=e.extend({},a.options,"object"==typeof t&&t),o&&(o=o.toFunc());var i=function(t,n,i){o?o.apply(a,[t,r]):e.proxy(a.ajaxCallback(t),a)},l=function(){var a={loadingmask:t.loadingmask,type:r.attr("method"),url:r.attr("action"),callback:i};n&&"multipart/form-data"==n?window.FormData?e.extend(a,{data:new FormData(r[0]),contentType:!1,processData:!1}):e.extend(a,{data:r.serializeArray(),files:r.find(":file"),iframe:!0,processData:!1}):e.extend(a,{data:r.serializeArray()}),r.doAjax(a)};t.confirmMsg?r.alertmsg("confirm",t.confirmMsg,{okCall:l}):l()},r.prototype.ajaxDone=function(e){var t=this.$element;e[BJUI.keys.statusCode]==BJUI.statusCode.error?e[BJUI.keys.message]&&t.alertmsg("error",e[BJUI.keys.message]):e[BJUI.keys.statusCode]==BJUI.statusCode.timeout?BJUI.loadLogin():e[BJUI.keys.message]&&t.alertmsg("correct",e[BJUI.keys.message])},r.prototype.ajaxError=function(e,t,a){if(500==e.status||400==e.status)this.$element.alertmsg("error",e.responseText);else if(e.responseText&&e.responseText.trim().startsWith("{")){var r=e.responseText.trim();this.ajaxDone(r.toObj())}else this.$element.alertmsg("error","<div>Http status: "+e.status+" "+e.statusText+"</div><div>ajaxOptions: "+t+" </div><div>thrownError: "+a+" </div><div>"+r+"</div>")},r.prototype.ajaxCallback=function(e){var t=this,a=t.$element,o=a.closest(".bjui-layout");t.ajaxDone(e),e[BJUI.keys.statusCode]==BJUI.statusCode.ok&&(o&&o.length?t.divCallback(e,o):t.tools.getTarget()==r.NAVTAB?t.navtabCallback(e):t.dialogCallback(e))},r.prototype.divCallback=function(t,a){var r=this;if(t.tabid&&setTimeout(function(){r.$element.navtab("reloadFlag",t.tabid)},100),t.dialogid&&setTimeout(function(){r.$element.dialog("refresh",t.dialogid)},100),t.divid&&setTimeout(function(){r.$element.bjuiajax("refreshDiv",t.divid)},100),r.options.reload){var o=r.tools.getPagerForm(a),n=null,i=null;o?(n=e(o).attr("action"),i=e(o).attr("method")||"GET"):(n=a.data("url"),i=a.data("type")||"GET"),n&&a.ajaxUrl({url:n,type:i})}if(r.options.reloadNavtab&&setTimeout(function(){r.$element.navtab("refresh")},100),t.forward){var l=function(){a.ajaxUrl({url:t.forward})};t.forwardConfirm?r.$element.alertmsg("confirm",t.forwardConfirm,{okCall:function(){l()}}):l()}},r.prototype.navtabCallback=function(t){var a=this;if(t.tabid&&setTimeout(function(){a.$element.navtab("reloadFlag",t.tabid)},100),t.dialogid&&setTimeout(function(){a.$element.dialog("refresh",t.dialogid)},100),t.divid&&setTimeout(function(){a.$element.bjuiajax("refreshDiv",t.divid)},100),t.datagrid&&setTimeout(function(){e.each(t.datagrid.join(","),function(t,a){e("#"+a.trim()).datagrid("refresh")})},100),t.closeCurrent&&!t.forward?a.$element.navtab("closeCurrentTab"):a.options.reload&&setTimeout(function(){a.$element.navtab("refresh")},100),t.forward){var r=function(){a.$element.navtab("reload",{url:t.forward})};t.forwardConfirm?a.$element.alertmsg("confirm",t.forwardConfirm,{okCall:function(){r()},cancelCall:function(){t.closeCurrent&&a.$element.navtab("closeCurrentTab")}}):r()}},r.prototype.dialogCallback=function(e){var t=this;if(e.tabid&&setTimeout(function(){t.$element.navtab("reloadFlag",e.tabid)},100),e.dialogid&&setTimeout(function(){t.$element.dialog("refresh",e.dialogid)},100),e.divid&&setTimeout(function(){t.$element.bjuiajax("refreshDiv",e.divid)},100),e.closeCurrent&&!e.forward?t.$element.dialog("closeCurrent"):t.options.reload&&setTimeout(function(){t.$element.dialog("refresh")},100),t.options.reloadNavtab&&setTimeout(function(){t.$element.navtab("refresh")},100),e.forward){var a=function(){t.$element.dialog("reload",{url:e.forward})};e.forwardConfirm?t.$element.alertmsg("confirm",e.forwardConfirm,{okCall:function(){a()}}):a()}},r.prototype.pageCallback=function(t,a){var o=this,n=e.extend({},r.DEFAULTS,t),i=a||null,l=null;i&&i.length?(l=o.tools.getPagerForm(i,n),l&&(e.extend(n,e(l).data()),o.reloadDiv(i,{type:e(l).attr("method")||"POST",url:e(l).attr("action"),data:e(l).serializeArray(),loadingmask:n.loadingmask}))):o.tools.getTarget()==r.NAVTAB?(i=e.CurrentNavtab,l=o.tools.getPagerForm(i,n),l&&e.extend(n,e(l).data()),o.$element.navtab("reloadForm",!1,n)):(i=e.CurrentDialog,l=o.tools.getPagerForm(i,n),l&&e.extend(n,e(l).data()),o.$element.dialog("reloadForm",!1,n))},r.prototype.doSearch=function(t){var a=this,o=a.$element,n=null,i={pageCurrent:1},l=o.closest(".bjui-layout"),u=t.isValid;if(t=e.extend({},r.DEFAULTS,"object"==typeof t&&t),t.url||(t.url=o.attr("action")),!t.url)return void BJUI.debug("Error trying to submit form action: action url is undefined!");if(t.url=decodeURI(t.url).replacePlh(o.closest(".unitBox")),!t.url.isFinishedTm())return o.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("The submit form action is incorrect: "+t.url);t.url=encodeURI(t.url);var d=function(){if(l&&l.length){n=a.tools.getPagerForm(l,i);var u=o.serializeJson(),d={};if(t.clearQuery){var c=BJUI.pageInfo;for(var s in c)d[c[s]]=u[c[s]];u=d}a.reloadDiv(l,{type:o.attr("method")||"POST",url:t.url,data:u,loadingmask:t.loadingmask})}else a.tools.getTarget()==r.NAVTAB?(l=e.CurrentNavtab,n=a.tools.getPagerForm(l,i),o.navtab("reloadForm",t.clearQuery,t)):(l=e.CurrentDialog,n=a.tools.getPagerForm(l,i),o.dialog("reloadForm",t.clearQuery,t))};u?d():e.validator?o.isValid(function(e){e&&d()}):d()},r.prototype.doLoad=function(t){var a=this,o=a.$element,n=t.target?e(t.target):null;return t=e.extend({},r.DEFAULTS,"object"==typeof t&&t),t.url?(t.url=decodeURI(t.url).replacePlh(o.closest(".unitBox")),t.url.isFinishedTm()?(t.url=encodeURI(t.url),n&&n.length?void(n&&n.length&&(n.removeData("bjui.clientPaging"),a.reloadDiv(n,t))):void BJUI.debug("Not set loaded 'ajax' content container, like [data-target].")):(o.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("The ajax link incorrect: "+t.url))):void BJUI.debug("Error trying to open a ajax link: The url is undefined!")},r.prototype.refreshLayout=function(t){var o=this,n=(o.$element,t.target?e(t.target):null);return t=e.extend({},r.DEFAULTS,"object"==typeof t&&t),n&&n.length?void(n&&n.length&&(n.removeData("bjui.clientPaging"),o.reloadDiv(n,e.extend({},n.data("options")||{},t)))):(a&&clearInterval(a),void BJUI.debug("Not set loaded 'ajax' content container, like [data-target]."))},r.prototype.reloadDiv=function(e,t){var r=t.autorefresh&&(isNaN(String(t.autorefresh))?15:t.autorefresh);e.addClass("bjui-layout").data("options",t).ajaxUrl({type:t.type,url:t.url,data:t.data,loadingmask:t.loadingmask,callback:function(o){BJUI.ui.clientPaging&&e.data("bjui.clientPaging")&&e.pagination("setPagingAndOrderby",e),t.callback&&t.callback.apply(this,[e]),a&&clearInterval(a),r&&(a=setInterval(function(){e.bjuiajax("refreshLayout",t)},1e3*r))}})},r.prototype.refreshDiv=function(e){if(e&&"string"==typeof e)for(var t=e.split(","),a=0;a<t.length;a++)this.refreshLayout({target:"#"+t[a]})},r.prototype.doAjax=function(t){var a=this,o=a.$element;if(t=e.extend({},r.DEFAULTS,"object"==typeof t&&t),!t.url)return void BJUI.debug("Error trying to open a ajax link: url is undefined!");if(t.url=decodeURI(t.url).replacePlh(o.closest(".unitBox")),!t.url.isFinishedTm())return o.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("The ajax url is incorrect: "+t.url);t.url=encodeURI(t.url);var n=t.callback&&t.callback.toFunc(),i=function(){o.doAjax({type:t.type,url:t.url,data:t.data,element:t["bjui.bjuiajax"],callback:n?n:e.proxy(function(e){a.ajaxCallback(e)},a)})};t.confirmMsg?o.alertmsg("confirm",t.confirmMsg,{okCall:function(){i()}}):i()},r.prototype.doExport=function(t){var a,o=this,n=o.$element,i=t.target?e(t.target):null;if(!t.url)return void BJUI.debug("Error trying to open a ajax link: url is undefined!");if(t.url=decodeURI(t.url).replacePlh(n.closest(".unitBox")),!t.url.isFinishedTm())return n.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("The ajax url is incorrect: "+t.url);var l=function(){i&&i.length||(i=o.tools.getTarget()==r.NAVTAB?e.CurrentNavtab:e.CurrentDialog),a=o.tools.getPagerForm(i),a&&(t.url=encodeURI(t.url+(-1==t.url.indexOf("?")?"?":"&")+e(a).serialize())),e.fileDownload(t.url,{failCallback:function(e,t){e.trim().startsWith("{")&&(e=e.toObj()),o.ajaxDone(e)}})};t.confirmMsg?n.alertmsg("confirm",t.confirmMsg,{okCall:function(){l()}}):l()},r.prototype.doExportChecked=function(t){var a=this,o=a.$element,n=t.target?e(t.target):null;if(!t.url)return void BJUI.debug("Error trying to open a export link: url is undefined!");if(t.url=decodeURI(t.url).replacePlh(o.closest(".unitBox")),!t.url.isFinishedTm())return o.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("The ajax url is incorrect: "+t.url);var i=function(){if(!t.group)return void a.$element.alertmsg("error",t.warn||FRAG.alertNoCheckGroup.replace("#nocheckgroup#",BJUI.regional.nocheckgroup));n&&n.length||(n=a.tools.getTarget()==r.NAVTAB?e.CurrentNavtab:e.CurrentDialog);var o=[],i=n.find(":checkbox[name="+t.group+"]:checked");return 0==i.length?void a.$element.alertmsg("error",FRAG.alertNotChecked.replace("#notchecked#",BJUI.regional.notchecked)):(i.each(function(){o.push(e(this).val())}),t.url=t.url.setUrlParam(t.idname?t.idname:"ids",o.join(",")),void e.fileDownload(t.url,{failCallback:function(e,t){e.trim().startsWith("{")&&(e=e.toObj()),a.ajaxDone(e)}}))};t.confirmMsg?o.alertmsg("confirm",t.confirmMsg,{okCall:function(){i()}}):i()},r.prototype.doAjaxChecked=function(t){var a=this,o=a.$element,n=t.target?e(t.target):null;if(t=e.extend({},r.DEFAULTS,"object"==typeof t&&t),!t.url)return void BJUI.debug("Error trying to open a del link: url is undefined!");if(t.url=decodeURI(t.url).replacePlh(o.closest(".unitBox")),!t.url.isFinishedTm())return o.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("The ajax url is incorrect: "+t.url);var i=function(){if(!t.group)return void o.alertmsg("error",t.warn||FRAG.alertNoCheckGroup.replace("#nocheckgroup#",BJUI.regional.nocheckgroup));n&&n.length||(n=a.tools.getTarget()==r.NAVTAB?e.CurrentNavtab:e.CurrentDialog);var i=[],l=n.find(":checkbox[name="+t.group+"]:checked"),u=t.callback&&t.callback.toFunc();return 0==l.length?void o.alertmsg("error",FRAG.alertNotChecked.replace("#notchecked#",BJUI.regional.notchecked)):(l.each(function(){i.push(e(this).val())}),t.url=t.url.setUrlParam(t.idname?t.idname:"ids",i.join(",")),void o.doAjax({type:t.type,url:t.url,data:t.data,callback:u?u:e.proxy(function(e){a.ajaxCallback(e)},a)}))};t.confirmMsg?o.alertmsg("confirm",t.confirmMsg,{okCall:function(){i()}}):i()};var o=e.fn.bjuiajax;e.fn.bjuiajax=t,e.fn.bjuiajax.Constructor=r,e.fn.bjuiajax.noConflict=function(){return e.fn.bjuiajax=o,this},e(document).on("submit.bjui.bjuiajax.data-api",'form[data-toggle="ajaxform"]',function(a){var r=e(this),o=r.data();t.call(r,"ajaxForm",o),a.preventDefault()}),e(function(){e.validator?e(document).on(BJUI.eventType.initUI,function(a){e(a.target).find('form[data-toggle="ajaxsearch"]').each(function(){var a=e(this),r=a.data();r.isValid=!0,a.validator({valid:function(e){t.call(a,"doSearch",r)}})})}):e(document).on("submit.bjui.bjuiajax.data-api",'form[data-toggle="ajaxsearch"]',function(a){var r=e(this),o=r.data();t.call(r,"doSearch",o),a.preventDefault()})}),e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="reloadsearch"]',function(a){var r,o=e(this),n=o.closest("form");n&&n.length&&(r=n.data(),r.clearQuery=o.data("clearQuery")||!0,t.call(n,"doSearch",r),a.preventDefault())}),e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="ajaxload"]',function(a){var r=e(this),o=r.data();o.url||(o.url=r.attr("href")),t.call(r,"doLoad",o),a.preventDefault()}),e(document).on(BJUI.eventType.initUI,function(a){var r=e(a.target).find('[data-toggle="autoajaxload"]');r.each(function(){var a=e(this),r=a.data();r.target=this,t.call(a,"doLoad",r)})}),e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="refreshlayout"]',function(a){var r=e(this),o=r.data();t.call(r,"refreshLayout",o)}),e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doajax"]',function(a){var r=e(this),o=r.data();o.url||(o.url=r.attr("href")),t.call(r,"doAjax",o),a.preventDefault()}),e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doexport"]',function(a){var r=e(this),o=r.data();o.url||(o.url=r.attr("href")),t.call(r,"doExport",o),a.preventDefault()}),e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doexportchecked"]',function(a){var r=e(this),o=r.data();o.url||(o.url=r.attr("href")),t.call(r,"doExportChecked",o),a.preventDefault()}),e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doajaxchecked"]',function(a){var r=e(this),o=r.data();o.url||(o.url=r.attr("href")),t.call(r,"doAjaxChecked",o),a.preventDefault()})}(jQuery);
+function(t){"use strict";function e(e){var o=arguments,a=e;return this.each(function(){var i=t(this),l=t.extend({},n.DEFAULTS,i.data(),"object"==typeof e&&e),r=new n(this,l);"string"==typeof a&&t.isFunction(r[a])&&([].shift.apply(o),o?r[a].apply(r,o):r[a]())})}var o,a,i;t(function(){var e=function(){o=t(FRAG.alertBoxFrag).hide().html(""),a=t(FRAG.alertBackground).hide().html(""),t("body").append("<!-- alert msg box -->").append(o).append("<!-- alert msg box mask bg -->").append(a)};e()});var n=function(e,o){this.$element=t(e),this.options=o,this.tools=this.TOOLS(),this.clearTime=null};n.DEFAULTS={displayPosition:"topcenter",displayMode:"slide",autoClose:null,alertTimeout:3e3,mask:null,types:{error:"error",info:"info",warn:"warn",correct:"correct",confirm:"confirm"},fas:{error:"fa-times-circle",info:"fa-info-circle",warn:"fa-exclamation-circle",correct:"fa-check-circle",confirm:"fa-question-circle"}},n.prototype.TOOLS=function(){var e=this,n=e.options,l={getTitle:function(t){return n.title||BJUI.regional.alertmsg.title[t]},keydownOk:function(t){return t.which==BJUI.keyCode.ENTER?(t.data.target.trigger("click"),!1):!0},keydownEsc:function(t){t.which==BJUI.keyCode.ESC&&t.data.target.trigger("click")},openPosition:function(){var t=BJUI.alertMsg.displayPosition,e=BJUI.alertMsg.displayMode,a=460,i=o.outerHeight(),l={},r={};switch(t?n.displayPosition&&"topcenter"!=n.displayPosition&&(t=n.displayPosition):t=n.displayPosition,e?n.displayMode&&"silde"!=n.displayMode&&(e=n.displayMode):e=n.displayMode,t){case"topleft":l={top:0-i,left:0,"margin-left":0},r={top:0};break;case"topcenter":l={top:0-i},r={top:0};break;case"topright":l={top:0-i,left:"auto",right:0,"margin-left":0},r={top:0};break;case"middleleft":l={top:"50%",left:0-a,"margin-left":0,"margin-top":0-i/2},r={left:0};break;case"middlecenter":l={top:"0","margin-top":0-i/2},r={top:"50%"};break;case"middleright":l={top:"50%",left:"auto",right:0-a,"margin-top":0-i/2},r={right:0};break;case"bottomleft":l={top:"auto",left:0,bottom:0-i,"margin-left":0},r={bottom:0};break;case"bottomcenter":l={top:"auto",bottom:0-i},r={bottom:0};break;case"bottomright":l={top:"auto",left:"auto",right:0,bottom:0-i,"margin-left":0},r={bottom:0}}"slide"==e?o.css(l).show().animate(r,500):"fade"==e?(l.opacity=.1,o.css(l).css(r).show().animate({opacity:1},500)):o.css(l).css(r).show()},closePosition:function(){var e=BJUI.alertMsg.displayPosition,i=BJUI.alertMsg.displayMode,l=460,r=o.outerHeight(),s={};switch(e?n.displayPosition&&"topcenter"!=n.displayPosition&&(e=n.displayPosition):e=n.displayPosition,i?n.displayMode&&"silde"!=n.displayMode&&(i=n.displayMode):i=n.displayMode,e){case"topleft":s={top:0-r};break;case"topcenter":s={top:0-r};break;case"topright":s={top:0-r};break;case"middleleft":s={left:0-l};break;case"middlecenter":s={top:0-r};break;case"middleright":s={right:0-l};break;case"bottomleft":s={bottom:0-r};break;case"bottomcenter":s={bottom:0-r};break;case"bottomright":s={bottom:0-r}}"slide"==i?o.animate(s,500,function(){a.hide(),t(this).hide().empty()}):"fade"==i?o.animate({opacity:0},500,function(){a.hide(),t(this).hide().empty()}):(o.hide().remove(),a.hide())},open:function(l,r,s){var c,p,d=this,f="",m=BJUI.alertMsg.alertTimeout;if(s)for(var u=0;u<s.length;u++){var y=s[u].call?"callback":"",g=s[u].cls?s[u].cls:"default",h=s[u].cls&&"green"==s[u].cls?"check":"close";f+=FRAG.alertBtnFrag.replace("#btnMsg#",'<i class="fa fa-'+h+'"></i> '+s[u].name).replace("#callback#",y).replace("#class#",g)}c=t(FRAG.alertBoxFrag.replace("#type#",l).replace("#fa#",n.fas[l]).replace("#title#",this.getTitle(l)).replace("#message#",r).replace("#btnFragment#",f)).hide().appendTo("body"),o&&o.length&&o.remove(),o=c,d.openPosition(),i&&(clearTimeout(i),i=null),null==n.mask&&n.types.info!=l&&n.types.correct!=l&&a.show(),null==n.autoClose&&(n.types.info==l||n.types.correct==l)&&(m?n.alertTimeout&&3e3!=n.alertTimeout&&(m=n.alertTimeout):m=n.alertTimeout,i=setTimeout(function(){d.close()},m)),p=o.find(".btn"),p.each(function(o){t(this).on("click",t.proxy(function(){e.tools.close();var t=s[o].call;"string"==typeof t&&(t=t.toFunc()),"function"==typeof t&&t.call()},e)),s[o].keyCode==BJUI.keyCode.ENTER&&t(document).on("keydown.bjui.alertmsg.ok",{target:p.eq(o)},d.keydownOk),s[o].keyCode==BJUI.keyCode.ESC&&t(document).on("keydown.bjui.alertmsg.esc",{target:p.eq(o)},d.keydownEsc)})},alert:function(e,o,a){t.extend(n,"object"==typeof a&&a);var i=t.extend({},{okName:BJUI.regional.alertmsg.btnMsg.ok,okCall:null},n),l=[{name:i.okName,call:i.okCall,cls:"default",keyCode:BJUI.keyCode.ENTER}];this.open(e,o,l)},close:function(){t(document).off("keydown.bjui.alertmsg.ok").off("keydown.bjui.alertmsg.esc"),this.closePosition()}};return l},n.prototype.error=function(t,e){this.tools.alert(this.options.types.error,t,e)},n.prototype.info=function(t,e){this.tools.alert(this.options.types.info,t,e)},n.prototype.warn=function(t,e){this.tools.alert(this.options.types.warn,t,e)},n.prototype.ok=function(t,e){this.tools.alert(this.options.types.correct,t,e)},n.prototype.correct=function(t,e){this.tools.alert(this.options.types.correct,t,e)},n.prototype.confirm=function(e,o){t.extend(this.options,"object"==typeof o&&o);var a=t.extend({},{okName:BJUI.regional.alertmsg.btnMsg.ok,okCall:null,cancelName:BJUI.regional.alertmsg.btnMsg.cancel,cancelCall:null},this.options),i=[{name:a.okName,call:a.okCall,cls:"green",keyCode:BJUI.keyCode.ENTER},{name:a.cancelName,call:a.cancelCall,cls:"red",keyCode:BJUI.keyCode.ESC}];this.tools.open(this.options.types.confirm,e,i)};var l=t.fn.alertmsg;t.fn.alertmsg=e,t.fn.alertmsg.Constructor=n,t.fn.alertmsg.noConflict=function(){return t.fn.alertmsg=l,this},t(document).on("click.bjui.alertmsg.data-api",'[data-toggle="alertmsg"]',function(o){var a,i=t(this),n=i.data(),l=n.options;return l&&("string"==typeof l&&(l=l.toObj()),"object"==typeof l&&t.extend(n,l)),(a=n.type)?(e.call(i,a,n.msg||a,n),void o.preventDefault()):!1})}(jQuery);
+function(e){"use strict";function t(t){var i=arguments,n=t;return this.each(function(){var r=e(this),l=e.extend({},a.DEFAULTS,r.data(),"object"==typeof t&&t),g=r.data("bjui.pagination");g||r.data("bjui.pagination",g=new a(this,l)),"string"==typeof n&&e.isFunction(g[n])?([].shift.apply(i),i?g[n].apply(g,i):g[n]()):g.init()})}var a=function(t,a){this.$element=e(t),this.options=a,this.tools=this.TOOLS()};a.DEFAULTS={first:"li.j-first",prev:"li.j-prev",next:"li.j-next",last:"li.j-last",nums:"li.j-num > a",jump:"li.jumpto",pageNumFrag:'<li class="#liClass#"><a href="javascript:;">#pageNum#</a></li>',total:0,pageSize:10,pageNum:10,pageCurrent:1,callback:function(){return!1}},a.prototype.TOOLS=function(){var e=this.options,t={pageNums:function(){return Math.ceil(e.total/e.pageSize)},getInterval:function(){var t=Math.ceil(e.pageNum/2),a=this.pageNums(),i=a-e.pageNum,n=this.getCurrentPage()>t?Math.max(Math.min(this.getCurrentPage()-t,i),0):0,r=this.getCurrentPage()>t?Math.min(this.getCurrentPage()+t,a):Math.min(e.pageNum,a);return{start:n+1,end:r+1}},getCurrentPage:function(){var t=parseInt(e.pageCurrent);return isNaN(t)?1:t},hasPrev:function(){return this.getCurrentPage()>1},hasNext:function(){return this.getCurrentPage()<this.pageNums()}};return t},a.prototype.init=function(){function t(t,i){t.on("click",function(t){var n={pageCurrent:i,pageSize:a.options.pageSize};a.setClientPaging(n),e(this).bjuiajax("pageCallback",n,a.$element.closest(".bjui-layout")),t.preventDefault()})}BJUI.ui.clientPaging&&!this.getClientPaging()&&this.setClientPaging({pageCurrent:this.options.pageCurrent,pageSize:this.options.pageSize});for(var a=this,i=this.options,n=this.tools,r=n.getInterval(),l="",g=FRAG.pagination,s=BJUI.regional.pagination,o=r.start;o<r.end;o++)l+=i.pageNumFrag.replaceAll("#pageNum#",o).replaceAll("#liClass#",o==n.getCurrentPage()?"selected j-num":"j-num");g=g.replaceAll("#pageNumFrag#",l).replaceAll("#pageCurrent#",n.getCurrentPage()).replaceAll("#first#",s.first).replaceAll("#last#",s.last).replaceAll("#prev#",s.prev).replaceAll("#next#",s.next).replaceAll("#jumpto#",s.jumpto).replaceAll("#jump#",s.jump),this.$element.html(g);var u=this.$element.find(i.first),p=this.$element.find(i.prev),c=this.$element.find(i.next),d=this.$element.find(i.last);n.hasPrev()?(u.add(p).find("> span").hide(),t(p,n.getCurrentPage()-1),t(u,1)):u.add(p).addClass("disabled").find("> a").hide(),n.hasNext()?(c.add(d).find("> span").hide(),t(c,n.getCurrentPage()+1),t(d,n.pageNums())):c.add(d).addClass("disabled").find("> a").hide(),this.$element.find(i.nums).each(function(a){t(e(this),a+r.start)}),this.$element.find(i.jump).each(function(){var t=e(this).find(":text"),n=e(this).find(".goto");n.on("click",function(){var n=t.val(),r={pageCurrent:n,pageSize:i.pageSize};n&&n.isPositiveInteger()&&(a.setClientPaging(r),e(this).bjuiajax("pageCallback",r,a.$element.closest(".bjui-layout")))}),t.keyup(function(e){e.keyCode==BJUI.keyCode.ENTER&&n.trigger("click")})})},a.prototype.changePagesize=function(){var e=this,t=e.$element.val(),a={pageSize:t};isNaN(t)||(e.setClientPaging(a),e.$element.bjuiajax("pageCallback",a,e.$element.closest(".bjui-layout")))},a.prototype.orderBy=function(t){var a=this;a.$element.css({cursor:"pointer"}).click(function(){var t=e(this).data("orderField"),i=e(this).data("orderDirection"),n={orderField:t,orderDirection:i};a.setClientPaging(n),e(this).bjuiajax("pageCallback",n,a.$element.closest(".bjui-layout"))})},a.prototype.destroy=function(){this.$element.removeData("bjui.pagination").empty()},a.prototype.getTarget=function(){var t,a=this;return t=a.$element.closest(".bjui-layout").length?a.$element.closest(".bjui-layout"):a.$element.closest(".navtab-panel").length?e.CurrentNavtab:e.CurrentDialog},a.prototype.getClientPaging=function(){return this.getTarget().data("bjui.clientPaging")},a.prototype.setClientPaging=function(t){if(BJUI.ui.clientPaging){var a=this.getTarget();a.data("bjui.clientPaging",e.extend({},a.data("bjui.clientPaging")||{},t))}},a.prototype.setClientOrder=function(e){if(BJUI.ui.clientPaging){var t=this.getClientPaging();t&&t.orderField||this.setClientPaging(e)}},a.prototype.setPagingAndOrderby=function(e){var t=e.data("bjui.clientPaging");e.find('[data-toggle="pagination"]').pagination("destroy").pagination(t),t.pageSize&&e.find('select[data-toggle-change="changepagesize"]').selectpicker("val",t.pageSize),t.orderField&&e.find('th[data-order-field="'+t.orderField+'"]').addClass(t.orderDirection).siblings().removeClass("asc desc")};var i=e.fn.pagination;e.fn.pagination=t,e.fn.pagination.Constructor=a,e.fn.pagination.noConflict=function(){return e.fn.pagination=i,this},e(document).on(BJUI.eventType.initUI,function(a){var i=e(a.target).find('[data-toggle="pagination"]');i.length&&t.call(i)}),e(document).on("change.bjui.pagination.data-api",'select[data-toggle-change="changepagesize"]',function(a){{var i=e(this);i.data()}t.call(i,"changePagesize"),a.preventDefault()})}(jQuery);
+function($){"use strict";function LZ(e){return(0>e||e>9?"":"0")+e}function formatDate(e,t){t+="";var n,r="",l=0,a="",g="",u=e.getYear()+"",i=e.getMonth()+1,s=e.getDate(),h=e.getDay(),n=e.getHours(),f=e.getMinutes(),o=e.getSeconds(),M={};for(u.length<4&&(u=""+(u-0+1900)),M.y=""+u,M.yyyy=u,M.yy=u.substring(2,4),M.M=i,M.MM=LZ(i),M.MMM=MONTH_NAMES[i-1],M.NNN=MONTH_NAMES[i+11],M.d=s,M.dd=LZ(s),M.E=DAY_NAMES[h+7],M.EE=DAY_NAMES[h],M.H=n,M.HH=LZ(n),M.h=0==n?12:n>12?n-12:n,M.hh=LZ(M.h),M.K=n>11?n-12:n,M.k=n+1,M.KK=LZ(M.K),M.kk=LZ(M.k),M.a=n>11?"PM":"AM",M.m=f,M.mm=LZ(f),M.s=o,M.ss=LZ(o);l<t.length;){for(a=t.charAt(l),g="";t.charAt(l)==a&&l<t.length;)g+=t.charAt(l++);r+=null!=M[g]?M[g]:g}return r}function _isInteger(e){return new RegExp(/^\d+$/).test(e)}function _getInt(e,t,n,r){for(var l=r;l>=n;l--){var a=e.substring(t,t+l);if(a.length<n)return null;if(_isInteger(a))return a}return null}function parseDate(e,t){e+="",t+="";for(var n,r,l=0,a=0,g="",u="",i=new Date(1900,0,1),s=i.getYear(),h=i.getMonth()+1,f=1,o=i.getHours(),M=i.getMinutes(),y=i.getSeconds(),A="";a<t.length;){for(g=t.charAt(a),u="";t.charAt(a)==g&&a<t.length;)u+=t.charAt(a++);if("yyyy"==u||"yy"==u||"y"==u){if("yyyy"==u&&(n=4,r=4),"yy"==u&&(n=2,r=2),"y"==u&&(n=2,r=4),s=_getInt(e,l,n,r),null==s)return 0;l+=s.length,2==s.length&&(s=s>70?1900+(s-0):2e3+(s-0))}else if("MMM"==u||"NNN"==u){h=0;for(var c=0;c<MONTH_NAMES.length;c++){var N=MONTH_NAMES[c];if(e.substring(l,l+N.length).toLowerCase()==N.toLowerCase()&&("MMM"==u||"NNN"==u&&c>11)){h=c+1,h>12&&(h-=12),l+=N.length;break}}if(1>h||h>12)return 0}else if("EE"==u||"E"==u)for(var c=0;c<DAY_NAMES.length;c++){var p=DAY_NAMES[c];if(e.substring(l,l+p.length).toLowerCase()==p.toLowerCase()){l+=p.length;break}}else if("MM"==u||"M"==u){if(h=_getInt(e,l,u.length,2),null==h||1>h||h>12)return 0;l+=h.length}else if("dd"==u||"d"==u){if(f=_getInt(e,l,u.length,2),null==f||1>f||f>31)return 0;l+=f.length}else if("hh"==u||"h"==u){if(o=_getInt(e,l,u.length,2),null==o||1>o||o>12)return 0;l+=o.length}else if("HH"==u||"H"==u){if(o=_getInt(e,l,u.length,2),null==o||0>o||o>23)return 0;l+=o.length}else if("KK"==u||"K"==u){if(o=_getInt(e,l,u.length,2),null==o||0>o||o>11)return 0;l+=o.length}else if("kk"==u||"k"==u){if(o=_getInt(e,l,u.length,2),null==o||1>o||o>24)return 0;l+=o.length,o--}else if("mm"==u||"m"==u){if(M=_getInt(e,l,u.length,2),null==M||0>M||M>59)return 0;l+=M.length}else if("ss"==u||"s"==u){if(y=_getInt(e,l,u.length,2),null==y||0>y||y>59)return 0;l+=y.length}else if("a"==u){if("am"==e.substring(l,l+2).toLowerCase())A="AM";else{if("pm"!=e.substring(l,l+2).toLowerCase())return 0;A="PM"}l+=2}else{if(e.substring(l,l+u.length)!=u)return 0;l+=u.length}}if(l!=e.length)return 0;if(2==h)if(s%4==0&&s%100!=0||s%400==0){if(f>29)return 0}else if(f>28)return 0;return(4==h||6==h||9==h||11==h)&&f>30?0:(12>o&&"PM"==A?o=o-0+12:o>11&&"AM"==A&&(o-=12),new Date(s,h-1,f,o,M,y))}function replaceTmEval(data){return data.replace(RegExp("({[A-Za-z0-9_+-]*})","g"),function($1){return eval("("+$1.replace(/[{}]+/g,"")+")")})}var MONTH_NAMES=new Array("January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),DAY_NAMES=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat");Date.prototype.formatDate=function(e){return formatDate(this,e)},String.prototype.parseDate=function(e){return this.length<e.length&&(e=e.slice(0,this.length)),parseDate(this,e)},Date.prototype.formatDateTm=function(e){var t=this.getFullYear(),n=this.getMonth()+1,r=this.getDate(),l=e.replaceAll("%y",t).replaceAll("%M",n).replaceAll("%d",r);l=replaceTmEval(l);var a=1900,g=0,u=1,i=l.split("-");return i.length>0&&(a=i[0]),i.length>1&&(g=i[1]-1),i.length>2&&(u=i[2]),new Date(a,g,u).formatDate("yyyy-MM-dd")}}(jQuery);
+function(e){"use strict";function t(t){var n=arguments,a=t;return this.each(function(){var i=e(this),s=e.extend({},D.DEFAULTS,i.data(),"object"==typeof t&&t),o=i.data("bjui.datepicker");o||i.data("bjui.datepicker",o=new D(this,s)),"string"==typeof a&&e.isFunction(o[a])?([].shift.apply(n),n?o[a].apply(o,n):o[a]()):o.init()})}var n,a,i,s,o,c,r,d,l,h,f,u,p,m,v,g,k,y;e(function(){var t=function(){var t=BJUI.regional.datepicker,D=FRAG.calendarFrag.replace("#close#",t.close).replace("#prev#",t.prev).replace("#next#",t.next).replace("#clear#",t.clear).replace("#ok#",t.ok);n=e(D).hide(),e("body").append("<!-- datepicker -->").append(n),a=n.find("> .main"),i=n.find("a.prev"),s=n.find("a.next"),o=n.find("select[name=year]"),c=n.find("select[name=month]"),r=n.find(".time"),d=r.find(":text"),l=r.find("ul > li"),h=r.find(".hh"),f=r.find(".mm"),u=r.find(".ss"),p=a.find("> .tm"),m=n.find(".close"),v=a.find("> .body > .days"),g=a.find("> .body > .dayNames"),k=n.find(".clearBtn"),y=n.find(".okBtn");var _="",b=BJUI.regional.datepicker;e.each(b.dayNames,function(e,t){_+="<dt>"+t+"</dt>"}),g.html(_),e.each(b.monthNames,function(e,t){var n=e+1;c.append('<option value="'+n+'">'+t+"</option>")}),n.on("selectstart",function(){return!1})};t()});var D=function(t,n){this.$element=e(t),this.options=n,this.tools=this.TOOLS(),this.$dateBtn=null;var a=new Date;this.options.minDate=a.formatDateTm(this.options.minDate),this.options.maxDate=a.formatDateTm(this.options.maxDate),this.events={focus_time:"focus.bjui.datepicker.time",click_prev:"click.bjui.datepicker.prev",click_next:"click.bjui.datepicker.next",click_ok:"click.bjui.datepicker.ok",click_days:"click.bjui.datepicker.days",click_clear:"click.bjui.datepicker.clear",click_close:"click.bjui.datepicker.close",click_tm:"click.bjui.datepicker.tm",click_spinner:"click.bjui.datepicker.spinner",mousedown_sp:"mousedown.bjui.datepicker.spinner",mouseup_sp:"mouseup.bjui.datepicker.spinner",change_ym:"change.bjui.datepicker.ym",click_time:"click.bjui.datepicker.time",keydown_time:"keydown.bjui.datepicker.time",keyup_time:"keyup.bjui.datepicker.time"}};D.DEFAULTS={pattern:"yyyy-MM-dd",minDate:"1900-01-01",maxDate:"2099-12-31",mmStep:1,ssStep:1},D.EVENTS={afterChange:"afterchange.bjui.datepicker"},D.prototype.TOOLS=function(){var t=this,a={changeTmMenu:function(e){p.removeClass("hh").removeClass("mm").removeClass("ss"),e&&(p.addClass(e),d.removeClass("slt").filter("."+e).addClass("slt"))},clickTmMenu:function(n,a){p.find("> ul").hide().filter("."+a).show().find("> li").off(t.events.click_tm).on(t.events.click_tm,function(){var t=e(this),a=parseInt(t.text())<10?"0"+t.text():t.text();n.val(a)})},keydownInt:function(e){return e.keyCode>=48&&e.keyCode<=57||e.keyCode==BJUI.keyCode.DELETE||e.keyCode==BJUI.keyCode.BACKSPACE?void 0:!1},changeTm:function(e,t){var n=parseInt(e.val()),a=parseInt(e.data("start"))||0,i=parseInt(e.data("end")),s=parseInt(e.data("step")||1),o=t?t.data("add")?t.data("add"):-1:0,c=n;1==o?i-s>=n&&(c=n+s):-1==o?n>=a+s&&(c=n-s):n>i?c=i:a>n&&(c=a),10>c&&(c="0"+c),e.val(c)},closeCalendar:function(i){a.changeTmMenu(),i&&(e(document).off(t.events.click_close),n.hide())},get:function(e){return t.options[e]},getDays:function(e,t){return 2==t?e%4||!(e%100)&&e%400?28:29:/4|6|9|11/.test(t)?30:31},minMaxDate:function(e){var t=e.split("-").length-1,n="y-M-d";return 1==t?n="y-M":0==t&&(n="y"),e.parseDate(n)},getMinDate:function(){return this.minMaxDate(t.options.minDate)},getMaxDate:function(){var e=t.options.maxDate,n=e.split("-").length-1,a=this.minMaxDate(e);if(2>n){var i=this.getDays(a.getFullYear(),a.getMonth()+1);a.setDate(i),0==n&&a.setMonth(11)}return a},getDateWrap:function(e){e||(e=this.parseDate(t.sDate)||new Date);var n=e.getFullYear(),a=e.getMonth()+1,i=this.getDays(n,a);return{year:n,month:a,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),days:i,date:e}},changeDate:function(e,n,a){var i=new Date(e,n-1,a||1);return t.sDate=this.formatDate(i),i},changeDateTime:function(e,n,a,i,s,o){var c=new Date(e,n-1,a,i,s,o);return t.sDate=this.formatDate(c),c},changeDay:function(e,t){t||(t=0);var n=this.getDateWrap();return this.changeDate(n.year,n.month+parseInt(t),e)},changeMonth:function(e){var t=o.get(0).selectedIndex,n=o.find("option").length,a=1*c.val()+e;0==a?0==t?a=1:(a=12,t--,o.get(0).selectedIndex=t):13==a&&(t==n-1?a=12:(a=1,t++,o.get(0).selectedIndex=t)),c.val(a).change()},parseDate:function(e){return e?e.parseDate(t.options.pattern):null},formatDate:function(e){return e.formatDate(t.options.pattern)},hasHour:function(){return-1!=t.options.pattern.indexOf("H")},hasMinute:function(){return-1!=t.options.pattern.indexOf("m")},hasSecond:function(){return-1!=t.options.pattern.indexOf("s")},hasTime:function(){return this.hasHour()||this.hasMinute()||this.hasSecond()},hasDate:function(){for(var e=["y","M","d","E"],n=0;n<e.length;n++)if(-1!=t.options.pattern.indexOf(e[n]))return!0;return!1},afterChange:function(e){t.$element.trigger(D.EVENTS.afterChange,{value:e})}};return a},D.prototype.addBtn=function(){var t=this,n=t.$element;if(!this.$dateBtn&&!this.options.addbtn&&!n.parent().hasClass("wrap_bjui_btn_box")){this.$dateBtn=e(FRAG.dateBtn),this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box"></span>');var a=this.$element.parent(),i=this.$element.addClass("form-control").innerHeight();a.css({position:"relative",display:"inline-block"}),this.$dateBtn.css({height:i,lineHeight:i+"px"}).appendTo(a),this.$dateBtn.on("selectstart",function(){return!1})}},D.prototype.init=function(){this.$element.val()&&(this.sDate=this.$element.val().trim());var t=this,n=(this.options,this.tools),a=n.getDateWrap(),r=n.getMinDate(),d=n.getMaxDate(),l=r.getFullYear(),p=d.getFullYear();o.empty();for(var g=l;p>=g;g++)o.append('<option value="'+g+'"'+(a.year==g?" selected":"")+">"+g+"</option>");c.val(a.month),o.add(c).off(this.events.change_ym).on(this.events.change_ym,function(){if(n.hasTime()){var e=v.find(".slt"),i=n.changeDateTime(o.val(),c.val(),e.data("day"),a.hour,a.minute,a.second);t.create(n.getDateWrap(i),r,d)}else{var e=v.find(".slt"),i=n.changeDate(o.val(),c.val(),e.data("day"));t.create(n.getDateWrap(i),r,d)}}),i.off(this.events.click_prev).on(this.events.click_prev,function(){t.tools.changeMonth(-1)}),s.off(this.events.click_prev).on(this.events.click_prev,function(){t.tools.changeMonth(1)}),k.off(this.events.click_clear).on(this.events.click_clear,function(){t.$element.val(""),n.closeCalendar(!0)}),y.off(this.events.click_ok).on(this.events.click_ok,function(){var e=v.find("dd.slt");if(e.hasClass("disabled"))return!1;var a=n.changeDay(e.data("day"),e.data("month"));n.hasTime()&&(a.setHours(parseInt(h.val())),a.setMinutes(parseInt(f.val())),a.setSeconds(parseInt(u.val()))),n.closeCalendar(!0),t.$element.val(n.formatDate(a)).focus(),n.afterChange(a)}),m.off(this.events.click_close).on(this.events.click_close,function(){n.closeCalendar(!0)}),e(document).on(this.events.click_close,function(a){var i=e(a.target);a.target!=t.$element.get(0)&&(i.closest("#calendar").length||n.closeCalendar("datepicker"==i.data("toggle")||"datepickerbtn"==i.parent().data("toggle")||"datepickerbtn"==i.data("toggle")?!1:!0))}),this.create(a,r,d)},D.prototype.create=function(t,i,s){var o=this,c=this.options,m=this.tools,g=new Date(t.year,t.month-1,1),k=g.getDay(),y="";if(k>0){g.setMonth(g.getMonth()-1);for(var D=m.getDateWrap(g),_=D.days-k+1;_<=D.days;_++){var b=new Date(t.year,t.month-2,_),C=b>=i&&s>=b?"":" disabled";y+='<dd class="other'+C+'" data-month="-1" data-day="'+_+'">'+_+"</dd>"}}for(var _=1;_<=t.days;_++){var b=new Date(t.year,t.month-1,_),C=b>=i&&s>=b?"":"disabled";_==t.day&&(C+=" slt"),y+='<dd class="'+C+'" data-day="'+_+'">'+_+"</dd>"}for(var _=1;_<=42-k-t.days;_++){var b=new Date(t.year,t.month,_),C=b>=i&&s>=b?"":" disabled";y+='<dd class="other'+C+'" data-month="1" data-day="'+_+'">'+_+"</dd>"}var M=v.html(y).find("dd");if(M.not(".disabled").off(this.events.click_days).on(this.events.click_days,function(){var t=e(this);if(m.hasTime())M.removeClass("slt"),t.addClass("slt");else{var n=m.changeDay(t.data("day"),t.data("month"));m.closeCalendar(!0),o.$element.val(m.formatDate(n)).focus(),m.afterChange(n)}}),m.hasDate()?a.removeClass("nodate"):a.addClass("nodate"),m.hasTime()){r.show(),h.val(t.hour<10?"0"+t.hour:t.hour).off(this.events.focus_time).on(this.events.focus_time,function(){m.changeTmMenu("hh")});var x=parseInt(t.minute/c.mmStep)*c.mmStep;f.val(10>x?"0"+x:x).data("step",c.mmStep).off(this.events.focus_time).on(this.events.focus_time,function(){m.changeTmMenu("mm")}),u.val(m.hasSecond()?t.second<10?"0"+t.second:t.second:"00").data("step",c.ssStep).off(this.events.focus_time).on(this.events.focus_time,function(){m.changeTmMenu("ss")}),n.off("click").on("click",function(t){e(t.target).closest(".time").length||(p.find("> ul").hide(),m.changeTmMenu())}),d.off(this.events.keydown_time).on(this.events.keydown_time,m.keydownInt).each(function(){var t=e(this);t.off(o.events.keyup_time).on(o.events.keyup_time,function(){m.changeTm(t)})}).off(this.events.click_time).on(this.events.click_time,function(){m.clickTmMenu(e(this),e(this).data("type"))});var T=null;l.off(this.events.click_spinner).on(this.events.click_spinner,function(t){var n=e(this);d.filter(".slt").each(function(){m.changeTm(e(this),n)}),t.preventDefault()}).off(this.events.mousedown_sp).on(this.events.mousedown_sp,function(t){var n=e(this);T=setInterval(function(){d.filter(".slt").each(function(){m.changeTm(e(this),n)})},150)}).off(this.events.mouseup_sp).on(this.events.mouseup_sp,function(e){clearTimeout(T)}),m.hasHour()||h.attr("disabled",!0),m.hasMinute()||f.attr("disabled",!0),m.hasSecond()||u.attr("disabled",!0)}else r.hide();this.show()},D.prototype.show=function(){var t=this.$element.offset(),a=t.top+this.$element.get(0).offsetHeight,i=n.outerHeight(!0);a>i&&a>e(window).height()-i&&(a=t.top-i),n.css({left:t.left,top:a}).show().click(function(e){e.stopPropagation()})};var _=e.fn.datepicker;e.fn.datepicker=t,e.fn.datepicker.Constructor=D,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=_,this},e(document).on(BJUI.eventType.initUI,function(n){var a=e(n.target).find('[data-toggle="datepicker"]');a.length&&(a.data("nobtn")||t.call(a,"addBtn"))}),e(document).on("click.bjui.datepicker.data-api",'[data-toggle="datepickerbtn"]',function(n){var a=e(this).prevAll('[data-toggle="datepicker"]');a&&a.is(":text")&&(t.call(a,a.data()),n.preventDefault())}),e(document).on("click.bjui.datepicker.data-api",'[data-toggle="datepicker"]',function(n){var a=e(this);a.data("onlybtn")||a.is(":text")&&(t.call(a,a.data()),n.preventDefault())})}(jQuery);
+function(t){"use strict";function a(a){var i=arguments,r=a;return this.each(function(){var n=t(this),o=t.extend({},e.DEFAULTS,n.data(),"object"==typeof a&&a),l=n.data("bjui.ajaxtab");l||n.data("bjui.ajaxtab",l=new e(this,o)),"string"==typeof r&&t.isFunction(l[r])?([].shift.apply(i),i?l[r].apply(l,i):l[r]()):l.init()})}var e=function(a,e){this.$element=t(a),this.options=e};e.DEFAULTS={url:void 0,target:void 0,reload:!1},e.prototype.init=function(){var t=this.options;if(!t.url)return void BJUI.debug("Ajaxtab Plugin: Error trying to open a tab, url is undefined!");if(t.url=decodeURI(t.url).replacePlh(this.$element.closest(".unitBox")),!t.url.isFinishedTm())return this.$element.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("Ajaxtab Plugin: The new ajaxtab's url is incorrect, url: "+t.url);if(t.url=encodeURI(t.url),!t.target)return void BJUI.debug("Ajaxtab Plugin: Attribute 'target' is not defined!");if(t.reload)this.load();else{var a=this.$element.data("bjui.ajaxtab.reload");a?this.$element.tab("show"):this.load()}},e.prototype.load=function(){var a=this.$element,e=this.options;t(e.target).ajaxUrl({url:e.url,data:{},callback:function(){a.data("bjui.ajaxtab.reload",!0).tab("show")}})};var i=t.fn.ajaxtab;t.fn.ajaxtab=a,t.fn.ajaxtab.Constructor=e,t.fn.ajaxtab.noConflict=function(){return t.fn.ajaxtab=i,this},t(document).on("click.bjui.ajaxtab.data-api",'[data-toggle="ajaxtab"]',function(e){var i=t(this),r=i.data();r.url||(r.url=i.attr("href")),a.call(i,r),e.preventDefault()})}(jQuery);
+function(t){"use strict";function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),d=t.extend({},a.DEFAULTS,o.data(),"object"==typeof e&&e),l=o.data("bjui.datagrid");l||o.data("bjui.datagrid",l=new a(this,d)),"string"==typeof n&&t.isFunction(l[n])?([].shift.apply(i),i?l[n].apply(l,i):l[n]()):l.init()})}var a=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS(),this.datanames={tbody:"bjui.datagrid.tbody.dom",td_html:"bjui.datagrid.td.html",changeData:"bjui.datagrid.tr.changeData"},this.classnames={s_checkbox:"datagrid-checkbox",s_linenumber:"datagrid-linenumber",s_edit:"datagrid-column-edit",s_lock:"datagrid-lock",s_menu:"datagrid-menu-box",s_filter:"datagrid-filter-box",s_showhide:"datagrid-showhide-box",th_cell:"datagrid-cell",th_menu:"datagrid-column-menu",btn_menu:"datagrid-column-menu-btn",th_col:"datagrid-col",th_field:"datagrid-col-field",th_sort:"datagrid-sortable",th_resize:"datagrid-resize-head",th_resizemark:"datagrid-column-resizemark",tr_edit:"datagrid-edit-tr",tr_add:"datagrid-add-tr",tr_selected:"datagrid-selected-tr",td_edit:"datagrid-edit-td",td_changed:"datagrid-changed",td_linenumber:"datagrid-linenumber-td",td_checkbox:"datagrid-checkbox-td",li_asc:"datagrid-li-asc",li_desc:"datagrid-li-desc",li_filter:"datagrid-li-filter",li_showhide:"datagrid-li-showhide",li_lock:"datagrid-li-lock",li_unlock:"datagrid-li-unlock"}};a.DEFAULTS={gridTitle:"",columns:null,data:null,dataUrl:null,loadType:"POST",dataType:"json",local:"remote",fieldSortable:!0,filterThead:!0,sortAll:!1,filterAll:!1,filterMult:!0,linenumberAll:!1,showLinenumber:!0,showCheckboxcol:!1,showEditbtnscol:!1,showTfoot:!1,showToolbar:!1,toolbarItem:"",toolbarCustom:"",columnResize:!0,columnMenu:!0,columnShowhide:!0,columnFilter:!0,columnLock:!0,paging:!0,pagingAlign:"center",editUrl:null,editCallback:null,editMode:"inline",editDialogOp:null,inlineEditMult:!0,saveAll:!0,addLocation:"first",delUrl:null,delType:"POST",delPK:null,delConfirm:!0,delCallback:null,jsonPrefix:"",contextMenuH:!0,contextMenuB:!1,hScrollbar:!1,fullGrid:!1,importOption:null,exportOption:null,beforeEdit:null,beforeDelete:null,afterSave:null,afterDelete:null},a.renderItem=function(e,a){if(!a||!a.length)return"";var i="";return t.each(a,function(t,a){return"undefined"!=typeof a[e]?(i=a[e],!1):void 0}),i},a.prototype.TOOLS=function(){var e=this,a=e.options,i={getPageCount:function(t,e){return Math.ceil(e/t)},getPageInterval:function(t,e,a){var i=Math.ceil(a/2),n=t-a,o=e>i?Math.max(Math.min(e-i,n),0):0,d=e>i?Math.min(e+i,t):Math.min(a,t);return d-o==a&&(d+=1),a>d&&(d+=1),{start:o+1,end:d}},getRight:function(a){var i=0,n=a.data("index"),o=e.$tbody.find("> tr:first > td:lt("+(n+1)+")");return o&&o.length||(o=e.$colgroupH.find("> col:lt("+(n+1)+")")),o.each(function(){var e=t(this),a=e.is(":hidden")?0:e.outerWidth();i+=a}),i},getRight4Lock:function(a){var i=0,n=e.$lockTbody.find("> tr:first > td:eq("+a+")"),o=n&&n.prevAll().add(n);return o&&o.length||(o=e.$lockColgroupH.filter(":lt("+(a+1)+")")),o.each(function(){var e=t(this),a=e.is(":hidden")?0:e.outerWidth();i+=a}),i},beforeEdit:function(t,i){var n=a.beforeEdit;return n&&("string"==typeof n&&(n=n.toFunc()),"function"==typeof n)?n.call(e,t,i):!0},afterSave:function(t,i){var n=a.afterSave;n&&("string"==typeof n&&(n=n.toFunc()),"function"==typeof n&&n.call(e,t,i))},afterDelete:function(){var t=a.afterDelete;t&&("string"==typeof t&&(t=t.toFunc()),"function"==typeof t&&t.call(e))},setColspan:function(t,e){t.colspan&&(t.colspan=t.colspan+e-1),t.index=t.index+e-1,t.parent&&this.setColspan(t.parent,e)},columns2Arr:function(a,i,n,o){var d=this;return i||(i=[]),n||(n=0),i[n]||(i[n]=[]),t.each(a,function(t,a){var l,s=i[n].length;return o&&(a.parent=o),a.columns?(l=a.columns.length,n&&a.parent&&d.setColspan(a.parent,l),a.index=e.columnModel.length+l-1,a.colspan=l,a.quicksort=!1,i[n][s++]=a,d.columns2Arr(a.columns,i,n+1,a)):(a.rowspan=n,a.index=e.columnModel.length,a.menu="undefined"==typeof a.menu?!0:a.menu,a.lock="undefined"==typeof a.lock?!0:a.lock,a.hide="undefined"==typeof a.hide?!1:a.hide,a.edit="undefined"==typeof a.edit?!0:a.edit,a.add="undefined"==typeof a.add?!0:a.add,a.quicksort="undefined"==typeof a.quicksort?!0:a.quicksort,i[n][s++]=a,e.columnModel.push(a),void 0)}),i},createTrsByData:function(a,n){var o;e.$tbody||(e.$tbody=t("<tbody></tbody>")),a&&(o=a.list?a.list:a,e.paging.total=o.length,"object"==typeof a&&(a[BJUI.pageInfo.total]&&(e.paging.total=parseInt(a[BJUI.pageInfo.total])),a[BJUI.pageInfo.pageSize]&&(n&&e.paging.pageSize!=a[BJUI.pageInfo.pageSize]&&e.$selectpage.trigger("bjui.datagrid.paging.pageSize",a[BJUI.pageInfo.pageSize]),e.paging.pageSize=parseInt(a[BJUI.pageInfo.pageSize]))),e.paging.pageCount=i.getPageCount(e.paging.pageSize,e.paging.total),e.paging.pageCurrent>e.paging.pageCount&&(e.paging.pageCurrent=e.paging.pageCount),this.initTbody(o,n)),e.init_tbody||e.$tbody.appendTo(e.$element),e.init_thead||e.initThead()},initTbody:function(i,n){var o,d=this,l=e.allData,s=a.dataType||"json",r=e.columnModel,c=e.hiddenFields,h=(e.regional,[]),g=e.attach,u=e.paging,p=0,f=u.pageSize,m=function(){if(s=s.toLowerCase(),i&&(l=e.allData=i),l.length?"local"==a.local?(p=u.pageSize*(u.pageCurrent-1),f=p+u.pageSize,u.total!=l.length&&(u.total=l.length),p>l.length&&(p=u.pageSize*(u.pageCount-1))):l.length>u.pageSize&&(f=u.pageSize):f=0,f>l.length&&(f=l.length),"array"==s&&i&&i.length&&"array"==t.type(i[0])){var m,b=p,v=f,$=[];"local"==a.local&&(b=0,v=l.length);for(var k=b;v>k;k++)o={},m=0,t.each(l[k],function(e,a){var i,n=a;r[m]&&r[m].gridNumber&&m++,r[m]&&r[m].gridCheckbox&&m++,"string"==typeof n&&(n='"'+n+'"'),r[m]&&!r[m].gridEdit?(i='{"'+r[m].name+'":'+n+"}",t.extend(o,JSON.parse(i))):(r[m]&&r[m].gridEdit&&m++,m>=r.length&&c&&c[e-r.length]&&(i='{"'+c[e-r.length]+'":'+n+"}",t.extend(o,JSON.parse(i)))),m++}),$.push(o);l=e.allData=$}for(var k=p;f>k;k++)o=t.extend({},e.allData[k],g),h.push(o);d.createTrs(h,n),e.data=h};n&&e.$boxM?e.$boxM.show().trigger("bjui.ajaxEnd").trigger("bjui.ajaxStart",[50,m]):m()},createTrs:function(i,n){var o=e.columnModel,d=e.paging,l=BJUI.doRegional(FRAG.gridEditBtn,e.regional);n&&(t.each(o,function(t,a){a.locked&&(e.colLock(a.th,!1),a.lock_refresh=!0)}),e.$tbody.empty(),e.$lockTableH&&e.$lockTableH.empty(),e.$lockTableB&&e.$lockTableB.empty()),t.each(i,function(s,r){var c,h=t("<tr></tr>"),g=a.linenumberAll?(d.pageCurrent-1)*d.pageSize+(s+1):s+1;t.extend(r,{gridNumber:g,gridIndex:s}),t.each(o,function(a,o){var d,g=o.name||"datagrid-noname",u=r[g],p="",f="";if("undefined"==typeof u&&(u=""),d=u,o.align&&(p=' align="'+o.align+'"'),o.gridCheckbox&&(u='<div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div>'),o.gridEdit&&(u=l,f=' class="'+e.classnames.s_edit+'"'),o.calc){o.calc_count||(o.calc_count=i.length);var m=u&&String(u).isNumber()?1*u:0;"sum"==o.calc||"avg"==o.calc?o.calc_sum=(o.calc_sum||0)+m:"max"==o.calc?o.calc_max=o.calc_max?o.calc_max<m?m:o.calc_max:m:"min"==o.calc&&(o.calc_min=o.calc_min?o.calc_min>m?m:o.calc_min:m)}if(c=t("<td"+p+f+"><div>"+u+"</div></td>"),c.data("val",u).appendTo(h),o.gridNumber&&c.addClass(e.classnames.td_linenumber),o.gridCheckbox&&c.addClass(e.classnames.td_checkbox),n&&o.hidden&&c.css("display","none"),o.items&&!o.render&&(o.render=t.datagrid.renderItem),o.render&&"string"==typeof o.render&&(o.render=o.render.toFunc()),o.render&&"function"==typeof o.render){var b="";if(o.items){"string"==typeof o.items&&(o.render=o.render.trim().startsWith("[")?o.render.toObj():o.render.toFunc()),o.renderTds||(o.renderTds=[]);var v=function(a,i){t.when(o.items.call(e)).then(function(n){o.items=n,b=o.render.call(e,i,n),a.html(b),t.each(o.renderTds,function(t,a){b=o.render.call(e,a.text(),n),a.html(b),t==o.renderTds.length-1&&(o.renderTds=null)}),e.delayRender--})};"function"==typeof o.items?0==s?(e.delayRender||(e.delayRender=0),e.delayRender++,v(c,d)):o.renderTds.push(c):(b=o.render.call(e,d,o.items),c.html(b))}else b=o.render.call(e,d),c.html(b)}}),h.appendTo(e.$tbody),n&&h.initui()}),n&&(e.initEvents(),a.editMode&&e.edit(),e.$paging&&e.$paging.trigger("bjui.datagrid.paging.jump"),t.each(o,function(t,a){a.lock_refresh&&(e.colLock(a.th,!0),delete a.lock_refresh)})),e.$boxM&&e.$boxM.trigger("bjui.ajaxStop").hide()},loadData:function(i,n){{var o=this,d=a.dataUrl,l=a.dataType||"json";e.columnModel}e.$tbody&&e.$boxM.show().trigger("bjui.ajaxStart",[50]),l=l.toLowerCase(),"array"==l&&(l="text"),t.ajax({url:d,data:i||{},type:a.loadType,cache:a.cache||!1,dataType:l,success:function(e){if("xml"==l){var a,i=[];t(e).find("row").each(function(){a={},t(this).find("cell").each(function(e){var i=t(this),n=i.text(),o=i.attr("name");a[o]=n}),i.push(a)}),i&&o.createTrsByData(i,n)}else"json"==l?o.createTrsByData(e,n):o.createTrsByData(e.toObj(),n)}})},appendColumns:function(){e.linenumberColumn={name:"gridNumber",gridNumber:!0,width:30,minWidth:30,label:"No.",align:"center",menu:!1,edit:!1,quicksort:!1},e.checkboxColumn={name:"gridCheckbox",gridCheckbox:!0,width:40,minWidth:40,label:"Checkbox",align:"center",menu:!1,edit:!1,quicksort:!1},e.editBtnsColumn={name:"gridEdit",gridEdit:!0,width:110,minWidth:110,label:"Edit",align:"center",menu:!1,edit:!1,hide:!1,quicksort:!1}},createThead:function(){var i,n,o,d,l,s,r,c=this,h=a.columns,g=[];c.appendColumns(),a.showCheckboxcol&&(h.unshift(e.checkboxColumn),"lock"==a.showCheckboxcol&&(e.checkboxColumn.initLock=!0)),a.showLinenumber&&(h.unshift(e.linenumberColumn),"lock"==a.showLinenumber&&(e.linenumberColumn.initLock=!0)),a.showEditbtnscol&&h.push(e.editBtnsColumn),g=c.columns2Arr(h,g),e.columnModel[e.columnModel.length-(a.showEditbtnscol?2:1)].lock=!1,a.hiddenFields&&(e.hiddenFields=a.hiddenFields),e.$thead=t("<thead></thead>"),t.each(g,function(c,h){var u,p=t('<tr style="height:25px;"></tr>');t.each(h,function(c,h){i=h.label||h.name,n=h.align?' align="'+h.align+'"':"",o=h.width?' width="'+h.width+'"':"",d=h.colspan?' colspan="'+h.colspan+'"':"",l=g.length-h.rowspan>1?' rowspan="'+(g.length-h.rowspan)+'"':"",s='<div class="'+e.classnames.th_resizemark+'"></div>',r="",h.gridCheckbox&&(i='<input type="checkbox" data-toggle="icheck">'),h.colspan&&(n=' align="center"'),h.thalign&&(n=' align="'+h.thalign+'"'),h.menu&&a.columnMenu&&(r=' class="'+e.classnames.th_menu+'"'),u=t("<th"+r+o+n+d+l+'><div><div class="datagrid-space"></div><div class="datagrid-label">'+i+'</div><div class="'+e.classnames.th_cell+'">'+s+"</div></div></th>"),u.data("index",h.index).appendTo(p),u.find("> div").css("height",g.length-h.rowspan>1?24*(g.length-h.rowspan)+"px":"24px"),l||u.addClass("single-row"),h.gridNumber&&u.addClass(e.classnames.td_linenumber),a.fieldSortable&&h.quicksort&&u.addClass("datagrid-quicksort-th"),h.th=u}),p.appendTo(e.$thead)}),e.$thead.appendTo(e.$element)},createTbody:function(){{var t=this,i=a.data;e.columnModel}i?("string"==typeof i&&(i=i.trim().startsWith("[")||i.trim().startsWith("{")?i.toObj():i.toFunc()),"function"==typeof i&&(i=i.call()),t.createTrsByData(i)):a.dataUrl&&t.loadData()},setBoxbH:function(t){var i,n=t||a.height,o=0;100>n||(isNaN(n)&&(n=e.$grid.height()),e.$boxT&&(i=e.$boxT.outerHeight(),n-=i,o+=i),e.$toolbar&&(i=e.$toolbar.outerHeight(),n-=i,o+=i),e.$box_paging&&(n-=e.$box_paging.outerHeight()),e.$boxF&&(n-=e.$boxF.outerHeight()),o+=e.$tableH.outerHeight(),n-=e.$boxH.outerHeight(),0>n&&(n=0),e.$boxB.height(n),e.$boxM.height(n).css({top:o}))},fixedH:function(t){this.setBoxbH(t)},showSubMenu:function(a,i,n){var o,d,l=i.outerWidth(),s=n.data("width")||n.outerWidth(),r=e.$boxH.width(),c=function(a,i,n){o=i.offset().left-e.$grid.offset().left-1,d={left:"50%"},a.removeClass("active"),i.hasClass("position-right")||l+s>r-o?(n.css({left:"auto",right:"100%"}),d={right:"50%"}):n.css({left:"100%",right:"auto"}),d.opacity=.2,n.stop().animate(d,"fast",function(){t(this).hide()})};a.hover(function(){if(n.appendTo(a),a.hasClass(e.classnames.li_filter)&&n.is(":visible"))return!1;var t=a.siblings("."+e.classnames.li_filter);t.length&&t.hasClass("active")&&c(t,i,t.find("> ."+e.classnames.s_filter)),o=i.offset().left-e.$grid.offset().left-1,d={left:"100%"},i.hasClass("position-right")||l+s>r-o?(n.css({left:"auto",right:"50%"}),d={right:"100%"}):n.css({left:"50%",right:"auto"}),d.opacity=1,a.addClass("active"),n.show().stop().animate(d,"fast")},function(){return a.hasClass(e.classnames.li_filter)?!1:void c(a,i,n)}),a.on("bjui.datagrid.th.submenu.hide",function(e,a,i){c(t(this),a,i)})},locking:function(t){var a=t.data("index"),i=e.columnModel[a],n=i.lock,o=i.locked,d=e.$menu,l=d.find("> ul"),s=l.find("> li."+e.classnames.li_lock),r=s.next();o?(s.addClass("disable"),r.removeClass("disable")):(r.addClass("disable"),s.removeClass("disable")),n?(s.show().off("click").on("click",function(){s.hasClass("disable")||(d.hide().data("bjui.datagrid.menu.btn").removeClass("active"),e.colLock(t,!0))}),r.show().off("click").on("click",function(){r.hasClass("disable")||(d.hide().data("bjui.datagrid.menu.btn").removeClass("active"),e.colLock(t,!1))})):(s.hide().off("click"),r.hide().off("click"))},createShowhide:function(){var a;e.$showhide||(e.col_showhide_count=e.columnModel.length,a=t('<ul class="'+e.classnames.s_showhide+'" role="menu"></ul>'),t.each(e.columnModel,function(i,n){(n.gridNumber||n.gridCheckbox||n.gridEdit)&&e.col_showhide_count--;var o=t(FRAG.gridShowhide.replaceAll("#index#",n.index).replaceAll("#label#",n.label||"")).toggleClass("nodisable",!!(n.gridNumber||n.gridCheckbox||n.gridEdit)),d=function(i){o.click(function(){if(t(this).hasClass("disable"))return!1;{var n=t(this),o=!n.find("i").hasClass("fa-check-square-o");i.index}n.toggleClass("datagrid-col-check").find("i").attr("class","fa fa"+(o?"-check":"")+"-square-o"),e.showhideColumn(i.th,o),i.gridNumber||i.gridCheckbox||i.gridEdit||(e.col_showhide_count=o?e.col_showhide_count+1:e.col_showhide_count-1),1==e.col_showhide_count?a.find("> li.datagrid-col-check").addClass("disable"):a.find("> li.disable").removeClass("disable"),a.find("> li.nodisable").removeClass("disable")})};d(n),o.appendTo(a),n.hide&&o.trigger("click")}),a.appendTo(e.$grid),a.data("width",a.outerWidth()),e.$showhide=a)},showhide:function(t,a){var i=t.index,n=t.th,o=e.$tbody.find("> tr"),d=a?"":"none",l=function(t){var e=t.colspan;a?e++:e--,e?t.th.css("display",""):t.th.css("display","none"),t.th.attr("colspan",e),t.colspan=e,t.parent&&l(t.parent)};"undefined"==typeof t.hidden&&(t.hidden=!1),t.hidden!=!a&&(t.hidden=!a,n.css("display",d),o.find("> td:eq("+i+")").css("display",d),e.$colgroupH.find("> col").eq(i).css("display",d),e.$colgroupB.find("> col").eq(i).css("display",d),e.$thead.find("> tr.datagrid-filter > th:eq("+i+")").css("display",d),e.$boxF&&(e.$tableF.find("> thead > tr > th:eq("+i+")").css("display",d),e.$colgroupF.find("> col").eq(i).css("display",d)),t.calc&&e.$tfoot&&e.$tfoot.trigger("bjui.datagrid.tfoot.resizeH"),t.parent&&l(t.parent))},jumpPage:function(t,i){var n,o=e.allData;t&&(e.paging.pageCurrent=t),i&&(e.paging.pageSize=i,e.paging.pageCount=this.getPageCount(i,e.paging.total),e.paging.pageCurrent>e.paging.pageCount&&(e.paging.pageCurrent=e.paging.pageCount)),"remote"==a.local?(n=this.getRemoteFilterData(!0),this.loadData(n,!0)):this.initTbody(o,!0)},quickSort:function(t){if(e.isDom){if("local"==a.local)return;a.sortAll=!0}if(e.$tbody.find("> tr."+e.classnames.tr_edit).length)return void e.$tbody.alertmsg("info",BJUI.getRegional("datagrid.editMsg"));var i,n,o=t.th,d=e.data,l=e.allData,s=t.name,r=t.type,c=e.$thead.find("> tr > th.datagrid-quicksort-th");s||(s="datagrid-noname");var h=function(e){e.sort(function(e,a){var i=typeof e[s],n=typeof a[s];return"boolean"==r||"number"==r||(i="number"==n)||(i="boolean"==n)?t.sortAsc?e[s]-a[s]:a[s]-e[s]:t.sortAsc?String(e[s]).localeCompare(a[s]):String(a[s]).localeCompare(e[s])})};c.find("> div > .datagrid-label > i").remove(),t.sortAsc?(n="desc",t.sortAsc=!1):(n="asc",t.sortAsc=!0),o.find("> div > .datagrid-label").prepend('<i class="fa fa-long-arrow-'+(t.sortAsc?"up":"down")+'"></i>'),a.sortAll?"remote"==a.local?(i={},i[BJUI.pageInfo.orderField]=s,i[BJUI.pageInfo.orderDirection]=n,i[BJUI.pageInfo.pageSize]=e.paging.pageSize,i[BJUI.pageInfo.pageCurrent]=e.paging.pageCurrent,this.loadData(i,!0)):(h(l),this.initTbody(l,!0)):(h(d),this.createTrs(d,!0))},quickFilter:function(i,n){if(e.isDom){if("remote"!=a.local)return void BJUI.debug("Datagrid Plugin: Please change the local option is remote!");if(!a.dataUrl)return void BJUI.debug("Datagrid Plugin: Not Set the dataUrl option!")}var o,d=this,l=(i.th,e.data),s=e.allData,r=i.name,c=function(t,e,a){var n=!1;switch(t){case"=":n=String(e)==String(a);break;case"!=":n=String(e)!=String(a);break;case">":n=parseFloat(a)>parseFloat(e);break;case"<":n=parseFloat(a)<parseFloat(e);break;case"like":n="select"==i.type?String(e)==String(a):String(a).indexOf(String(e))>=0}return n},h=function(e,a){var i=function(e){var i=0;return t.each(a,function(t,a){var n=a.datas;return i++,n?(a.model.isFiltered=!0,a.model.th.trigger("bjui.datagrid.th.filter",[!0]),void(n.andor?"and"==n.andor?c(n.operatorA,n.valA,e[t])&&c(n.operatorB,n.valB,e[t])&&i--:"or"==n.andor&&(c(n.operatorA,n.valA,e[t])||c(n.operatorB,n.valB,e[t]))&&i--:n.operatorB?c(n.operatorB,n.valB,e[t])&&i--:c(n.operatorA,n.valA,e[t])&&i--)):(i--,a.model.isFiltered=!1,a.model.th.trigger("bjui.datagrid.th.filter",[!1]),a.model.quickfilter&&a.model.quickfilter.trigger("bjui.datagrid.thead.clearfilter"),!0)}),i?!1:!0};return t.grep(e,function(t,e){return i(t)})};e.filterDatas||(e.filterDatas={}),a.filterMult?e.filterDatas[r]={datas:n,model:i}:(e.filterDatas={},e.filterDatas[r]={datas:n,model:i}),"remote"!=a.local&&s&&(e.oldAllData?s=e.oldAllData.concat():e.oldAllData=s.concat()),a.filterAll?"remote"==a.local?d.loadData(d.getRemoteFilterData(),!0):(o=h(s,e.filterDatas),e.paging.pageCurrent=1,e.paging.pageCount=this.getPageCount(e.paging.pageSize,o.length),this.initTbody(o,!0)):e.isDom?d.loadData(d.getRemoteFilterData(),!0):(o=h(l,e.filterDatas),this.createTrs(o,!0))},getRemoteFilterData:function(i){var n=[];return e.filterDatas&&!t.isEmptyObject(e.filterDatas)&&(t.each(e.filterDatas,function(t,e){return e.datas?(e.model.isFiltered=!0,e.model.th.trigger("bjui.datagrid.th.filter",[!0]),a.jsonPrefix&&(t=a.jsonPrefix+"."+t),e.datas.andor&&n.push({name:"andor",value:e.datas.andor}),e.datas.operatorA&&(n.push({name:t,value:e.datas.valA}),n.push({name:t+".operator",value:e.datas.operatorA})),void(e.datas.operatorB&&(n.push({name:t,value:e.datas.valB}),n.push({name:t+".operator",value:e.datas.operatorB})))):(e.model.isFiltered=!1,e.model.th.trigger("bjui.datagrid.th.filter",[!1]),e.model.quickfilter&&e.model.quickfilter.trigger("bjui.datagrid.thead.clearfilter"),!0)}),i||(e.paging.pageCurrent=1)),n.push({name:BJUI.pageInfo.pageSize,value:e.paging.pageSize}),n.push({name:BJUI.pageInfo.pageCurrent,value:e.paging.pageCurrent}),n},setDomData:function(a){var i=e.columnModel,n={},o=a.attr("data-hidden-datas"),d=e.attach;return a.find("> td").each(function(e){var a=t(this),o=i[e],d=a.attr("data-val")||a.text();o.name?n[o.name]=d:n["datagrid-noname"+e]=d}),o&&(o=o.toObj()),t.extend(n,d,{gridNumber:a.index()+1},o),a.data("initData",n),n},initEditInputs:function(){var a=e.columnModel;return e.inputs=[],t.each(a,function(a,i){var n=i.name,o="",d="",l=[],s="";if(i)if(i.attrs&&"object"==typeof i.attrs&&t.each(i.attrs,function(t,e){s+=" "+t+"="+e}),i==e.linenumberColumn||i==e.checkboxColumn||i==e.editBtnsColumn)e.inputs.push("");else if(n)if(i.rule?o=' data-rule="'+i.label+"："+i.rule+'"':"date"==i.type&&(o=' data-rule="pattern('+(i.pattern||"yyyy-MM-dd")+')"'),i.type)switch(i.type){case"date":i.pattern||(i.pattern="yyyy-MM-dd"),d=' data-pattern="'+i.pattern+'"',e.inputs.push('<input type="text" name="'+n+'" data-toggle="datepicker"'+d+o+s+">");break;case"select":if(!i.items)return;t.each(i.items,function(e,a){t.each(a,function(t,e){l.push('<option value="'+t+'">'+e+"</option>")})}),e.inputs.push('<select name="'+n+'" data-toggle="selectpicker"'+o+s+' data-width="100%">'+l.join("")+"</select>");break;case"boolean":e.inputs.push('<input type="checkbox" name="'+n+'" data-toggle="icheck"'+o+s+' value="true">');break;case"lookup":e.inputs.push('<input type="text" name="'+n+'" data-toggle="lookup" data-custom-event="true"'+o+s+">");break;case"spinner":e.inputs.push('<input type="text" name="'+n+'" data-toggle="spinner"'+o+s+">");break;case"textarea":e.inputs.push('<textarea data-toggle="autoheight" rows="1"'+o+s+"></textarea>");break;default:e.inputs.push('<input type="text" name="'+n+'"'+o+s+">")}else e.inputs.push('<input type="text" name="'+n+'"'+o+s+">");else e.inputs.push("")}),e.inputs},contextmenuH:function(){var a=this;e.$tableH.on("contextmenu",function(i){e.$showhide||a.createShowhide();var n=i.pageX,o=i.pageY;t(window).width()<n+e.$showhide.width()&&(n-=e.$showhide.width()),t(window).height()<o+e.$showhide.height()&&(o-=e.$showhide.height()),e.$menu&&e.$grid.trigger("click.bjui.datagrid.filter"),e.$showhide.appendTo("body").css({left:n,top:o,opacity:1,"z-index":9999}).show(),t(document).on("click",function(a){var i=t(a.target).closest("."+e.classnames.s_showhide);i.length||e.$showhide.css({left:"50%",top:0,opacity:.2,"z-index":""}).hide().appendTo(e.$grid)}),i.preventDefault(),i.stopPropagation()})},contextmenuB:function(t,a){t.contextmenu("show",{exclude:"input, .bootstrap-select",items:[{icon:"refresh",title:BJUI.getRegional("datagrid.refresh"),func:function(t,a){e.refresh()}},{title:"diver"},{icon:"plus",title:BJUI.getRegional("datagrid.add"),func:function(t,a){e.add()}},{icon:"edit",title:BJUI.getRegional("datagrid.edit"),func:function(t,i){var n=t;a&&(n=e.$tbody.find("> tr:eq("+n.index()+")")),e.doEditRow(n)}},{icon:"undo",title:BJUI.getRegional("datagrid.cancel"),func:function(t,i){var n=t;a&&(n=e.$tbody.find("> tr:eq("+n.index()+")")),n.hasClass(e.classnames.tr_edit)||(n=e.$tbody.find("> tr."+e.classnames.tr_edit)),e.doCancelEditRow(n)}},{icon:"remove",title:BJUI.getRegional("datagrid.del"),func:function(t,i){var n=t;a&&(n=e.$tbody.find("> tr:eq("+n.index()+")")),e.delRows(n)}}]})}};return i},a.prototype.createTable=function(){var t=this,e=t.options,a=t.tools;e.columns&&a.createThead(),(e.data||e.dataUrl)&&a.createTbody()},a.prototype.setColumnModel=function(){var e=this,a=e.options,i=e.$thead.find("> tr"),n=[],o=[],d=i.length;if(!e.isDom){e.tools.appendColumns();var l,s=d>1?' rowspan="'+d+'"':"";a.showCheckboxcol&&(e.columnModel.push(e.checkboxColumn),"lock"==a.showCheckboxcol&&(e.checkboxColumn.initLock=!0),l=t("<th"+s+'><input type="checkbox" data-toggle="icheck"></th>'),l.prependTo(i.first()),s&&l.data("datagrid.column",e.checkboxColumn)),a.showLinenumber&&(e.columnModel.unshift(e.linenumberColumn),"lock"==a.showLinenumber&&(e.linenumberColumn.initLock=!0),l=t('<th class="datagrid-linenumber-td"'+s+">No.</th>"),l.prependTo(i.first()),s&&l.data("datagrid.column",e.linenumberColumn)),a.showEditbtnscol&&(e.columnModel[l.index()]=e.editBtnsColumn,l=t("<th"+s+">Edit</th>"),l.appendTo(i.first()),s&&l.data("datagrid.column",e.editBtnsColumn))}i.length&&1==d?(i.height(25),i.find("> th").each(function(i){var n=t(this).addClass("single-row"),o=n.data("options"),d=n.attr("width")||n.outerWidth(),l=n.html();e.columnModel.length&&e.columnModel[i]?o=e.columnModel[i]:(o&&"string"==typeof o&&(o=o.toObj()),"object"!=typeof o&&(o={}),o.index=i,o.label=l,o.width="undefined"==typeof o.width?d:o.width,o.menu="undefined"==typeof o.menu?!0:o.menu,o.lock="undefined"==typeof o.lock?!0:o.lock,o.hide="undefined"==typeof o.hide?!1:o.hide,o.edit="undefined"==typeof o.edit?!0:o.edit,o.add="undefined"==typeof o.add?!0:o.add,o.quicksort="undefined"==typeof o.quicksort?!0:o.quicksort,e.columnModel[i]=o),o.th=n,n.html('<div><div class="datagrid-space"></div><div class="datagrid-label">'+l+'</div><div class="'+e.classnames.th_cell+'"><div class="'+e.classnames.th_resizemark+'"></div></div></div>'),o.menu&&a.columnMenu&&n.addClass(e.classnames.th_menu),a.fieldSortable&&o.quicksort&&n.addClass("datagrid-quicksort-th"),o.align&&n.attr("align",o.align),n.data("index",i).find("> div").css("height","24px")})):i.each(function(i){var d=[],l=[],s=-1,r=0;n.length&&(d=n.concat(),l=o.concat()),n=[],o=[],t(this).height(25).find("> th").each(function(i){var c=t(this),h=c.data("options")||c.data("datagrid.column")||{},g=parseInt(c.attr("colspan")||0),u=parseInt(c.attr("rowspan")||0),p=c.attr("width")||c.outerWidth(),f=c.html();if(h&&"string"==typeof h&&(h=h.toObj()),"object"!=typeof h&&(h={}),-[1]||1!=g||(g=0),h.label=f,h.th=c,h.gridCheckbox&&(h.label="Checkbox"),s++,g){h.colspan=g;for(var m=d.length?d[s]:s,b=m;m+g>b;b++)n[r++]=b,o[r-1]=h;s+=g-1,c.data("index",s),d.length&&(h.parent=l[s])}u&&1!=u||c.addClass("single-row"),g?c.html('<div style="height:'+(u?24*u:24)+'px;"><div class="datagrid-space"></div><div class="datagrid-label">'+f+'</div><div class="'+e.classnames.th_cell+'"><div class="'+e.classnames.th_resizemark+'"></div></div></div>'):(h.width="undefined"==typeof h.width?p:h.width,h.menu="undefined"==typeof h.menu?!0:h.menu,h.lock="undefined"==typeof h.lock?!0:h.lock,h.hide="undefined"==typeof h.hide?!1:h.hide,h.edit="undefined"==typeof h.edit?!0:h.edit,h.add="undefined"==typeof h.add?!0:h.add,h.quicksort="undefined"==typeof h.quicksort?!0:h.quicksort,c.html('<div style="height:'+(u?24*u:24)+'px;"><div class="datagrid-space"></div><div class="datagrid-label">'+f+'</div><div class="'+e.classnames.th_cell+'"><div class="'+e.classnames.th_resizemark+'"></div></div></div>'),h.menu&&a.columnMenu&&c.addClass(e.classnames.th_menu),a.fieldSortable&&h.quicksort&&c.addClass("datagrid-quicksort-th"),h.align&&c.attr("align",h.align),d.length?(h.index=d[s],h.parent=l[s],e.columnModel[d[s]]=h):(h.index=s,e.columnModel[s]=h),c.data("index",h.index))})})},a.prototype.init=function(){if(this.$element.isTag("table")&&!this.$element.data("bjui.datagrid.init")){var e,a,i=this,n=i.tools,o=i.$element.parent();i.options.options&&("string"==typeof i.options.options&&(i.options.options=i.options.options.toObj()),t.extend(i.options,"object"==typeof i.options.options&&i.options.options)),i.parentH=o.height(),e=i.options,i.$element.data("bjui.datagrid.init",!0),e.width||(a=o.width()),String(e.width).endsWith("%")&&(a=Math.round(o.width()*parseInt(String(e.width).replace("%",""))/100)),e.height=e.height||300,i.isDom=!1,i.columnModel=[],i.inputs=[],i.$grid=t('<div class="bjui-datagrid"></div>').width(e.width).height(e.height),i.$boxH=t('<div class="datagrid-box-h"></div>'),i.$boxB=t('<div class="datagrid-box-b"></div>'),i.$boxM=t('<div class="datagrid-box-m"></div>').appendTo(i.$grid),i.regional=BJUI.regional.datagrid,i.$element.before(i.$grid),"string"==typeof e.paging&&(e.paging=e.paging.toObj()),i.paging=t.extend({},{pageSize:30,selectPageSize:"30,60,90",pageCurrent:1,total:0,showPagenum:5},"object"==typeof e.paging&&e.paging),i.attach={gridNumber:0,gridCheckbox:"#checkbox#",gridEdit:"#edit#"},i.$thead=i.$element.find("> thead"),i.$tbody=i.$element.find("> tbody"),i.$tbody&&i.$tbody.find("> tr").length&&(i.isDom=!0),e.columns?("string"==typeof e.columns&&(e.columns=e.columns.trim().startsWith("[")?e.columns.toObj():e.columns.toFunc()),"function"==typeof e.columns&&(e.columns=e.columns.call()),i.$thead=null,n.createThead()):i.$thead&&i.$thead.length&&i.$thead.find("> tr").length&&i.setColumnModel(),i.initTop(),i.$grid.data("bjui.datagrid.table",i.$element.clone()),i.isDom?(n.appendColumns(),i.$tbody.find("> tr > td").each(function(){var e=t(this),a=e.html();e.html("<div>"+a+"</div>")}),i.paging.total?i.paging.pageCount=n.getPageCount(i.paging.pageSize,i.paging.total):(i.paging.total=i.$tbody.find("> tr").length,i.paging.pageCount=1),i.paging.pageCurrent=1,i.initThead()):(i.$tbody=null,(e.data||e.dataUrl)&&n.createTbody())}},a.prototype.refresh=function(){var e=this,a=e.options,i=e.tools,n=(e.isDom,BJUI.pageInfo),o=e.paging,d={};return a.dataUrl?(d[n.pageSize]=o.pageSize,d[n.pageCurrent]=o.pageCurrent,i.loadData(d,!0),e.filterDatas=null,t.each(e.columnModel,function(t,e){e.th.trigger("bjui.datagrid.th.filter",[!1]),e.isFiltered=!1,e.quickfilter&&e.quickfilter.trigger("bjui.datagrid.thead.clearfilter")}),void e.$thead.find("> tr > th.datagrid-quicksort-th").find("> div > .datagrid-label > i").remove()):a.data&&a.data.length?void i.initTbody(e.allData,!0):void BJUI.debug("Datagrid Plugin: Not Set the dataUrl option!")},a.prototype.destroy=function(){var t=this,e=t.$grid.data("bjui.datagrid.table");e&&(t.$element.html(e.html()).insertBefore(t.$grid),t.$grid.remove())},a.prototype.initTop=function(){var e,a=this,i=a.options,n=(a.regional,!1),o='<div class="btn-group" role="group"></div>',d='<button type="button" class="btn" data-icon=""></button>';if(i.gridTitle&&(a.$boxT=t('<div class="datagrid-title">'+i.gridTitle+"</div>"),a.$boxT.appendTo(a.$grid)),i.showToolbar&&(i.toolbarItem||i.toolbarCustom)){if(a.$toolbar=t('<div class="datagrid-toolbar"></div'),i.toolbarItem&&(n=!0,i.toolbarItem.indexOf("all")>=0&&(i.toolbarItem="add, edit, cancel, save, |, del, |, refresh, |, import, export"),t.each(i.toolbarItem.split(","),function(n,l){return l=l.trim().toLocaleLowerCase(),e&&"|"!=l||(e=t(o).appendTo(a.$toolbar),"|"!=l)?void("add"==l?a.$toolbar_add=t(d).attr("data-icon","plus").addClass("btn-blue").text(BJUI.getRegional("datagrid.add")).appendTo(e).on("click",function(t){a.add()}):"edit"==l?a.$toolbar_edit=t(d).attr("data-icon","edit").addClass("btn-green").text(BJUI.getRegional("datagrid.edit")).appendTo(e).on("click",function(e){var n=a.$tbody.find("> tr."+a.classnames.tr_selected);n.length?a.doEditRow(i.inlineEditMult?n:a.$lastSelect?a.$lastSelect:n.first()):t(this).alertmsg("info",BJUI.getRegional("datagrid.selectMsg"))}):"cancel"==l?a.$toolbar_calcel=t(d).attr("data-icon","undo").addClass("btn-orange").text(BJUI.getRegional("datagrid.cancel")).appendTo(e).on("click",function(t){a.doCancelEditRow(a.$tbody.find("> tr."+a.classnames.tr_edit))}):"save"==l?a.$toolbar_save=t(d).attr("data-icon","save").addClass("btn-default").text(BJUI.getRegional("datagrid.save")).appendTo(e).on("click",function(t){a.doSaveEditRow()}):"del"==l?a.$toolbar_del=t(d).attr("data-icon","times").addClass("btn-red").text(BJUI.getRegional("datagrid.del")).appendTo(e).on("click",function(e){var i=a.$tbody.find("> tr."+a.classnames.tr_selected);i.length?a.delRows(i):t(this).alertmsg("info",BJUI.getRegional("datagrid.selectMsg"))}):"refresh"==l?a.$toolbar_refresh=t(d).attr("data-icon","refresh").addClass("btn-green").text(BJUI.getRegional("datagrid.refresh")).appendTo(e).on("click",function(t){a.refresh()}):"import"==l?a.$toolbar_add=t(d).attr("data-icon","sign-in").addClass("btn-blue").text(BJUI.getRegional("datagrid.import")).appendTo(e).on("click",function(t){if(i.importOption){var e=i.importOption;"string"==typeof e&&(e=e.toObj()),e.options&&e.options.url&&("dialog"==e.type?a.$grid.dialog(e.options):"navtab"==e.type?a.$grid.navtab(e.options):a.$grid.bjuiajax("doAjax",e.options))}}):"export"==l&&(a.$toolbar_add=t(d).attr("data-icon","sign-out").addClass("btn-green").text(BJUI.getRegional("datagrid.export")).appendTo(e).on("click",function(e){if(i.exportOption){var n=i.exportOption;"string"==typeof n&&(n=n.toObj()),n.options&&n.options.url&&("dialog"==n.type?a.$grid.dialog(n.options):"navtab"==n.type?a.$grid.navtab(n.options):"file"==n.type?t.fileDownload(n.options.url,{failCallback:function(t,e){t.trim().startsWith("{")&&(t=t.toObj()),a.$grid.bjuiajax("ajaxDone",t)}}):a.$grid.bjuiajax("doAjax",n.options))}}))):!0})),i.toolbarCustom){var l,s=t('<div style="display:inline-block;"></div>');if("string"==typeof i.toolbarCustom){var r=t(i.toolbarCustom);r&&r.length?l=r:(r=r.toFunc(),r&&(l=r.call(a),"string"==typeof l&&(l=t(l))))}else"function"==typeof i.toolbarCustom?(l=i.toolbarCustom.call(a),"string"==typeof l&&(l=t(l))):l=i.toolbarCustom;l&&l.length&&"string"!=typeof l&&(n&&s.css("margin-left","5px"),s.appendTo(a.$toolbar),l.appendTo(s))}a.$toolbar.appendTo(a.$grid)}},a.prototype.initThead=function(){var e,a=this,i=a.options,n=a.tools,o=a.columnModel,d=[],l=a.$tbody.find("> tr:first-child > td");a.init_thead=!0,a.$colgroupH=t("<colgroup></colgroup>"),a.$tableH=t('<table class="table table-bordered"></table>').append(a.$thead),a.$trsH=a.$thead.find("> tr"),a.table_width=0,t.each(a.columnModel,function(t,i){e=i.width?i.width:l.eq(t).outerWidth()||50,d.push('<col style="width:'+e+'px;">'),i.width=e,a.table_width+=e}),a.$thead.before(a.$colgroupH.append(d.join(""))),a.$grid.append(a.$boxH.append(t('<div class="datagrid-wrap-h"></div>').append(a.$tableH)));var s=a.$trsH.find("> th");s.filter(".datagrid-quicksort-th").on("click.bjui.datagrid.quicksort",function(e){var i=t(e.target);i.closest("."+a.classnames.th_cell).length||a.isResize||n.quickSort(o[t(this).data("index")])}),s.filter(".datagrid-column-menu").on("bjui.datagrid.th.filter",function(e,i){var n=t(this),o=n.find("> div > ."+a.classnames.th_cell+"> ."+a.classnames.btn_menu+"> .btn");i?(n.addClass("filter-active"),o.find("> i").attr("class","fa fa-filter")):(n.removeClass("filter-active"),o.find("> i").attr("class","fa fa-bars"))}),i.contextMenuH&&n.contextmenuH(),a.initTbody(),i.columnResize&&a.colResize(),i.columnMenu&&a.colMenu(),i.paging&&a.initPaging(),i.editMode&&a.edit(),a.resizeGrid();var r=function(){i.showTfoot&&a.initTfoot(),a.initLock(),a.$grid.initui(),i.height&&n.fixedH(),setTimeout(function(){a.fixedWidth("init")},500),a.initEvents()};i.filterThead?a.delayRender?a.delayFilterTimeout=setInterval(function(){a.delayRender||(clearInterval(a.delayFilterTimeout),a.filterInThead(),r())},100):(a.filterInThead(),r()):r()},a.prototype.fixedWidth=function(e){var a,i,n,o=this,d=o.options,l=0,s=o.columnModel,r=s.length;if(!e||!o.initFixedW){o.initFixedW=!0;var c=function(){o.$boxH.find("> div").css("width",""),o.$boxB.find("> div").css("width",""),o.$boxF&&o.$boxF.find("> div").css("width",""),o.$pagingCon&&o.$pagingCon.css("width",""),a=o.$boxB.find("> div").width(),a&&(o.$boxB.find("> div").width(a),o.$boxH.find("> div").width(a),o.$boxF&&o.$boxF.find("> div").width(a),o.table_width>a?o.$pagingCon&&o.$pagingCon.width(a):o.$pagingCon&&o.$pagingCon.width(o.table_width))},h=function(){a&&a<o.table_width&&(s[r-1]==o.editBtnsColumn&&(l+=o.editBtnsColumn.width,r--),s[0]==o.linenumberColumn&&(l+=o.linenumberColumn.width,r--),(s[0]==o.checkboxColumn||s[1]==o.checkboxColumn)&&(l+=o.checkboxColumn.width,r--),i=parseInt((a-o.table_width-l)/r),i?i--:i=-1,t.each(s,function(t,e){return e==o.linenumberColumn||e==o.checkboxColumn||e==o.editBtnsColumn?!0:(n=e.width+i,0>=n&&(n=1),o.$colgroupH.find("> col:eq("+e.index+")").width(n),o.$colgroupB.find("> col:eq("+e.index+")").width(n),o.$colgroupF&&o.$colgroupF.find("> col:eq("+e.index+")").width(n),void(e.new_width=n))}))};d.fullGrid?(c(),h()):c()}},a.prototype.initTbody=function(){var e=this,a=e.options,i=(e.tools,e.$tbody.find("> tr")),n=(i.find("> td"),"0");e.init_tbody=!0,e.$colgroupB=e.$colgroupH.clone(),e.$tableB=e.$element,e.$tableB.removeAttr("data-toggle width").empty().append(e.$tbody),e.$tbody.before(e.$colgroupB),e.$grid.append(e.$boxB.append(t('<div class="datagrid-wrap-b"></div>').append(e.$tableB))),-[1]||(n="auto"),a.fullGrid&&(n="100%"),e.$tableH.width(n),e.$tableB.width(n),e.$tableB.addClass("table table-bordered").removeClass("table-hover"),e.$boxB.scroll(function(){e.$boxH.find("> div").prop("scrollLeft",this.scrollLeft),e.$boxF&&e.$boxF.find("> div").prop("scrollLeft",this.scrollLeft),e.$lockB&&e.$lockB.prop("scrollTop",this.scrollTop)}),e.isDom&&(a.showLinenumber&&e.showLinenumber(a.showLinenumber),a.showCheckboxcol&&e.showCheckboxcol(a.showCheckboxcol),a.showEditbtnscol&&e.showEditCol(a.showEditbtnscol),e.$grid.data(e.datanames.tbody,e.$tbody.clone()))},a.prototype.initEvents=function(e){var a=this,i=a.options,n=a.$tbody.find("> tr");e||(e=n),e.on("click.bjui.datagrid.tr",function(e,i){{var n,o=t(this),d=o.index(),l=a.$tbody.find("> tr."+a.classnames.tr_selected),s=a.$lastSelect;a.$lockTbody&&a.$lockTbody.find("> tr")}if(i)n=i.is(":checked"),n||(a.$lastSelect=o),a.selectedRows(o,!n);else{if(o.hasClass(a.classnames.tr_edit))return;BJUI.KeyPressed.ctrl||BJUI.KeyPressed.shift?(window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),BJUI.KeyPressed.ctrl?(o.hasClass(a.classnames.tr_selected)||(a.$lastSelect=o),a.selectedRows(o)):BJUI.KeyPressed.shift&&(s||(s=a.$lastSelect=o),s.length&&(a.selectedRows(null),s.index()!=d?s.index()>d?a.selectedRows(o.nextUntil(s).add(o).add(s),!0):a.selectedRows(o.prevUntil(s).add(o).add(s),!0):a.selectedRows(d)))):l.length>1&&o.hasClass(a.classnames.tr_selected)?(a.selectedRows(l.not(o)),a.$lastSelect=o):(l.length&&l[0]!=this&&a.selectedRows(null),o.hasClass(a.classnames.tr_selected)||(a.$lastSelect=o),a.selectedRows(o))}}).on("mouseenter.bjui.datagrid",function(e){var i=t(this),n=i.index();i.addClass("datagrid-hover"),a.$lockTbody&&a.$lockTbody.find("> tr:eq("+n+")").addClass("datagrid-hover")}).on("mouseleave.bjui.datagrid",function(e){var i=t(this),n=i.index();i.removeClass("datagrid-hover"),a.$lockTbody&&a.$lockTbody.find("> tr:eq("+n+")").removeClass("datagrid-hover")}).on("bjui.datagrid.tr.delete",function(e){var i,n=t(this),o=n.index(),d=a.data,l=a.allData,s=a.$lockTbody&&a.$lockTbody.find("> tr");a.isDom||(i=d[o].gridIndex,a.data=d.remove(o),a.allData=l.remove(i)),a.columnModel[0]==a.linenumberColumn&&(n.nextAll().each(function(){var e=t(this).find("> td:eq(0)"),a=parseInt(e.text());e.text(a-1)}),s&&s.eq(o).trigger("bjui.datagrid.tr.delete",[o])),n.remove()}),i.contextMenuB&&e.each(function(){a.tools.contextmenuB(t(this))}),e.each(function(){var e=t(this);e.find("> td."+a.classnames.td_checkbox).find("input").on("ifClicked",function(){e.trigger("click.bjui.datagrid.tr",[t(this)])})}),a.checkboxColumn&&a.checkboxColumn.th&&a.checkboxColumn.th.find("input").on("ifChanged",function(){var e=t(this).is(":checked"),i=a.$tbody.find("> tr");a.selectedRows(i,e)})},a.prototype.initTfoot=function(){var e=this,a=e.options,i=e.tools,n=e.columnModel,o=t("<tr></tr>");e.$boxF=t('<div class="datagrid-box-f"></div>'),e.$colgroupF=e.$colgroupH.clone(),e.$tableF=e.$tableH.clone().empty(),e.$tableF.append(e.$colgroupF),e.$boxF.append(t('<div class="datagrid-wrap-h"></div>').append(e.$tableF)),e.$boxF.insertAfter(e.$boxB),e.$tfoot=t("<thead></thead>"),t.each(n,function(e,a){var i=t("<th><div></div></th>");if(a.calc){var n='<div><div class="datagrid-calcbox">#tit#</div>#number#</div>';"avg"==a.calc?i.html(n.replace("#tit#",a.calcTit||"AVG").replace("#number#",(a.calc_sum/a.calc_count).toFixed(a.calcDecimal||2))):"count"==a.calc?i.html(n.replace("#tit#",a.calcTit||"COUNT").replace("#number#",a.calc_count)):"sum"==a.calc?i.html(n.replace("#tit#",a.calcTit||"SUM").replace("#number#",a.calc_sum)):"max"==a.calc?i.html(n.replace("#tit#",a.calcTit||"MAX").replace("#number#",a.calc_max)):"min"==a.calc&&i.html(n.replace("#tit#",a.calcTit||"MIN").replace("#number#",a.calc_min))}a.hidden&&i.css("display","none"),i.appendTo(o)}),e.$tfoot.append(o).appendTo(e.$tableF),e.$tfoot.on("bjui.datagrid.tfoot.resizeH",function(){i.setBoxbH(a.height)})},a.prototype.selectedRows=function(e,a){var i=this,n=i.$lockTbody&&i.$lockTbody.find("> tr"),o=i.$tbody.find("> tr"),d=function(t){"undefined"==typeof a&&(a=!0),o.eq(t).toggleClass(i.classnames.tr_selected,a).find("> td."+i.classnames.td_checkbox+" input").iCheck(a?"check":"uncheck"),n&&n.eq(t).toggleClass(i.classnames.tr_selected,a).find("> td."+i.classnames.td_checkbox+" input").iCheck(a?"check":"uncheck")};null==e?(o.removeClass(i.classnames.tr_selected).find("> td."+i.classnames.td_checkbox+" input").iCheck("uncheck"),n&&n.removeClass(i.classnames.tr_selected).find("> td."+i.classnames.td_checkbox+" input").iCheck("uncheck")):"object"==typeof e?e.each(function(){var e=t(this),o=e.index();"undefined"!=typeof a?d(o):(e.toggleClass(i.classnames.tr_selected).trigger("bjui.datagrid.tr.selected").find("> td."+i.classnames.td_checkbox+" input").iCheck(e.hasClass(i.classnames.tr_selected)?"check":"uncheck"),n&&n.eq(o).toggleClass(i.classnames.tr_selected).trigger("bjui.datagrid.tr.selected").find("> td."+i.classnames.td_checkbox+" input").iCheck(e.hasClass(i.classnames.tr_selected)?"check":"uncheck"))}):isNaN(e)?t.each(e.split(","),function(t,e){d(parseInt(e.trim()))}):isNaN(e)||d(parseInt(e)),i.$lastSelect&&!i.$lastSelect.hasClass(i.classnames.tr_selected)&&(i.$lastSelect=null),i.$element.data("selectedTrs",i.$tbody.find("> tr."+i.classnames.tr_selected))},a.prototype.initLock=function(){{var e=this;e.columnModel}e.col_lock_count=0,t.each(e.columnModel,function(t,a){a.initLock&&e.col_lock_count++}),e.col_lock_count&&e.doLock()},a.prototype.colLock=function(e,a){var i,n,o,d=this;if("number"==t.type(e)){if(n=parseInt(e),0>n||n>d.columnModel.length-1)return;o=d.columnModel[n],i=o.th}else i=e,n=i.data("index"),o=d.columnModel[n];o!=d.editBtnsColumn&&o.index!=d.columnModel.length-1&&("undefined"==typeof o.locked&&(o.locked=!1),o.locked!=a&&(o.initLock=a,a?d.col_lock_count++:d.col_lock_count--,d.col_lock_count<0&&(d.col_lock_count=0),d.doLock()))},a.prototype.fixedLockItem=function(e){var a=this,i=a.columnModel,n=a.$thead.find("> tr.datagrid-filter > th"),o=a.$lockTbody&&a.$lockTbody.find("> tr");e?(n&&n.length&&a.$lockThead.find("> tr.datagrid-filter > th:visible").each(function(){var e=t(this),a=e.index(),i=n.eq(a);i.clone().html("").insertAfter(i),i.show().insertAfter(e),e.remove()}),o&&o.length&&o.filter("."+a.classnames.tr_edit).each(function(){var e=t(this),n=e.index();e.find("> td."+a.classnames.td_edit+":visible").each(function(){var e,o,d=t(this),l=d.index(),s=i[l];s.locked&&(e=a.$tbody.find("> tr:eq("+n+")"),o=e.find("> td:eq("+l+")"),o.clone().insertAfter(o),o.show().insertAfter(d),d.remove())})})):(n&&n.length&&a.$lockThead&&a.$lockThead.find("> tr.datagrid-filter > th:visible").each(function(){var e=t(this),a=e.index(),i=n.eq(a);e.clone().insertAfter(e),e.hide().insertAfter(i),i.remove()}),o&&o.length&&o.filter("."+a.classnames.tr_edit).each(function(){var e,n,o=t(this),d=o.find("> td:eq("+i.lockIndex+")"),l=o.index();d.hasClass(a.classnames.td_edit)&&(e=a.$tbody.find("> tr:eq("+l+")"),n=e.find("> td:eq("+index+")"),d.clone().insertAfter(d),d.hide().insertAfter(n),n.remove())}))},a.prototype.doLock=function(){var e,a,i=this,n=(i.options,i.tools),o=i.columnModel,d=(i.$tableH.width(),0),l=0,s=i.$boxF&&!0,r=0;i.$lockBox&&i.$lockBox.length?(i.fixedLockItem(),i.$lockTableH.empty(),i.$lockTableB.empty(),i.$lockTableF&&i.$lockTableF.empty()):(i.$lockBox=t('<div class="datagrid-box-l"></div>'),i.$lockH=t('<div class="datagrid-box-h"></div>'),i.$lockB=t('<div class="datagrid-box-b"></div>'),i.$lockF=t('<div class="datagrid-box-f"></div>'),i.$lockTableH=t('<table class="table table-bordered"></table>'),i.$lockTableB=t("<table></table>").addClass(i.$tableB.attr("class")),i.$lockTableF=t('<table class="table table-bordered"></table>'),i.$lockH.append(i.$lockTableH),i.$lockB.append(i.$lockTableB),i.$lockF.append(i.$lockTableF),i.$lockBox.append(i.$lockH).append(i.$lockB).prependTo(i.$grid),s&&(i.$lockBox.append(i.$lockF),i.$lockF.css("margin-top",i.$boxB.outerHeight()-i.$boxB[0].clientHeight).height(i.$boxF.outerHeight()))),i.$boxT&&(r+=i.$boxT.outerHeight()),i.$toolbar&&(r+=i.$toolbar.outerHeight()),r&&i.$lockBox.css({top:r}),t.each(o,function(t,e){e.lockShow=!1,e.lockHide=!1,e.initLock?(e.hidden&&n.showhide(e,!0),e.lockHide=!0,e.locked=!0,e.lockIndex=l++,d+=e.width):(e.lockShow=!0,e.hidden?e.lockShow=!1:n.showhide(e,!1),e.locked&&(e.lockShow=!0),e.locked=!1)}),i.$lockThead=i.$thead.clone(!0),i.$lockTbody=i.$tbody.clone(),i.$lockColgroupH=i.$colgroupH.clone(),i.$lockColgroupB=i.$colgroupB.clone(),i.$lockTableH.append(i.$lockColgroupH).append(i.$lockThead).css("width",d),i.$lockTableB.append(i.$lockColgroupB).append(i.$lockTbody).css("width",d),s&&(i.$lockTfoot=i.$tableF.find("> thead").clone(),i.$lockColgroupF=i.$colgroupF.clone(),i.$lockTableF.append(i.$lockColgroupF).append(i.$lockTfoot).css("width",d)),t.each(i.columnModel,function(t,e){e.lockShow&&n.showhide(e,!0),e.lockHide&&n.showhide(e,!1)}),i.$boxH.find("> div").css("width",""),i.$boxB.find("> div").css("width",""),i.$boxF&&i.$boxF.find("> div").css("width",""),setTimeout(function(){var t=i.$boxB.find("> div").width();i.$boxB.find("> div").width(t),i.$boxH.find("> div").width(t),i.$boxF&&i.$boxF.find("> div").width(t)},50),0==i.col_lock_count?i.$lockBox.hide():i.$lockBox.show(),d>1&&(d-=1),i.$boxH.css("margin-left",d),i.$boxB.css("margin-left",d),s&&i.$boxF.css("margin-left",d),i.$lockB.height(i.$boxB[0].clientHeight),i.$lockB.prop("scrollTop",i.$boxB[0].scrollTop);var c=i.$lockTableH.height(),h=i.$thead.height(),g=i.$lockTableF&&i.$lockTableF.height(),u=i.$tableF&&i.$tableF.height();c!=h&&(h>c?i.$lockTableH.height(h):i.$tableH.height(c)),g&&u&&g!=u&&(u>g?i.$lockTableF.find("> thead > tr:first-child > th:visible:first").height(u):i.$tableF.find("> thead > tr:first-child > th:visible:first").height(g)),a=i.$lockTbody.find("> tr"),e=i.$tbody.find("> tr"),setTimeout(function(){var n=i.$lockTableB.height(),o=i.$tableB.height();n!=o&&(n>o?a.each(function(a){var i=t(this),n=i.find("> td:visible:first"),o=n.outerHeight();o>30&&(i.height(o),e.eq(a).height(o))}):e.each(function(e){var i=t(this),n=i.find("> td:visible:first"),o=n.outerHeight();o>30&&(i.height(o),a.eq(e).height(o))}))},20),i.fixedLockItem(1),a.find("> td:hidden").remove(),i.initLockEvents(a)},a.prototype.initLockEvents=function(e){if(this.$lockTbody){var a=this,i=a.options;e||(e=a.$lockTbody.find("> tr")),e.on("click.bjui.datagrid.tr",function(){var e=t(this).index();a.$tbody.find("> tr:eq("+e+")").trigger("click.bjui.datagrid.tr")}).on("bjui.datagrid.tr.delete",function(e,i){var n=t(this);a.linenumberColumn&&a.linenumberColumn.locked&&n.nextAll().each(function(){var e=t(this).find("> td:eq(0)"),a=parseInt(e.text());e.text(a-1)}),n.remove()}).find("> td."+a.classnames.td_checkbox+" input").on("ifChanged",function(){var e=t(this),i=e.closest("tr"),n=i.index();e.is(":checked")?(i.addClass(a.classnames.tr_selected),$trs.eq(n).addClass(a.classnames.tr_selected)):(i.removeClass(a.classnames.tr_selected),$trs.eq(n).removeClass(a.classnames.tr_selected))}),i.contextMenuB&&e.each(function(){a.tools.contextmenuB(t(this),!0)})}},a.prototype.filterInThead=function(){var e=this,a=(e.options,e.tools),i=e.regional,n=e.columnModel,o=t('<tr class="datagrid-filter"></tr>'),d=function(t,e,a){var i=e.type;"date"==i?t.on("afterchange.bjui.datepicker",function(a,i){l(e,t.val())}).change(function(){l(e,t.val())}):"lookup"==i?(a.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(a,i){for(var n in i)e.name==n&&(t.val(i[n]),l(e,i[n]))}),t.change(function(){l(e,t.val())})):t.change(function(){l(e,t.val())})},l=function(t,e){a.quickFilter(t,e?{operatorA:"like",valA:e}:null)};e.inputs&&e.inputs.length||a.initEditInputs(),t.each(n,function(a,n){var l=t(e.inputs[a]),s=t("<th></th>");"spinner"==n.type?l=t('<input type="text" name="'+n.name+'">'):"boolean"==n.type?l=t(BJUI.doRegional('<select name="'+n.name+'" data-toggle="selectpicker"><option value="">#all#</option><option value="true">#true#</option><option value="false">#false#</option></select>',i)):"select"==n.type&&l.find("> option:first-child").val()&&(l=t('<select name="'+n.name+'" data-toggle="selectpicker"></select>').append(BJUI.doRegional('<option value="">#all#</option>',i)).append(l.html())),s.append(l),n.hidden&&s.hide(),"boolean"==n.type&&s.attr("align","center"),s.appendTo(o),l.data("clearFilter",!1),d(l,n,s),l.on("bjui.datagrid.thead.clearfilter",function(){l.val(""),("boolean"==n.type||"select"==n.type)&&l.selectpicker("refresh")}),n.quickfilter=l}),o.appendTo(e.$thead).initui()},a.prototype.showLinenumber=function(e){{var a=this,i=a.options,n=a.columnModel,o=n[0];a.data}if(o==a.linenumberColumn)"string"!=typeof e||"lock"!=e&&"unlock"!=e?a.showhideColumn(o.th,e?!0:!1):a.colLock(o.th,"lock"==e?!0:!1);else if(e){var d,l=a.$thead.find("> tr"),s='<col style="width:30px;">',r=l.filter(".datagrid-filter"),c=l.length-r.length;o=a.linenumberColumn,n.unshift(o),a.$colgroupH.prepend(s),a.$colgroupB.prepend(s),a.$colgroupF&&a.$colgroupF.prepend(s),d=t('<th align="center" rowspan="'+c+'" class="'+a.classnames.td_linenumber+'">'+a.linenumberColumn.label+"</th>"),l.first().prepend(d),r.length&&r.prepend("<th></th>"),o.th=d,o.index=0,o.width=30,a.$tbody.find("> tr").each(function(e){t(this).prepend('<td align="center" class="'+a.classnames.td_linenumber+'">'+(e+1)+"</td>")}),a.$tableF&&a.$tableF.find("> thead > tr").prepend("<th></th>"),t.each(n,function(t,e){e.index=t,e.th&&e.th.data("index",t)}),"lock"==e&&a.colLock(d,!0),a.$showhide&&(a.$showhide.remove(),a.colShowhide(i.columnShowhide))}},a.prototype.showCheckboxcol=function(e){var a,i=this,n=i.options,o=i.columnModel,d=o[0],l=i.data;if(o[0]==i.checkboxColumn&&(a=o[0]),o[1]==i.checkboxColumn&&(a=o[1]),a)"string"!=typeof e||"lock"!=e&&"unlock"!=e?i.showhideColumn(a.th,e):i.colLock(a.th,"lock"==e?!0:!1);else if(e){var s,r,c=i.$thead.find("> tr"),h='<col style="width:26px;">',g=c.filter(".datagrid-filter"),u=c.length-g.length;a=i.checkboxColumn,s=t('<th align="center" rowspan="'+u+'" class="'+i.classnames.td_checkbox+'"><div><input type="checkbox" data-toggle="icheck"></div></th>'),d==i.linenumberColumn?(o.splice(1,0,a),l&&l.splice(1,0,{name:a.name}),a.index=1,i.$colgroupH.find("> col:first").after(h),i.$colgroupB.find("> col:first").after(h),i.$colgroupF&&i.$colgroupF.find("> col:first").after(h),g.length&&g.find("> th:first").after("<th></th>"),c.first().find("> th:first").after(s),i.$tableF&&i.$tableF.find("> thead > tr > th:first").after("<th></th>")):(o.unshift(a),l&&l.unshift({name:a.name}),a.index=0,i.$colgroupH.prepend(h),i.$colgroupB.prepend(h),i.$colgroupF&&i.$colgroupF.prepend(h),g.length&&g.prepend("<th></th>"),c.first().prepend(s),i.$tableF&&i.$tableF.find("> thead > tr").prepend("<th></th>")),s.initui(),a.th=s,a.width=26,i.$tbody.find("> tr").each(function(e){r=t('<td align="center" class="'+i.classnames.td_checkbox+'"><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox"></td>'),0==a.index?t(this).prepend(r):t(this).find("> td:first").after(r),r.initui()}),t.each(o,function(t,e){e.index=t,e.th&&e.th.data("index",t)}),"lock"==e&&i.colLock(s,!0),i.$showhide&&(i.$showhide.remove(),i.colShowhide(n.columnShowhide))}},a.prototype.showEditCol=function(e){{var a=this,i=a.options,n=a.columnModel,o=n[n.length-1];a.data}if(o==a.editBtnsColumn)a.showhideColumn(o.th,e?!0:!1);else if(e){var d,l,s=a.$thead.find("> tr"),r='<col style="width:110px;">',c=s.filter(".datagrid-filter"),h=s.length-c.length;o=a.editBtnsColumn,n.push(o),a.$colgroupH.append(r),a.$colgroupB.append(r),a.$colgroupF&&a.$colgroupF.append(r),d=t('<th align="center" rowspan="'+h+'">Edit</th>'),s.first().append(d),c.length&&c.append("<th></th>"),d.initui().data("index",n.length-1),o.th=d,o.width=110,o.index=n.length-1,a.$tbody.find("> tr").each(function(e){l=t('<td align="center" class="'+a.classnames.s_edit+'">'+BJUI.doRegional(FRAG.gridEditBtn,a.regional)+"</td>"),t(this).append(l),l.initui()}),a.edit(a.$tbody.find("> tr")),a.$tableF&&a.$tableF.find("> thead > tr").append("<th></th>"),a.$showhide&&(a.$showhide.remove(),a.colShowhide(i.columnShowhide))}},a.prototype.colResize=function(){var e=this,a=e.tools,i=e.columnModel,n=e.$thead,o=e.$grid.find("> .resizeProxy");o.length||(o=t('<div class="resizeProxy" style="left:0; display:none;"></div>'),o.appendTo(e.$grid)),n.find("> tr > th").each(function(n){var d=t(this),l=d.find("> div > ."+e.classnames.th_cell+"> ."+e.classnames.th_resizemark);l.on("mousedown.bjui.datagrid.resize",function(n){var l,s,r=e.$boxH.scrollLeft(),c=parseInt(e.$boxH.css("marginLeft")||0),h=a.getRight(d)-r+c,g=d.data("index"),u=i[g],p=u.th.width(),f=e.$tbody.find("> tr"),m=e.$lockTbody&&e.$lockTbody.find("> tr"),b=e.$lockTableB&&e.$lockTableB.height(),v=e.$tableB.height();e.isResize=!0,u.locked&&(h=a.getRight4Lock(u.lockIndex),u.lockWidth&&(p=u.lockWidth)),o.show().css({left:h,bottom:e.$box_paging?e.$box_paging.outerHeight():0,cursor:"col-resize"}).basedrag({scop:!0,cellMinW:20,relObj:o,move:"horizontal",event:n,stop:function(){var a=o.position().left,i=a-h,n=i+p,d=e.$tableH.width()+i,r=e.$lockTableH&&e.$lockTableH.width()+i;if(5>n&&(n=20),u.minWidth&&n<u.minWidth&&(n=u.minWidth),n!=p+i&&(d=d-i+(n-p),r=r-i+(n-p)),u.width=n,u.locked){if(r<.75*e.$grid.width()){u.lockWidth=n,e.$lockColgroupH.find("> col:eq("+g+")").width(n),e.$lockColgroupB.find("> col:eq("+g+")").width(n),e.$lockColgroupF&&e.$lockColgroupF.find("> col:eq("+g+")").width(n),e.$lockTableH.width(r),e.$lockTableB.width(r),e.$lockTableF&&e.$lockTableF.width(r);var c=e.$lockBox.width();e.$boxH.css("margin-left",c-1),e.$boxB.css("margin-left",c-1),e.$boxF&&e.$boxF.css("margin-left",c-1),e.$colgroupH.find("> col:eq("+g+")").width(n),e.$colgroupB.find("> col:eq("+g+")").width(n),e.$colgroupF&&e.$colgroupF.find("> col:eq("+g+")").width(n)}}else setTimeout(function(){e.$colgroupH.find("> col:eq("+g+")").width(n),e.$colgroupB.find("> col:eq("+g+")").width(n),e.$colgroupF&&e.$colgroupF.find("> col:eq("+g+")").width(n)},1);setTimeout(function(){f.css("height",""),s=e.$tableB.height(),e.$lockTbody&&(m.css("height",""),l=e.$lockTableB.height(),(l!=b||s!=v)&&(l>s?m.each(function(e){var a=t(this),i=a.find("> td:eq("+u.lockIndex+")"),n=i.outerHeight();n>30&&(a.height(n),f.eq(e).height(n))}):f.each(function(e){var a=t(this),i=a.find("> td:eq("+g+")"),n=i.outerHeight();n>30&&(a.height(n),m.eq(e).height(n))})),e.$lockB.height(e.$boxB[0].clientHeight)),u.calc&&e.$tfoot&&e.$tfoot.trigger("bjui.datagrid.tfoot.resizeH"),e.isResize=!1},10),o.hide(),e.resizeFlag=!0}})})})},a.prototype.colMenu=function(){var e=this,a=e.options,i=e.tools,n=e.regional,o=e.$trsH.find("> th."+e.classnames.th_menu),d=e.$grid.find("> ."+e.classnames.s_menu);d.legnth||(d=t(BJUI.doRegional(FRAG.gridMenu,n)),d.hide().appendTo(e.$grid),e.$menu=d),e.colShowhide(a.columnShowhide),o.each(function(){var a,n=t(this),o=n.data("index"),l=e.columnModel[o],s=n.find("> div > ."+e.classnames.th_cell),r=s.find("> ."+e.classnames.btn_menu);r.length||(a=t('<button class="btn btn-default"><i class="fa fa-bars"></button>'),r=t('<div class="'+e.classnames.btn_menu+'"></div>').append(a),r.appendTo(s),a.click(function(){var o,s,r=(n.closest("tr"),parseInt(n.attr("rowspan")||1)),c=t(this).offset().left-e.$grid.offset().left-1,h=25*(e.$trsH.length-r)+13*r+11,g=d.find("> ul > li.datagrid-li-showhide"),u=d.data("bjui.datagrid.menu.btn");u&&u.length&&u.removeClass("active"),t(this).addClass("active"),g.length&&e.$showhide&&(e.$showhide.appendTo(g),s=e.$showhide.data("width")),d.css({position:"absolute",top:h,left:c}).show().data("bjui.datagrid.menu.btn",a).siblings("."+e.classnames.s_menu).hide(),o=d.outerWidth();var p=function(t){e.$boxH.width()-t<o?d.css({left:t-o+18}).addClass("position-right"):d.css({left:t}).removeClass("position-right")},f=function(t){e.$boxB.scroll(function(){var a=t.offset().left-e.$grid.offset().left-1;p(a)})};p(c),f(a),e.colFilter(n,!0),i.locking(n);var m=d.find("> ul > li."+e.classnames.li_asc),b=m.next();m.click(function(){l.sortAsc=!1,i.quickSort(l)}),b.click(function(){l.sortAsc=!0,i.quickSort(l)}),d.on("bjui.datagrid.th.sort",function(t,e){m.toggleClass("sort-active",e),b.toggleClass("sort-active",!e)})}))}),e.$grid.on("click.bjui.datagrid.filter",function(a){var i=t(a.target),n=e.$grid.find("."+e.classnames.s_menu+":visible");n.length&&!i.closest("."+e.classnames.btn_menu).length&&(i.closest("."+e.classnames.s_menu).length||n.hide().data("bjui.datagrid.menu.btn").removeClass("active"))})},a.prototype.colShowhide=function(t){var e=this,a=(e.options,e.tools),i=e.$menu,n=i.find("> ul"),o=n.find("> li."+e.classnames.li_showhide);t?e.$showhide||(a.createShowhide(),a.showSubMenu(o,i,e.$showhide)):o.hide()},a.prototype.showhideColumn=function(e,a){var i,n,o=this,d=o.tools;if("number"==t.type(e)){if(i=parseInt(e),0>i)return}else i=e.data("index");if(n=o.columnModel[i]){if(n.locked){if(a)return;o.colLock(n.th,a)}d.showhide(n,a)}},a.prototype.colFilter=function(e,a){var i=this,n=(i.options,i.tools),o=i.regional,d=e.data("bjui.datagrid.filter"),l=i.$menu,s=l.find("> ul > li."+i.classnames.li_filter);if(i.inputs&&i.inputs.length||n.initEditInputs(),a){if(s.find("."+i.classnames.s_filter).addClass("hide"),!d||!d.length){d=t(BJUI.doRegional(FRAG.gridFilter.replaceAll("#label#",e.text()),o)).hide().appendTo(i.$grid);var r,c,h=e.data("index"),g=i.columnModel[h],u=g.type||"string",p=g.operator||[],f=d.find("span.filter-a"),m=d.find("span.filter-b"),b=t('<select data-toggle="selectpicker" data-container="true"></select>'),v=t(i.inputs[h]);v.removeAttr("data-rule").attr("size",10).addClass("filter-input"),"string"==u||"lookup"==u?p.length||(p=["=","!=","like"]):"number"==u||"int"==u||"spinner"==u?("spinner"==u&&v.removeAttr("data-toggle"),p.length||(p=["=","!=",">","<",">=","<="])):"date"==u?p.length||(p=["=","!="]):"boolean"==u?(p.length||(p=["=","!="]),v=t(BJUI.doRegional('<select name="'+g.name+'" data-toggle="selectpicker"><option value="">#all#</option><option value="true">#true#</option><option value="false">#false#</option></select>',o))):"select"==u&&(p.length||(p=["=","!="]),v.attr("data-width","80"),v.find("> option:first-child").val()&&(v=t('<select name="'+g.name+'" data-toggle="selectpicker" data-width="80"></select>').append(BJUI.doRegional('<option value="">#all#</option>',o)).append(v.html())));for(var $=0;$<p.length;$++)b.append('<option value="'+p[$]+'">'+p[$]+"</option>");r=v,c=r.clone(),f.append(b).append(v),m.append(b.clone()).append(c),e.data("bjui.datagrid.filter",d),d.appendTo(s),d.data("width",d.outerWidth()).hide().initui(),d.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(t,e){for(var a in e)g.name==a&&v.val(e[a])});var k=d.find("button.ok"),x=d.find("button.clear"),y=d.find("select"),C=y.first(),w=y.last(),_=y.eq(1);k.click(function(){var a=C.val(),o=r.val().trim(),h=w.val(),g=c.val().trim(),u=_.val(),p={};o.length&&t.extend(p,{operatorA:a,valA:o}),g.length&&(o.length&&t.extend(p,{andor:u}),t.extend(p,{operatorB:h,valB:g})),t.isEmptyObject(p)||(n.quickFilter(i.columnModel[e.data("index")],p),i.$grid.trigger("click"),s.trigger("bjui.datagrid.th.submenu.hide",[l,d]))}),x.click(function(){var t=i.columnModel[e.data("index")];y.find("> option:first").prop("selected",!0),y.selectpicker("refresh"),r.val(""),c.val(""),t.isFiltered&&(n.quickFilter(t,null),i.$grid.trigger("click"),s.trigger("bjui.datagrid.th.submenu.hide",[l,d]))})}n.showSubMenu(s,l,d.removeClass("hide")),l.find('> ul > li:not(".'+i.classnames.li_filter+'")').on("mouseover",function(){s.hasClass("active")&&s.trigger("bjui.datagrid.th.submenu.hide",[l,d])})}else s.hide()},a.prototype.initPaging=function(){var e,a=this,i=a.tools,n=(a.options,a.paging),o=BJUI.regional.pagination,d=FRAG.gridPaging,l=[],s=n.pageCount,r=[];if(0!=n.total){e=i.getPageInterval(s,n.pageCurrent,n.showPagenum);for(var c=e.start;c<e.end;c++)l.push(FRAG.gridPageNum.replace("#num#",c).replace("#active#",n.pageCurrent==c?" active":""));d=BJUI.doRegional(d.replaceAll("#pageCurrent#",n.pageCurrent).replaceAll("#count#",n.total+"/"+parseInt(s||0)),o),a.$box_paging=t('<div class="datagrid-paging-box"></div>'),a.$pagingCon=t('<div class="paging-content"></div>').width(a.$boxB.width()),a.$refreshBtn=t('<button class="btn-default btn-refresh" title="'+o.refresh+'" data-icon="refresh"></button>'),a.$paging=t('<div class="datagrid-paging"></div>'),a.$btnpaging=t(d),a.$pagenum=t(l.join("")),a.$pagesize=t('<div class="datagrid-pagesize"><span></span></div>'),a.$selectpage=t('<select data-toggle="selectpicker"></select>'),a.$pagingCon.appendTo(a.$box_paging),a.$box_paging.appendTo(a.$grid),a.$pagesize.appendTo(a.$pagingCon),a.$refreshBtn.appendTo(a.$pagesize),a.$selectpage.appendTo(a.$pagesize),a.$paging.appendTo(a.$pagingCon),a.$btnpaging.appendTo(a.$paging),a.$pagenum.insertAfter(a.$btnpaging.find("> li.page-prev")),a.$box_paging.initui();var h=a.$btnpaging.find("> li.page-jumpto"),g=h.next(),u=g.next(),p=a.$btnpaging.find("> li.page-next"),f=p.next(),m=function(){g.addClass("disabled"),u.addClass("disabled")},b=function(){g.removeClass("disabled"),u.removeClass("disabled")},v=function(){p.addClass("disabled"),f.addClass("disabled")},$=function(){p.removeClass("disabled"),f.removeClass("disabled")},k=function(){m(),$()},x=function(){b(),v()},y=function(e){a.$selectpage.empty(),e||(e=a.paging.pageSize),r=n.selectPageSize.split(","),r.push(String(e)),t.unique(r).sort(function(t,e){return t-e}),t.each(r,function(e,i){var d=t('<option value="'+i+'">'+i+"/"+o.page+"</option>");i==n.pageSize&&d.prop("selected",!0),a.$selectpage.append(d)}),a.$selectpage.selectpicker("refresh")};1==n.pageCurrent&&k(),n.pageCurrent==n.pageCount&&(x(),1==n.pageCurrent&&m()),y(),a.$paging.on("click",".page-num",function(e){var i=t(this);i.hasClass("active")||a.jumpPage(i.text()),e.preventDefault()}).on("bjui.datagrid.paging.jump",function(e){for(var o=a.paging.pageCurrent,d=i.getPageInterval(a.paging.pageCount,o,n.showPagenum),l=[],s=d.start;s<d.end;s++)l.push(FRAG.gridPageNum.replace("#num#",s).replace("#active#",o==s?" active":""));a.$pagenum.empty(),a.$pagenum=t(l.join("")),a.$pagenum.insertAfter(u),1==o?(k(),o==a.paging.pageCount&&v()):o==a.paging.pageCount?x():(b(),$()),h.find("input").val(o),a.$btnpaging.find("> li.page-total > span").html(a.paging.total+"/"+a.paging.pageCount)}),a.$selectpage.on("bjui.datagrid.paging.pageSize",function(t,e){y(e)}),h.find("input").on("keyup",function(e){if(e.which==BJUI.keyCode.ENTER){var i=t(this).val();i&&a.jumpPage(i)}}),g.on("click",function(){a.paging.pageCurrent>1&&a.jumpPage(1)}),u.on("click",function(){a.paging.pageCurrent>1&&a.jumpPage(a.paging.pageCurrent-1)}),p.on("click",function(){a.paging.pageCurrent<a.paging.pageCount&&a.jumpPage(a.paging.pageCurrent+1)}),f.on("click",function(){a.paging.pageCurrent<a.paging.pageCount&&a.jumpPage(a.paging.pageCount)}),a.$refreshBtn.on("click",function(){a.refresh()}),a.$selectpage.on("change",function(){var e=t(this).val();a.jumpPage(null,e)})}},a.prototype.jumpPage=function(t,e){var a=this,i=a.paging,n=i.pageCount;t&&isNaN(t)||e&&isNaN(e)||t&&(t=parseInt(t),1>t&&(t=1),t>n&&(t=n),t==i.pageCurrent)||e&&(e=parseInt(e),e>i.total)||a.tools.jumpPage(t,e)},a.prototype.add=function(e){if(this.tools.beforeEdit()){if(!this.options.editUrl)return void BJUI.debug("Datagrid Plugin: Edit url is not set!");if(this.options.editMode){this.options.inlineEditMult||this.doCancelEditRow(this.$tbody.find("> tr."+this.classnames.tr_edit));var a,i,n=this,o=n.options,d=(n.tools,n.paging),l={},s=(d.pageCurrent-1)*d.pageSize,r=function(e){var a=t("<tr></tr>").addClass(n.classnames.tr_add),i=a.clone();return t.each(n.columnModel,function(e,o){var d=t("<td></td>");o.gridNumber?d.addClass(n.classnames.td_linenumber).text(0):o.gridCheckbox?d.addClass(n.classnames.td_checkbox).html('<div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div>'):o.gridEdit?d.addClass(n.classnames.s_edit).data("isAdd",!0).html(BJUI.doRegional(FRAG.gridEditBtn,n.regional)):d.text(""),o.hidden&&d.css("display","none"),o.align&&d.attr("align",o.align),l[o.name]="",o.locked?(d.clone().show().appendTo(i),d.hide().appendTo(a)):d.appendTo(a)}),l=t.extend({},n.attach,l),n.emptyData||(n.emptyData=l),{tr:a,lockTr:i.find("> td").length?i:null}};e||(e=o.addLocation||"first"),n.$lastSelect||("prev"==e?e="first":"next"==e&&(e="last")),"first"==e?(i=0,a=r(i),a.tr.prependTo(n.$tbody),a.lockTr&&a.lockTr.prependTo(n.$lockTbody)):"last"==e?(i=n.data?n.data.length:0,a=r(i),a.tr.appendTo(n.$tbody),a.lockTr&&a.lockTr.appendTo(n.$lockTbody)):"prev"==e?(i=n.$lastSelect.index(),a=r(i),a.tr.insertBefore(n.$lastSelect),a.lockTr&&a.lockTr.insertBefore(n.$lockTbody.find("> tr:eq("+n.$lastSelect.index()+")"))):"next"==e&&(i=n.$lastSelect.index()+1,a=r(i),a.tr.insertAfter(n.$lastSelect),a.lockTr&&a.lockTr.insertAfter(n.$lockTbody.find("> tr:eq("+n.$lastSelect.index()+")")));var c=t.extend({},n.emptyData,{addFlag:!0});n.data||(n.data=[]),n.allData||(n.allData=[]),n.allData.length?n.allData.splice(i+s,0,c):n.allData.push(c),n.data.length?n.data.splice(i,0,c):n.data.push(c),t.each(n.data,function(e,a){var i=o.linenumberAll?s+(e+1):e+1;t.extend(a,{gridNumber:i,gridIndex:e})}),a.tr.initui(),setTimeout(function(){n.initEvents(a.tr)},20),a.lockTr&&n.initLockEvents(a.lockTr),n.edit(a.tr),"dialog"!=o.editMode?n.doEditRow(a.tr,"inline",!0):n.dialogEdit(a.tr,!0)}}},a.prototype.edit=function(e){{var a,i=this,n=i.options,o=i.tools,d=n.editMode;i.columnModel}"dialog"!=d&&(d="inline"),e||(e=i.$tbody.find("> tr")),a=e.find("> td."+i.classnames.s_edit),a.each(function(){var e=t(this),a=e.find("button"),n=a.first(),l=n.next(),s=l.next(),r=s.next(),c=r.next();n.on("click",function(n,c){var h=t(this),g=h.closest("tr"),u=e.data("isAdd");return c||(c=i.isDom?g.data("initData")||o.setDomData(g):i.data[g.index()]),o.beforeEdit(g,c)?("dialog"!=d?(i.inlineEdit(g,u),a.hide(),l.show(),r.show(),u&&(l.hide(),s.show())):i.dialogEdit(g,u),void n.stopPropagation()):!1}),s.on("click",function(e){var a=t(this),n=a.closest("tr");i.updateEdit(n,a),e.stopPropagation()}).on("bjui.datagrid.update.tr",function(){a.hide(),n.show(),c.show()}),l.on("click",function(e){var a=t(this),n=a.closest("tr");i.updateEdit(n,a),e.stopPropagation()}).on("bjui.datagrid.update.tr",function(){a.hide(),n.show(),c.show()}),r.on("click",function(e){var o=t(this),d=o.closest("tr");i.cancelEdit(d),a.hide(),n.show(),c.show(),e.stopPropagation()}),c.on("click",function(e){var a=t(this),n=a.closest("tr");i.delRows(n),e.stopPropagation()})})},a.prototype.doEditRow=function(e,a,i){var n,o,d=this,l=[];if(a=a||d.options.editMode,"object"==typeof e)n=e;else if(isNaN(e)){var s,r=d.$tbody.find("> tr"),e=e.split(",");e=e.unique(),e.sort(function(t,e){return t.trim()-e.trim()}),t.each(e,function(t,e){var a=r.eq(parseInt(e.trim()));a&&a.length&&(s=s?s.add(a):a)}),n=s}else isNaN(e)||(n=d.$tbody.find("> tr").eq(e));return n.length&&(n.each(function(){var e,a=t(this),i=a.index();e=d.isDom?a.data("initData")||tools.setDomData(a):d.data[i],l.push(e)}),d.tools.beforeEdit(n,l))?d.options.editUrl?void n.each(function(e){var n=t(this);o=n.find("> td."+d.classnames.s_edit+" > button.edit"),"dialog"!=a?o.length?o.trigger("click",[l[e]]):d.inlineEdit(n,i,l[e]):d.dialogEdit(n,i,l[e])}):void BJUI.debug("Datagrid Plugin: Edit url is not set!"):void 0},a.prototype.doCancelEditRow=function(e){var a,i=this;a="number"==t.type(e)?this.$tbody.find("> tr").eq(e):e,a.each(function(){var e=t(this),a=e.find("> td."+i.classnames.s_edit+" > button.cancel");a.length?a.trigger("click"):i.cancelEdit(e)})},a.prototype.doSaveEditRow=function(e){var a,i=this,n=i.options;a="number"==t.type(e)?this.$tbody.find("> tr").eq(e):e?e:i.$tbody.find("> tr."+i.classnames.tr_edit),a.length||i.$grid.alertmsg("info",BJUI.getRegional("datagrid.saveMsg")),1==a.length?a.hasClass(i.classnames.tr_edit)&&this.updateEdit(a):n.saveAll?i.saveAll(a):a.each(function(){i.updateEdit(t(this))})},a.prototype.delRows=function(e){var a,i=this,n=i.options,o=n.beforeDelete,d=n.delConfirm;if(!o||("string"==typeof o&&(o=o.toFunc()),"function"!=typeof o||o.call(this))){if("object"==typeof e)a=e;else if(isNaN(e)){var l,s=i.$tbody.find("> tr"),e=e.split(",");e=e.unique(),e.sort(function(t,e){return t.trim()-e.trim()}),t.each(e,function(t,e){var a=s.eq(parseInt(e.trim()));a&&a.length&&(l=l?l.add(a):a)}),a=l}else isNaN(e)||(a=this.$tbody.find("> tr").eq(e));if(a&&a.length){var r=function(){a.each(function(){t(this).trigger("bjui.datagrid.tr.delete")}),i.tools.afterDelete()},c=function(){var e=a.filter("."+i.classnames.tr_add);if(!e.length||(e.remove(),e.length!=a.length))if(n.delUrl){var o=[],d=n.delCallback;a.each(function(){var e,a,d=t(this),l=d.index();e=i.isDom?d.data("initData")||tools.setDomData(d):i.data[l],n.delPK?o.push(e[n.delPK]):(n.jsonPrefix?(a={},t.each(e,function(t,e){return"gridCheckbox"==t||"gridEdit"==t?!0:void(a[n.jsonPrefix+"."+t]=e)})):(a=t.extend({},e),delete a.gridCheckbox,delete a.gridEdit),o.push(a))}),"string"==typeof d&&(d=d.toFunc()),i.$grid.bjuiajax("doAjax",{url:n.delUrl,data:n.delPK?[{name:n.delPK,value:o.join(",")}]:{json:JSON.stringify(o)},type:n.delType,callback:d||function(t){t[BJUI.keys.statusCode]==BJUI.statusCode.ok?r():i.$grid.bjuiajax("ajaxDone",t)}})}else r()};d?("string"!=typeof d&&(d=BJUI.getRegional(1==a.length?"datagrid.delMsg":"datagrid.delMsgM")),i.$grid.alertmsg("confirm",d,{okCall:function(){c()}})):c()}}},a.prototype.inlineEdit=function(e,a,i){if(!this.tools.beforeEdit(e,i))return!1;var n=this,o=n.options,d=n.tools,l=n.columnModel,s=e.find("> td"),r=s.length,c=e.index();return i||(i=n.isDom?e.data("initData")||d.setDomData(e):n.data[c]),e.hasClass(n.classnames.tr_edit)?!1:(n.inputs&&n.inputs.length||d.initEditInputs(),e.addClass(n.classnames.tr_edit).data(n.datanames.changeData,{}),e.data("validator")&&e.validator("destroy"),o.inlineEditMult||n.doCancelEditRow(e.siblings("."+n.classnames.tr_edit)),n.$lastEditTr=e,void s.each(function(o){var d,s=t(this),h=l[o],g=h&&h.name&&i[h.name],u=s.html(),p=n.inputs[o],f=function(a,o,d){var l=e.data(n.datanames.changeData);switch(h.type){case"date":a.on("afterchange.bjui.datepicker",function(t,e){o.addClass(n.classnames.td_changed),a.val()==d&&o.removeClass(n.classnames.td_changed),l[h.name]=a.val()}).change(function(){o.addClass(n.classnames.td_changed),a.val()==d&&o.removeClass(n.classnames.td_changed),l[h.name]=a.val()});break;case"select":a.change(function(){o.addClass(n.classnames.td_changed),a.val()==String(d)&&o.removeClass(n.classnames.td_changed),l[h.name]=a.val()});break;case"boolean":a.on("ifChanged",function(){o.toggleClass(n.classnames.td_changed);var e=t(this).is(":checked")?!0:!1;e==d&&o.removeClass(n.classnames.td_changed),l[h.name]=e});break;case"lookup":o.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(t,e){o.toggleClass(n.classnames.td_changed);for(var d in e)"undefined"!=typeof i[d]&&(l[d]=e[d]),h.name==d&&(a.val()==e[d]?o.removeClass(n.classnames.td_changed):a.val(e[d]))}),a.change(function(){o.addClass(n.classnames.td_changed),a.val()==d&&o.removeClass(n.classnames.td_changed),l[h.name]=a.val()});break;case"spinner":a.on("afterchange.bjui.spinner",function(t,e){o.addClass(n.classnames.td_changed),a.val()==d&&o.removeClass(n.classnames.td_changed),l[h.name]=a.val()}).change(function(){o.addClass(n.classnames.td_changed),a.val()==d&&o.removeClass(n.classnames.td_changed),l[h.name]=a.val()});break;default:a.change(function(){o.addClass(n.classnames.td_changed),a.val()==d&&o.removeClass(n.classnames.td_changed),l[h.name]=a.val()})}};if(s.data(n.datanames.td_html,u),a?h.add||(p=""):h.edit||(p=""),p&&(d=t(p),"boolean"==h.type?d.prop("checked",g):(g&&"null"!=g||(g=""),d.val(String(g))),a?h.addAttrs&&"object"==typeof h.addAttrs&&t.each(h.addAttrs,function(t,e){d.attr(t,e)}):h.editAttrs&&"object"==typeof h.editAttrs&&t.each(h.editAttrs,function(t,e){d.attr(t,e)}),s.empty().append(d).addClass(n.classnames.td_edit),f(d,s,g),h.locked)){var m=n.$lockTbody.find("tr:eq("+c+")"),b=m.find("> td:eq("+h.lockIndex+")");s.clone().html(u).insertAfter(s),s.show().insertAfter(b).initui(),b.remove()}--r||e.initui().validator({msgClass:"n-bottom",theme:"red_bottom_effect_grid"})}))},a.prototype.saveAll=function(e){var a,i,n,o,d=this,l=d.options,s=l.editCallback,r=[],c=e&&e.length;(!e||e.length)&&(e=d.$tbody.find("> tr."+d.classnames.tr_edit),c=e.length),e.each(function(){a=t(this),i=d.isDom?a.data("initData"):d.data[a.index()],a.isValid(function(e){return e?(n=a.data(d.datanames.changeData),t.extend(i,n),l.jsonPrefix?(o={},t.each(i,function(t,e){return"gridCheckbox"==t||"gridEdit"==t?!0:void(o[l.jsonPrefix+"."+t]=e)})):(o=t.extend({},i),delete o.gridCheckbox,delete o.gridEdit),c--,r.push(o),void 0):(r=[],!1)})}),c||(s=s?s.toFunc():function(a){var i=!1,n=[];"array"==t.type(a)?(i=!0,n=a):"object"==t.type(a)&&(a[BJUI.keys.statusCode]?a[BJUI.keys.statusCode]==BJUI.statusCode.ok?i=!0:d.$grid.bjuiajax("ajaxDone",a):(i=!0,n.push(a))),i&&(e.each(function(e){var a=t(this),i=d.isDom?a.data("initData"):d.data[a.index()];t.extend(i,"object"==typeof n[e]&&n[e]),d.inlineEditComplete(a,i)}),d.tools.afterSave(e,r))},d.$grid.bjuiajax("doAjax",{url:l.editUrl,data:{json:JSON.stringify(r)},type:"POST",callback:s}))},a.prototype.updateEdit=function(e,a){var i,n,o,d=this,l=d.options,s=l.editCallback,r=[];i=d.isDom?e.data("initData"):d.data[e.index()],e.hasClass(d.classnames.tr_edit)&&e.isValid(function(c){c&&(n=e.data(d.datanames.changeData),t.extend(i,n),l.jsonPrefix?(o={},t.each(i,function(t,e){return"gridCheckbox"==t||"gridEdit"==t?!0:void(o[l.jsonPrefix+"."+t]=e)})):(o=t.extend({},i),delete o.gridCheckbox,delete o.gridEdit),s=s?s.toFunc():function(n){var o,l=!1;"array"==t.type(n)?(l=!0,o=n[0]):"object"==t.type(n)&&(n[BJUI.keys.statusCode]?n[BJUI.keys.statusCode]==BJUI.statusCode.ok?l=!0:d.$grid.bjuiajax("ajaxDone",n):(l=!0,o=n)),l&&(t.extend(i,"object"==typeof o&&o),d.inlineEditComplete(e,i,a),d.tools.afterSave(e,i))},e.bjuiajax("doAjax",{url:l.editUrl,data:{json:JSON.stringify(r.push(o)&&r)},type:"POST",callback:s}))})},a.prototype.cancelEdit=function(e){var a=this,i=a.columnModel;e.each(function(){var e=t(this),n=e.index();if(e.hasClass(a.classnames.tr_edit)&&e.removeClass(a.classnames.tr_edit).find("> td."+a.classnames.td_edit).each(function(){var e=t(this),o=e.index(),d=i[o],l=e.data(a.datanames.td_html);if(e.removeClass(a.classnames.td_edit).removeClass(a.classnames.td_changed).html(l),d.locked){var s=a.$lockTbody.find("tr:eq("+n+")"),r=s.find("> td:eq("+d.lockIndex+")");l=r.data(a.datanames.td_html),s.removeClass(a.classnames.tr_edit),r.removeClass(a.classnames.td_edit).removeClass(a.classnames.td_changed).html(l)}}),e.hasClass(a.classnames.tr_add)){var o=!1,d=e.data(a.datanames.changeData);if(t.isEmptyObject(d))o=!0;else{for(var l in d)d[l]||delete d[l];t.isEmptyObject(d)&&(o=!0)}if(o){var s=e.index();a.data=a.data.remove(s),a.$lockTbody&&a.$lockTbody.find("> tr:eq("+s+")").remove(),e.remove()}}})},a.prototype.inlineEditComplete=function(e,i,n){var o=this,d=o.columnModel,l=e.index(),s=e.find("> td"),r=!1,c=o.$tbody.find("> tr"),h=c.filter("."+o.classnames.tr_add);t.each(d,function(t,e){if(e.gridNumber&&(r=!0),e.name&&!(e.gridNumber||e.gridCheckbox||e.gridEdit)){var n,d=i[e.name],c=s.eq(e.index);if("undefined"==typeof d&&(d=""),c.text(d).removeClass(o.classnames.td_edit).removeClass(o.classnames.td_changed),e.render&&"function"==typeof e.render?e.items?(n=e.render.call(o,d,e.items),c.html(n)):(n=e.render.call(o,d),c.html(n)):e.items&&(n=a.renderItem.call(o,d,e.items),c.html(n)),e.locked){var h=o.$lockTbody.find("> tr:eq("+l+")"),g=h.find("> td:eq("+e.lockIndex+")");g.removeClass(o.classnames.td_changed).html(c.html())}}}),e.removeClass(o.classnames.tr_edit),n||(n=s.filter("."+o.classnames.s_edit).find("button.update")),n&&n.length&&n.trigger("bjui.datagrid.update.tr"),r&&h.length&&(h.removeClass(o.classnames.tr_add),c.each(function(e){t(this).find("> td."+o.classnames.td_linenumber).text(e+1),o.$lockTbody&&o.$lockTbody.find("> tr:eq("+e+")").find("> td."+o.classnames.td_linenumber).text(e+1)}))},a.prototype.dialogEdit=function(e,a,i){if(!this.tools.beforeEdit(e,i))return!1;var n,o,d,l=this,s=l.options,r=l.tools,c=l.columnModel,h=e.index();i||(i=l.isDom?e.data("initData")||r.setDomData(e):l.data[h]),l.inputs&&l.inputs.length||r.initEditInputs(),d=s.gridTitle||"datagrid",d+=a?" - "+BJUI.getRegional("datagrid.add"):" - "+BJUI.getRegional("datagrid.edit"),n=t('<div><div class="bjui-pageContent"></div><div class="bjui-pageFooter"></div></div>'),o=t('<form class="datagrid-dialog-edit-form"></form>');var g=function(e,a,n,o){var d=e.data(l.datanames.changeData);switch(o.type){case"date":n.on("afterchange.bjui.datepicker",function(t,e){d[o.name]=n.val()}).change(function(){d[o.name]=n.val()});break;case"select":n.change(function(){d[o.name]=n.val()});break;case"boolean":n.on("ifChanged",function(){var e=t(this).is(":checked")?!0:!1;d[o.name]=e});break;case"lookup":a.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(t,e){for(var a in e)"undefined"!=typeof i[a]&&(d[a]=e[a]),o.name==a&&n.val(e[a])}),n.change(function(){d[o.name]=n.val()});break;case"spinner":n.on("afterchange.bjui.spinner",function(t,e){d[o.name]=n.val()}).change(function(){d[o.name]=n.val()});break;default:n.change(function(){d[o.name]=n.val()})}},u=function(a){var n=a.find("form.datagrid-dialog-edit-form"),o=a.find("div.bjui-pageFooter button"),d=o.first(),h=o.eq(1),u=o.eq(2),p=o.last(),f=function(e,a,i){a.empty(),i.data(l.datanames.changeData)||i.data(l.datanames.changeData,{}),a.data("validator")&&a.validator("destroy"),t.each(c,function(n,o){if(o==l.linenumberColumn||o==l.checkboxColumn||o==l.editBtnsColumn)return!0;var d=t(l.inputs[n]),s=t("<p></p>"),r="datagrid-dialog-edit-column-"+n;d.isTag("select")?d.attr("data-width","auto"):d.isTag("checkbox")||d.attr("size",30),"boolean"==o.type?d.attr("checked",e[o.name]):"textarea"==o.type?d.html(e[o.name]):d.attr("value",e[o.name]),s.append('<label class="control-label x120" for="'+r+'">'+o.label+"：</label>").append(t('<span class="datagrid-dialog-column-span"></span>').append(d.attr("id",r))).appendTo(a),g(i,a,d,o)}),a.initui().validator({msgClass:"n-bottom",theme:"red_bottom_effect_grid"})};n.is(":empty")&&f(i,n,e),0==e.index()&&d.addClass("disabled"),e.index()==l.data.length-1&&h.addClass("disabled"),d.click(function(){var t,a=e.prev();a.length?(t=l.isDom?a.data("initData")||r.setDomData(a):l.data[a.index()],e=a,f(t,n,e),h.removeClass("disabled"),a.prev().length||d.addClass("disabled")):d.addClass("disabled")}),h.click(function(){var t,a=e.next();a.length?(t=l.isDom?a.data("initData")||r.setDomData(a):l.data[a.index()],e=a,f(t,n,e),n.initui(),d.removeClass("disabled"),a.next().length||h.addClass("disabled")):h.addClass("disabled")}),p.click(function(){var a,i,o,d=s.editCallback;i=l.isDom?e.data("initData"):l.data[e.index()],n.isValid(function(n){n&&(a=e.data(l.datanames.changeData),t.extend(i,a),s.jsonPrefix?(o={},t.each(i,function(t,e){return"gridCheckbox"==t||"gridEdit"==t?!0:void(o[s.jsonPrefix+"."+t]=e)})):(o=t.extend({},i),delete o.gridCheckbox,delete o.gridEdit),d=d?d.toFunc():function(a){var n,o=!1;"array"==t.type(a)?(o=!0,n=a[0]):"object"==t.type(a)&&(a[BJUI.keys.statusCode]?a[BJUI.keys.statusCode]==BJUI.statusCode.ok?o=!0:l.$grid.bjuiajax("ajaxDone",a):(o=!0,n=a)),o&&(t.extend(i,"object"==typeof n&&n),l.dialogEditComplete(e,i),l.$grid.dialog("close","datagrid-dialog-edit"),l.tools.afterSave(e,i))},e.bjuiajax("doAjax",{url:s.editUrl,data:{json:JSON.stringify(o)},type:"POST",callback:d}))})}),u.click(function(){l.$grid.dialog("close","datagrid-dialog-edit")})},p=function(){l.$tbody.find("> tr."+l.classnames.tr_add).each(function(){var e=!1,a=t(this),i=a.data(l.datanames.changeData);if(t.isEmptyObject(i))e=!0;else{for(var n in i)i[n]||delete i[n];t.isEmptyObject(i)&&(e=!0)}if(e){var o=a.index();l.data=l.data.remove(o),l.$lockTbody&&l.$lockTbody.find("> tr:eq("+o+")").remove(),a.remove()}})};n.find("> div:first").append(o).next().append(BJUI.doRegional(FRAG.gridDialogEditBtns,l.regional));var f=t.extend({},{id:"datagrid-dialog-edit",fresh:!0,target:n[0],width:520,height:400,mask:!0,title:d,onLoad:u,onClose:p},"object"==typeof s.editDialogOp&&s.editDialogOp);l.$grid.dialog(f)},a.prototype.dialogEditComplete=function(e,i){var n=this,o=n.columnModel,d=e.index(),l=e.find("> td"),s=!1,r=n.$tbody.find("> tr"),c=r.filter("."+n.classnames.tr_add);t.each(o,function(t,e){if(e.gridNumber&&(s=!0),e.name&&!(e.gridNumber||e.gridCheckbox||e.gridEdit)){var o,r=i[e.name],c=l.eq(e.index);if("undefined"==typeof r&&(r=""),c.text(r).removeClass(n.classnames.td_edit).removeClass(n.classnames.td_changed),e.render&&"function"==typeof e.render?e.items?(o=e.render.call(n,r,e.items),c.html(o)):(o=e.render.call(n,r),c.html(o)):e.items&&(o=a.renderItem.call(n,r,e.items),c.html(o)),e.locked){var h=n.$lockTbody.find("> tr:eq("+d+")"),g=h.find("> td:eq("+e.lockIndex+")");g.removeClass(n.classnames.td_edit).removeClass(n.classnames.td_changed).html(c.html()),h.removeClass(n.classnames.tr_edit)}}}),s&&c.length&&(c.removeClass(n.classnames.tr_add),r.each(function(e){t(this).find("> td."+n.classnames.td_linenumber).text(e+1),n.$lockTbody&&n.$lockTbody.find("> tr:eq("+e+")").find("> td."+n.classnames.td_linenumber).text(e+1)}))},a.prototype.resizeGrid=function(){var e,a,i=this,n=i.$grid.getPageTarget(),o=function(){i.initFixedW&&String(i.options.width).endsWith("%")&&(e=i.$grid.parent().width(),n.is(":hidden")&&n.hasClass("navtabPage")?i.$grid.data("need.fixedW",!0):i.fixedWidth()),String(i.options.height).endsWith("%")&&(a=i.$grid.parent().height(),n.is(":hidden")&&n.hasClass("navtabPage")?n.hasClass("navtabPage")&&i.$grid.data("need.fixedH",!0):a&&a!=i.parentH&&i.tools.fixedH(a))};n.on("bjui.navtab.switch",t.proxy(function(){i.$grid.data("need.fixedH")&&(a=i.$grid.parent().height(),a&&i.tools.fixedH(a),i.$grid.removeData("need.fixedH")),i.$grid.data("need.fixedW")&&(i.fixedWidth(),i.$grid.removeData("need.fixedW"))},i)),t(window).on(BJUI.eventType.resizeGrid,t.proxy(o,i))};var i=t.fn.datagrid;t.fn.datagrid=e,t.datagrid=a,t.fn.datagrid.noConflict=function(){return t.fn.datagrid=i,this},t(document).on(BJUI.eventType.initUI,function(a){var i=t(a.target).find('table[data-toggle="datagrid"]');i.length&&e.call(i)})}(jQuery);
+function(t){"use strict";function e(e){var n=arguments,s=e;return this.each(function(){var a=t(this),d=t.extend({},i.DEFAULTS,a.data(),"object"==typeof e&&e),r=a.data("bjui.tablefixed");r||a.data("bjui.tablefixed",r=new i(this,d)),"string"==typeof s&&t.isFunction(r[s])?([].shift.apply(n),n?r[s].apply(r,n):r[s]()):r.init()})}var i=function(e,i){this.$element=t(e),this.options=i,this.tools=this.TOOLS()};i.SCROLLW=18,i.DEFAULTS={width:"100%"},i.prototype.TOOLS=function(){var e={getLeft:function(e){var i=0;return e.prevAll().each(function(){i+=t(this).outerWidth()}),i},getRight:function(e){var i=0;return e.prevAll().andSelf().each(function(){i+=t(this).outerWidth()}),i-1},getCellNum:function(t){return t.prevAll().andSelf().size()},getColspan:function(t){return t.attr("colspan")||1},getStart:function(e){var i=1;return e.prevAll().each(function(){i+=parseInt(t(this).attr("colspan")||1)}),i},getPageCoord:function(t){for(var e={x:0,y:0};t;)e.x+=t.offsetLeft,e.y+=t.offsetTop,t=t.offsetParent;return e},getOffset:function(e,i){if(!t.support.leadingWhitespace){var n=e.offset(),s={offsetX:i.pageX||i.screenX,offsetY:i.pageY||i.screenY},a={offsetX:s.offsetX-n.left,offsetY:s.offsetY-n.top};return a}var d=i.target;void 0==d.offsetLeft&&(d=d.parentNode);var r=this.getPageCoord(d),o={x:window.pageXOffset+i.clientX,y:window.pageYOffset+i.clientY},a={offsetX:o.x-r.x,offsetY:o.y-r.y};return a}};return e},i.prototype.resetWidth=function(){var e=this.$element,n=e.width(),s=e.find("table"),a=s&&s.width(),d=s.eq(0)&&s.eq(0).find("tr:first-child > th"),r=s.eq(1)&&s.eq(1).find("tr:first-child > td");if(s&&n-a<i.SCROLLW){var o=parseInt((n-a)/d.length);s.width(n-i.SCROLLW),d.each(function(e){var i=parseInt(t(this).css("width"));t(this).width(i+o),r.eq(e)&&r.eq(e).width(i+o)})}},i.prototype.init=function(){if(this.$element.isTag("table")){this.$container=this.$element.parent().addClass("bjui-resizeGrid"),this.$fixed=void 0;var t=this.$container.width(),e=this.options.height;this.$container.hasClass("tab-pane")&&(t=this.$container.parent().width()-20),this.options.newWidth="string"==typeof this.options.width&&this.options.width.indexOf("%")?t*(this.options.width.replace("%","")/100):parseInt(this.options.width),this.options.styles=[],this.$element.wrap('<div class="bjui-tablefixed clearfix"></div>'),this.$fixed=this.$element.parent(),this.initHead(),this.initBody(),this.resizeCol(),this.resizeGrid(),e&&!this.$fixed.closest(".tab-content").length&&this.$fixed.height(e).addClass("fixedH")}},i.prototype.initHead=function(){var e=this.options.styles=[],n=this.$element.find("thead > tr"),s=n.eq(0).find("> th"),a=(this.$element,0),d=[],r=[],o=-1;s.each(function(e){for(var i=t(this),n=parseInt(i.attr("colspan")||1),s=i.attr("width"),a=i.attr("align"),h="",l=0;n>l;l++)1==n&&s&&(h=' width="'+s+'"'),a&&i.removeAttr("align").addClass(a),d.push("<th"+h+"></th>");i.attr("colsNum",o+=n),r[e]=n});var h=d.length,l=t('<tr class="resize-head">'+d.join("")+"</tr>");if(n.length>1){o=0;var f=n.eq(1).find("> th");t.each(r,function(t,e){if(e=parseInt(e),e>1)for(var i=parseInt(s.eq(t).attr("colsnum")),n=e-1;n>=0;n--){var a=f.eq(o++),d=i-n,r=a.attr("width"),h=a.attr("align"),c=l.find("> th").eq(d);a&&a.length&&a.attr("colsnum",d),r&&c.attr("width",r),h&&a.addClass(h).removeAttr("align")}})}this.$fixed.html(this.$element.html());var c=this.$fixed.find("thead");c.prepend(l),l.find("> th").each(function(i){var n=t(this),s=[],d=n.innerWidth();s[0]=parseInt(d),a+=s[0],e[e.length]=s}),a=parseInt((this.options.newWidth-i.SCROLLW-a)/h);var p=c.find("> tr:eq(0) > th");this.options.$ths=p,p.each(function(i){var n=t(this),s=e[i],d=n.attr("width");n.removeAttr("align").width(s[0]+a),s[0]=s[0]+a,d&&(s[0]=parseInt(d),n.width(d).removeAttr("width"))}),c.find("> tr:gt(0) > th").each(function(){var e=t(this);e.html('<div class="fixedtableCol" title="'+e.html()+'">'+e.html()+"</div>")}),c.wrap('<div class="fixedtableHeader" style="width:'+(this.options.newWidth-i.SCROLLW)+'px;overflow:hidden;"><div class="fixedtableThead"><table class="table table-bordered" style="width:'+(this.options.newWidth-i.SCROLLW)+"px; max-width:"+(this.options.newWidth-i.SCROLLW)+'px;"></table></div></div>'),this.$fixed.append('<div class="resizeMarker" style="display:none; height:300px; left:57px;"></div><div class="resizeProxy" style="left:377px; display:none; height:300px;"></div>')},i.prototype.initBody=function(){{var e,n,s=this,a=this.$fixed.find("> tbody");this.options.styles}if(this.options.height)n=this.options.height-this.$fixed.find(".fixedtableHeader").height()+"px";else{n="100%";var d=function(){var t=s.$fixed.parent().height();s.$fixed.parent().css("overflow","hidden"),s.$fixed.height(t).find(".fixedtableScroller").height(t-s.$fixed.find(".fixedtableHeader").height())};t(document).one(BJUI.eventType.afterInitUI,function(t){d()})}e='style="height:'+n+'; overflow-y:auto;"',a.wrap('<div class="fixedtableScroller"'+e+' style="width:'+this.options.newWidth+'px;"><div class="fixedtableTbody"><table style="width:'+(this.options.newWidth-i.SCROLLW)+"px; max-width:"+(this.options.newWidth-i.SCROLLW)+'px;"></table></div></div>'),a.parent().addClass(this.$element.attr("class")?this.$element.attr("class"):"table table-striped table-bordered table-hover"),"undefined"!=typeof this.$element.attr("data-selected-multi")&&a.parent().attr("data-selected-multi",this.$element.attr("data-selected-multi")),"undefined"!=typeof this.$element.attr("data-on-click")&&a.parent().attr("data-on-click",this.$element.attr("data-on-click")),a.before('<thead><tr class="resize-head">'+this.$fixed.find("thead > tr").html()+"</tr></thead>"),this.options.$tds=a.prev().find("> tr:first-child > th"),this.options.nowrap&&a.parent().addClass("nowrap"),a.closest(".fixedtableScroller").scroll(function(e){var i=t(this),n=i.scrollLeft(),s=i.prev().find("> .fixedtableThead");return s.css({position:"relative",left:-n}),!1})},i.prototype.resizeCol=function(){var e=this,n=this.$fixed,s=this.options.$ths,a=this.options.$tds,d=this.tools;n.find("thead > tr:gt(0) > th").each(function(r){var o=t(this);o.mouseover(function(t){var r=parseInt(n.find(".fixedtableThead").css("left"))||0,h=d.getOffset(o,t).offsetX,l=s.eq(o.attr("colsnum"));return o.outerWidth()-h<5?o.css("cursor","col-resize").off("mousedown.bjui.tablefixed.resize").on("mousedown.bjui.tablefixed.resize",function(t){n.find("> .resizeProxy").show().css({left:d.getRight(l)+r+n.position().left,top:n.position().top,height:n.height(),cursor:"col-resize"}).basedrag({scop:!0,cellMinW:20,relObj:n.find(".resizeMarker"),move:"horizontal",event:t,stop:function(){var t=n.find(".resizeProxy").position().left,s=n.find(".resizeMarker").position().left,r=t-s-l.outerWidth()-9,o=d.getCellNum(l),h=(l.width(),l.width()+r),f=a.eq(o-1),c=n.find("> .fixedtableHeader .table").width();if(l.width(h),f.width(h),n.find(".table").width(c+r),n.find(".resizeMarker, .resizeProxy").hide(),c+r+i.SCROLLW<e.options.newWidth)n.find(".fixedtableScroller").width(c+r+i.SCROLLW);else{var h=n.closest(".bjui-resizeGrid").innerWidth();c+r+i.SCROLLW<h&&(h=c+r+i.SCROLLW),n.find(".fixedtableHeader").width(h-i.SCROLLW),n.find(".fixedtableScroller").width(h),n.width(h)}n.data("resizeGrid",!0)}}),n.find("> .resizeMarker").show().css({left:d.getLeft(l)+r+n.position().left,top:n.position().top,height:n.height()})}):o.css("cursor","default").off("mousedown.bjui.tablefixed.resize"),!1})})},i.prototype.setOrderBy=function(e){var i=this.$element,n=i.find(".fixedtableCol"),s=t(FRAG.orderby.replace("#asc#",BJUI.regional.orderby.asc).replace("#desc#",BJUI.regional.orderby.desc));e=e||this.options,i.addClass("orderby"),e.orderDirection&&(BJUI.ui.clientPaging||i.addClass(e.orderDirection),i.pagination("setClientOrder",{orderField:e.orderField,orderDirection:e.orderDirection})),n.length||(n=t('<div class="fixedtableCol" title="'+i.html()+'">'+i.html()+"</div>").appendTo(i.empty())),s.data("orderField",e.orderField).appendTo(n).pagination("orderBy")},i.prototype.resizeGrid=function(){var e=this,n=function(){t("div.bjui-resizeGrid").each(function(){var n,s=t(this),a=s.closest(".navtabPage"),d=s.width(),r=s.height(),o=s.find(".bjui-tablefixed"),h=o.find(".fixedtableThead").height(),l=e.options.newWidth;s.length&&s.is(":hidden")&&(s.hasClass("tab-pane")||(a.show(),d=s.innerWidth(),r=s.height(),h=o.find(".fixedtableHeader").height(),a.hide())),d&&s.find(".bjui-tablefixed").each(function(){var e=t(this);n=e.data("resizeGrid")?l:d,e.width(n),e.find(".table").width(n-i.SCROLLW),e.find(".fixedtableHeader").width(n-i.SCROLLW),e.find(".fixedtableScroller").width(n)}),s.css("overflow","hidden"),o.height(r).find(".fixedtableScroller").height(r-h)})};t(window).on(BJUI.eventType.resizeGrid,n)};var n=t.fn.tablefixed;t.fn.tablefixed=e,t.fn.tablefixed.Constructor=i,t.fn.tablefixed.noConflict=function(){return t.fn.tablefixed=n,this},t(document).on(BJUI.eventType.initUI,function(i){var n=t(i.target).find('table[data-toggle="tablefixed"]');n.length&&e.call(n)}),t(document).on(BJUI.eventType.afterInitUI,function(i){var n=t(i.target).find("th[data-order-field]");n.length&&e.call(n,"setOrderBy")}),t(document).on("click.bjui.tr.data-api","tr[data-id]",function(e){var i=t(this),n=i.closest("table"),s=n.data("selectedMulti"),a=i.attr("data-id"),d="selected",r=n.closest(".unitBox").find("#bjui-selected");i.toggleClass(d),s?(a=[],i.siblings("."+d).add(i.hasClass(d)?i:"").each(function(){a.push(t(this).attr("data-id"))}),a=a.join(",")):(i.siblings().removeClass(d),i.hasClass(d)||(a="")),r&&r.length?r.val(a):(r=t('<input type="hidden" id="bjui-selected" value="'+a+'">'),r.appendTo(n.closest(".unitBox")));var o=n.data("onClick");o&&"string"==typeof o&&(o=o.toFunc())(this)})}(jQuery);
+function(t){"use strict";function a(a){var i=arguments,n=a;return this.each(function(){var d=t(this),o=t.extend({},e.DEFAULTS,d.data(),"object"==typeof a&&a),l=d.data("bjui.tabledit");l||d.data("bjui.tabledit",l=new e(this,o)),"string"==typeof n&&t.isFunction(l[n])?([].shift.apply(i),i?l[n].apply(l,i):l[n]()):l.init()})}var e=function(a,e){this.$element=t(a),this.options=e,this.tools=this.TOOLS(),this.$tbody=this.$element.find("> tbody"),this.$tbody.length||(this.$tbody=t("<tbody></tbody>"),this.$element.append(this.$tbody)),this.$numAdd=this.$btnAdd=null};e.DEFAULTS={singleNoindex:!0},e.EVENTS={afterDelete:"afterdelete.bjui.tabledit"},e.prototype.TOOLS=function(){var a=this,i={initSuffix:function(a){var e=a.find("> tr");e.each(function(a){var e=t(this);e.find(":input, :file, a, label, div").each(function(){var e=t(this),i=e.attr("name"),n=e.val(),d=e.attr("for"),o=e.attr("id"),l=e.attr("href"),r=e.attr("data-group"),s=e.attr("data-suffix");if(i&&e.attr("name",i.replaceSuffix(a)),d&&e.attr("for",d.replaceSuffix(a)),o&&e.attr("id",o.replaceSuffix(a).replaceSuffix2(a)),l&&e.attr("href",l.replaceSuffix(a)),r&&e.attr("data-group",r.replaceSuffix(a)),s&&e.attr("data-suffix",s.replaceSuffix(a)),n&&n.indexOf("#index#")>=0&&e.val(n.replace("#index#",a+1)),e.hasClass("no")){var f=e.data("prefix")?e.data("prefix"):"";e.val(f+(a+1))}})})},initEnter:function(a){var e=a.find(":text");e.each(function(a){t(this).bind("keydown",function(t){if(t.which==BJUI.keyCode.ENTER){var i=a+1;e.eq(i)&&e.eq(i).focus(),t.preventDefault()}})}),this.initInput(a)},initInput:function(a){a.find("> tr > td").each(function(){var a=t(this).find(".input-hold");a.length||(a=t('<span class="input-hold" style="display:block; padding:0 4px; height:0px; font-size:12px; visibility:hidden;"></span>'),t(this).append(a)),t.support.leadingWhitespace?t(this).on("input",":text",function(e){a.text(t(this).val())}):t(this).on("propertychange",":text",function(e){a.text(t(this).val())})})},initTbody:function(){function e(a){a.removeClass("readonly").find("> td *").each(function(){var a=t(this),e=a.closest("td"),i=e.data("val"),n=a.attr("data-toggle-old"),d=e.data("readonly");if("undefined"==typeof i&&(i=e.html()),e.data("notread"))return!0;if(a.isTag("select")&&a.val(e.attr("data-val")).selectpicker("refresh").nextAll(".bootstrap-select").removeClass("readonly").find("button").removeClass("disabled"),a.is(":checkbox")&&(a.closest(".icheckbox_minimal-purple").removeClass("disabled"),a.closest(".icheckbox_minimal-purple").find("ins").removeClass("readonly")),a.is(":radio")&&(a.closest(".iradio_minimal-purple").removeClass("disabled"),a.closest(".iradio_minimal-purple").find("ins").removeClass("readonly")),n){if("dosave"==n)return!0;a.removeAttr("data-toggle-old").attr("data-toggle",n),"spinner"==n&&a.spinner("destroy").spinner(),"kindeditor"==n&&e.initui()}(a.is(":text")||a.is("textarea"))&&(a.off("keydown.readonly"),d&&a.prop("readonly",!0)),a.find(".bjui-lookup, .bjui-spinner, .bjui-upload").show()}),a.find('[data-toggle="doedit"]').attr("data-toggle","dosave").text("完成")}function i(a){a.addClass("readonly").find("> td *").each(function(){var a=t(this),e=a.closest("td"),i=a.attr("data-toggle");if(e.data("notread"))return!0;if(a.isTag("select")&&a.nextAll(".bootstrap-select").addClass("readonly").find("button").addClass("disabled"),a.is(":checkbox")&&(a.closest(".icheckbox_minimal-purple").addClass("disabled"),a.closest(".icheckbox_minimal-purple").find("ins").addClass("readonly")),a.is(":radio")&&(a.closest(".iradio_minimal-purple").addClass("disabled"),a.closest(".iradio_minimal-purple").find("ins").addClass("readonly")),i){if("doedit"==i||"dosave"==i)return!0;a.removeAttr("data-toggle").attr("data-toggle-old",i),"kindeditor"==i&&KindEditor.remove(a)}(a.is(":text")||a.is("textarea"))&&a.on("keydown.readonly",function(t){t.preventDefault()}),a.find(".bjui-lookup, .bjui-spinner, .bjui-upload").hide()}),a.find('[data-toggle="dosave"]').attr("data-toggle","doedit").text("编辑")}var n=a.$element,d=a.$tbody;d.find("> tr").each(function(){var o=t(this),l=o.find("> td"),r=n.data("bjui.tabledit.tr").clone().find("> th");o.data("bjui.tabledit.oldTds",o.html()),r.each(function(a){var e=l.eq(a),i=e.data("val"),n=t(this),d=n.children(),o=n.find(".pic-box");"undefined"==typeof i&&(i=e.html()),e.data("noedit")||d.length&&(d.is("input:checkbox")||d.is("input:radio")?d.filter('[value="'+i+'"]').attr("checked","checked"):d.isTag("select")?d.find('option[value="'+e.data("val")+'"]').attr("selected","selected"):o.length?(e.data("val")&&n.find(".pic-name").val(e.data("val")),o.html(e.html())):d.hasClass("wrap_bjui_btn_box")?d.find("input[data-toggle]").attr("value",i+""):d.is("textarea")?(d.html(i),"kindeditor"==d.attr("data-toggle")&&d.attr("data-toggle-old","kindeditor").removeAttr("data-toggle")):d.attr("value",i+""),e.html(n.html()))}),o.on("dblclick",t.proxy(function(t){e(o)},a)).initui(),a.tools.initSuffix(d),i(o)}),d.on("click.bjui.tabledit.readonly",'[data-toggle="doedit"]',function(a){e(t(this).closest("tr"))}).on("click.bjui.tabledit.readonly",'[data-toggle="dosave"]',function(e){var d=t(this).closest("tr"),o=d.index(),l=a.options.callback;if(a.options.action){if(d.wrap('<form action="" method="POST"></form>'),d.attr("data-id")){var r=n.find("> thead > tr:eq(0)").data("idname")||"id";d.before('<input type="hidden" name="'+r.replaceSuffix(o)+'" value="'+d.attr("data-id")+'">')}var s=d.parent().serializeArray();a.options.singleNoindex&&t.each(s,function(a,e){t.extend(e,{name:e.name.replaceSuffix(0)})}),d.prev("input").remove(),d.unwrap().isValid(function(t){t&&(l=l?l.toFunc():function(t){t[BJUI.keys.statusCode]==BJUI.statusCode.ok?i(d):d.bjuiajax("ajaxDone",t)},d.bjuiajax("doAjax",{url:a.options.action,data:s,type:a.options.type||"POST",callback:l}))})}else i(d)}),a.tools.initEnter(d)},doAdd:function(){var t=a.$element;a.$numAdd&&a.$btnAdd&&t.on("keydown.bjui.tabledit.add","thead .num-add",function(t){t.which==BJUI.keyCode.ENTER&&(a.$btnAdd.trigger("click.bjui.tabledit.add"),t.preventDefault())}).on("click.bjui.tabledit.add","thead .row-add",function(e){var i=1;isNaN(a.$numAdd.val())||(i=parseInt(a.$numAdd.val())),a.add(t,i),e.preventDefault()})},doDel:function(a){var e=this,i="click.bjui.tabledit.del";a.off(i).on(i,".row-del",function(a){var i=t(this);i.data("confirmMsg")?i.alertmsg("confirm",i.data("confirmMsg"),{okCall:function(){e.delData(i)}}):e.delData(i),a.preventDefault()})},delData:function(t){var e=this,i=t.closest("tbody"),n=t.data(),d=function(d){t.closest("tr").remove(),e.initSuffix(i),e.afterDelete(i),n.callback&&n.callback.toFunc().apply(a,[d])};t.is("[href^=javascript:]")||t.is('[href^="#"]')?d():t.bjuiajax("doAjax",{url:t.attr("href"),data:n.data,callback:d})},afterDelete:function(i){var n=t.Event(e.EVENTS.afterDelete,{relatedTarget:i[0]});a.$element.trigger(n),n.isDefaultPrevented()}};return i},e.prototype.init=function(){var a=this,e=this.tools,i=this.$element.addClass("bjui-tabledit"),n=i.find("> thead > tr:first"),d=this.$tbody,o=i.find("> thead > tr:first").html();n.find("> th").each(function(){var e=t(this),i=e.attr("title"),n=e.data("addtool");if(i&&e.html(i),n){var d=t('<span style="position:relative;"></span>');e.empty(),a.$numAdd=t('<input type="text" value="1" class="form-control num-add" size="2" title="待添加的行数">'),a.$btnAdd=t('<a href="javascript:;" class="row-add" title="添加行"><i class="fa fa-plus-square"></i></a>'),d.append(a.$numAdd).append(a.$btnAdd).appendTo(e)}}),i.data("bjui.tabledit.tr",t("<tr>"+o+"</tr>")),e.initTbody(),e.doAdd(),e.doDel(d)},e.prototype.add=function(a,e){for(var i,n=this.tools,d=a.find("> tbody"),o=a.data("bjui.tabledit.tr"),l=0;e>l;l++){o.find("> th").each(function(){t(this).replaceWith("<td>"+t(this).html()+"</td>")});var r=o.clone();0==l&&(i=r),r.hide().appendTo(d),n.initSuffix(d),n.initEnter(d),r.show().css("display","").initui()}if(i&&i.length){var s=i.find(":text");s.each(function(){var a=t(this);return a.prop("readonly")?void 0:(a.focus(),!1)})}};var i=t.fn.tabledit;t.fn.tabledit=a,t.fn.tabledit.Constructor=e,t.fn.tabledit.noConflict=function(){return t.fn.tabledit=i,this},t(document).on(BJUI.eventType.initUI,function(e){var i=t(e.target).find('table[data-toggle="tabledit"]');i.length&&a.call(i)}),t(document).on(BJUI.eventType.afterInitUI,function(e){var i=t(e.target).find('table[data-toggle="tabledit"]');i.each(function(){if(t(this).is("[data-initnum]")){var e=t(this).data("initnum");e>0&&a.call(t(this),"add",t(this),e)}})}),t(document).on("click.bjui.tabledit.data-api",'[data-toggle="tableditadd"]',function(e){var i=t(this),n=i.data("num")||1,d=i.data("target");d&&t(d).length&&t(d).isTag("table")&&(a.call(i,"add",t(d),n),e.preventDefault())})}(jQuery);
+function(n){"use strict";function t(t){var e=arguments,s=t;return this.each(function(){var a=n(this),o=n.extend({},i.DEFAULTS,a.data(),"object"==typeof t&&t),r=a.data("bjui.spinner");r||a.data("bjui.spinner",r=new i(this,o)),"string"==typeof s&&n.isFunction(r[s])?([].shift.apply(e),e?r[s].apply(r,e):r[s]()):r.init()})}var i=function(t,i){this.$element=n(t),this.options=i,this.tools=this.TOOLS(),this.$spinner=null,this.height=this.$element.addClass("form-control").innerHeight(),this.ivalue=Number(this.$element.val())||0};i.DEFAULTS={min:0,max:100,step:1,decimalPlace:0},i.EVENTS={afterChange:"afterchange.bjui.spinner"},i.prototype.TOOLS=function(){var n=this,t={changeVal:function(t){var e=n.$element,s=Number(e.val())||Number(n.ivalue),a=t.data("add")||-1,o=n.options.min,r=n.options.max,p=n.options.step;1==a?r-p>=s&&(s+=p):-1==a?s>=o+p&&(s-=p):s>r?s=r:o>s&&(s=o),n.options.decimalPlace&&(s=new String(s.toFixed(n.options.decimalPlace))),n.ivalue=s,e.val(s).trigger(i.EVENTS.afterChange,{value:s})}};return t},i.prototype.init=function(){this.$element,this.options;return isNaN(this.options.min)||isNaN(this.options.max)||isNaN(this.options.step)?void BJUI.debug("Spinner Plugin: Parameter is non-numeric type!"):void this.addBtn()},i.prototype.addBtn=function(){var t=this,i=t.$element;if(!this.$lookBtn&&!i.parent().hasClass("wrap_bjui_btn_box")){this.$spinner=n(FRAG.spinnerBtn),i.css({paddingRight:"13px"}).wrap('<span class="wrap_bjui_btn_box"></span>');var e=i.parent();e.css("position","relative"),this.$spinner.css({height:this.height}).appendTo(e),this.$spinner.on("selectstart",function(){return!1});var s=null;t.$spinner.find("li").on("click",function(i){t.tools.changeVal(n(this))}).on("mousedown",function(){var i=n(this);s=setInterval(function(){t.tools.changeVal(i)},150)}).on("mouseup",function(){clearTimeout(s)})}},i.prototype.destroy=function(){this.$element.parent().hasClass("wrap_bjui_btn_box")&&(this.$element.parent().find(".bjui-spinner").remove(),this.$element.unwrap())};var e=n.fn.spinner;n.fn.spinner=t,n.fn.spinner.Constructor=i,n.fn.spinner.noConflict=function(){return n.fn.spinner=e,this},n(document).on(BJUI.eventType.initUI,function(i){var e=n(i.target).find('input[data-toggle="spinner"]');e.length&&t.call(e)})}(jQuery);
+function(t){"use strict";function e(e){var n=arguments,o=e;return this.each(function(){var i=t(this),a=t.extend({},l.DEFAULTS,i.data(),"object"==typeof e&&e),r=i.data("bjui.lookup");r?i.data("newurl")&&(r.options.url=i.data("newurl"),i.data("bjui.dialog",null)):i.data("bjui.lookup",r=new l(this,a)),"string"==typeof o&&t.isFunction(r[o])?([].shift.apply(n),n?r[o].apply(r,n):r[o]()):r.init()})}var n,o,i,l=function(e,n){this.$element=t(e),this.options=n,this.$lookBtn=null};l.DEFAULTS={url:null,id:null,mask:!0,width:600,height:400,title:"Lookup",maxable:!0,resizable:!0},l.EVENTS={afterChange:"afterchange.bjui.lookup"},l.prototype.init=function(){{var t=this,e=this.options;this.tools}return e.url?(e.url=decodeURI(e.url).replacePlh(t.$element.closest(".unitBox")),e.url.isFinishedTm()?(e.url=encodeURI(e.url),n=this.options.group||null,o=this.options.suffix||null,i=this.$element,o&&(o=o.trim()),void this.open(t.$element)):(t.$element.alertmsg("error",e.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),BJUI.debug("Lookup Plugin: The lookup's url is incorrect, url:"+e.url),!1)):(BJUI.debug("Lookup Plugin: Error trying open a lookup dialog, url is undefined!"),!1)},l.prototype.addBtn=function(){var e=this,n=e.$element;if(!this.$lookBtn&&!n.parent().hasClass("wrap_bjui_btn_box")){this.$lookBtn=t(FRAG.lookupBtn),this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box"></span>');var o=this.$element.parent(),i=this.$element.addClass("form-control").innerHeight();o.css({position:"relative",display:"inline-block"}),t.each(e.options,function(t,n){"toggle"!=t&&e.$lookBtn.data(t,n)}),this.$lookBtn.css({height:i,lineHeight:i+"px"}).appendTo(o),this.$lookBtn.on("selectstart",function(){return!1})}},l.prototype.open=function(t){var e=this.options;t.dialog({id:e.id||"lookup_dialog",url:e.url,title:e.title,width:e.width,height:e.height,mask:e.mask,maxable:e.maxable,resizable:e.resizable})},l.prototype.getField=function(t){return(n?n+".":"")+t+(o?o:"")},l.prototype.setSingle=function(t,e){"string"==typeof t&&(t=new Function("return "+t)()),this.setVal(t,e)},l.prototype.setMult=function(e,n){var o={},i=this.$element.closest(".unitBox");return i.find('[name="'+e+'"]').filter(":checked").each(function(){var e=new Function("return "+t(this).val())();for(var n in e){var i=o[n]?o[n]+",":"";o[n]=i+e[n]}}),t.isEmptyObject(o)?void this.$element.alertmsg("error",this.$element.data("warn")||FRAG.alertSelectMsg):void this.setVal(o,n)},l.prototype.setVal=function(e,n){var o,a=this,r=i.closest(".unitBox");i.data("customEvent")?i.trigger("customEvent.bjui.lookup",[e]):r.find(":input").each(function(){var i=t(this),r=i.attr("name");for(var u in e){var s=a.getField(u);if(s==r){o=1==n&&i.val()?i.val()+","+e[u]:e[u],i.val(o).trigger(l.EVENTS.afterChange,{value:e[u]});break}}}),this.$element.dialog("closeCurrent")};var a=t.fn.lookup;t.fn.lookup=e,t.fn.lookup.Constructor=l,t.fn.lookup.noConflict=function(){return t.fn.lookup=a,this},t(document).on(BJUI.eventType.initUI,function(n){var o=t(n.target).find('[data-toggle="lookup"]');o.length&&e.call(o,"addBtn")}),t(document).on("click.bjui.lookup.data-api",'[data-toggle="lookupbtn"]',function(n){var o=t(this);o.attr("href")&&!o.data("url")&&o.attr("data-url",o.attr("href")),o.data("title")||o.attr("data-title",o.text()),e.call(o),n.preventDefault()}),t(document).on("click.bjui.lookupback.data-api",'[data-toggle="lookupback"]',function(n){var o=t(this),i=o.data("args"),l=o.data("lookupid"),a=t('input[name="lookupType"]:checked').val();i?e.call(o,"setSingle",i,a):l&&e.call(o,"setMult",l,a),n.preventDefault()})}(jQuery);
+function(t){"use strict";function e(e){var a=arguments,i=e;return this.each(function(){var s=t(this),l=t.extend({},n.DEFAULTS,s.data(),"object"==typeof e&&e),o=s.data("bjui.tags");o||s.data("bjui.tags",o=new n(this,l)),"string"==typeof i&&t.isFunction(o[i])?([].shift.apply(a),a?o[i].apply(o,a):o[i]()):o.init()})}var n=function(e,n){this.$element=t(e).addClass("tag-input"),this.options=n,this.tools=this.TOOLS(),this.$box=t(this.$element.wrap('<div class="bjui-tags"></div>')).parent(),this.timeout=null,this.$tagsArr={},this.tags=[]};n.DEFAULTS={width:300,url:"",global:!1,type:"GET",tagname:"tag",max:0,clear:!1,lightCls:"tags-highlight"},n.EVENTS={afterCreated:"aftercreated.bjui.tags"},n.prototype.TOOLS=function(){var e=this,a=this.options,i={keyDown:function(t){return 13==t.which?!1:void 0},keyUp:function(n){switch(n.which){case BJUI.keyCode.BACKSPACE:if(0==t.trim(e.$element.val()).length)return e.tools.removeMenu(),!1;break;case BJUI.keyCode.ESC:e.tools.removeMenu();break;case BJUI.keyCode.DOWN:if(!e.$menu||!e.$menu.length)return;var i=e.$menu.find("> ."+a.lightCls),s=e.$menu.find("> li:first-child");if(i.length){var l=i.removeClass(a.lightCls).next();l.length?l.addClass(a.lightCls):s.addClass(a.lightCls)}else s.addClass(a.lightCls);return!1;case BJUI.keyCode.UP:if(!e.$menu||!e.$menu.length)return;var i=e.$menu.find("> ."+a.lightCls),o=e.$menu.find("> li:last-child");if(i.length){var r=i.removeClass(a.lightCls).prev();r.length?r.addClass(a.lightCls):o.addClass(a.lightCls)}else o.addClass(a.lightCls);return!1;case BJUI.keyCode.ENTER:if(a.max>0&&e.$tagsArr.length>=a.max)return!1;var u=!1,g=!1,h=null,d=e.$menu&&e.$menu.find("> ."+a.lightCls);if(d&&d.length)u=d.text(),h=d.data("item"),g=h.value;else{if(u=t.trim(e.$element.val()),!u.length)return!1;if(a.clear&&-1==t.inArray(u,e.tags))return e.$element.val(""),!1;g=u}if(!u)return;var c=!1;return e.$tagsArr.length&&e.$tagsArr.each(function(){return t(this).val()==g?void(c=!0):void 0}),c?(e.$element.val(""),!1):(e.tools.createTag(u,g),e.tools.removeMenu(),e.$element.val(""),t.proxy(e.tools.onAfterCreated(h,g),e),!1)}},query:function(){e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(e.tools.doQuery,300)},doQuery:function(){if(!(a.max>0&&e.$tagsArr.length>=a.max)){var n=e.$element.val(),i=e.$box.find("> .tags-menu"),s=[],l=null,o=e.$element.closest(".navtab-panel").length?t.CurrentNavtab:t.CurrentDialog;e.$element.closest(".bjui-layout").length&&(o=e.$element.closest(".bjui-layout")),0!=n.length&&(e.$element.one("ajaxStart",function(){o.trigger("bjui.ajaxStart")}).one("ajaxStop",function(){o.trigger("bjui.ajaxStop")}),t.ajax({url:a.url,global:a.global,type:a.type,data:{term:n},dataType:"json",success:function(n){if(0!=n.length){i.length||(i=t('<ul class="tags-menu"></ul>')),i.empty().hide().appendTo(e.$box);for(var o=0;o<n.length;o++)l=t('<li class="tags-item">'+n[o].label+"</li>").data("item",n[o]),l.appendTo(i),s.push(n[o].label);e.tags=s,i.css({top:e.$element.position().top+e.$element.outerHeight(),left:e.$element.position().left}).fadeIn().find("> li").hover(function(){t(this).addClass(a.lightCls).siblings().removeClass(a.lightCls)},function(){t(this).removeClass(a.lightCls)}).click(function(){var n=t(this).text(),a=t(this).data("item"),s=a.value,l=!1;return e.$box.find("input:hidden").each(function(){return t(this).val()==s?void(l=!0):void 0}),l?(e.$element.val(""),void i.remove()):(t.proxy(e.tools.createTag(n,s),e),i.remove(),e.$element.val(""),void t.proxy(e.tools.onAfterCreated(a,s),e))}),e.$menu=i}}}))}},createTag:function(n,a){var i=t('<span class="label label-tag" data-value="'+a+'" style="margin-left: 1px; margin-top: 1px;"><i class="fa fa-tag"></i> '+n+'&nbsp;&nbsp;<a href="#" class="close">&times;</a></span>');i.insertBefore(e.$element).find("a.close").click(function(){var n=i.data("value");e.$box.find("input:hidden").each(function(){t(this).val()==n&&t(this).remove()}),i.remove(),e.$tagsArr=e.$box.find('input[name="'+e.options.tagname+'"]')});var s=t('<input type="hidden" name="'+e.options.tagname+'">').val(a);s.appendTo(e.$box),e.$tagsArr=e.$box.find('input[name="'+e.options.tagname+'"]')},removeMenu:function(){e.$menu&&e.$menu.remove()},onAfterCreated:function(a,i){var s=[];e.$tagsArr.length&&e.$tagsArr.each(function(){s.push(t(this).val())}),e.$element.trigger(n.EVENTS.afterCreated,{item:a,value:i,tags:s.join(",")})}};return i},n.prototype.init=function(){var e=this,n=this.$element,a=this.options;return a.url?(a.url=decodeURI(a.url).replacePlh(n.closest(".unitBox")),a.url.isFinishedTm()?(a.url=encodeURI(a.url),isNaN(this.options.max)?void BJUI.debug("Tags Plugin: Parameter 'max' is non-numeric type!"):(e.$box.width(a.width).on("click",function(){n.focus()}),n.on("keydown",t.proxy(this.tools.keyDown,this)).on("keyup",t.proxy(this.tools.keyUp,this)),t.support.leadingWhitespace?n.on("input",t.proxy(this.tools.query,this)):n.on("propertychange",t.proxy(this.tools.query,this)),void t(document).on("click.bjui.tags",t.proxy(function(e){t(e.target).closest(this.$box).length||this.tools.removeMenu()},this)))):(n.alertmsg("error",a.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("Tags Plugin: The query tags url is incorrect, url: "+a.url))):void BJUI.debug("Tags Plugin: Do query tags, url is undefined!")},n.prototype.destroy=function(){this.$tags&&(this.$element.upwrap(),$tags.remove())};var a=t.fn.tags;t.fn.tags=e,t.fn.tags.Constructor=n,t.fn.tags.noConflict=function(){return t.fn.tags=a,this},t(document).on(BJUI.eventType.initUI,function(n){var a=t(n.target).find('input[data-toggle="tags"]');a.length&&e.call(a)})}(jQuery);
+function(e){"use strict";function t(t){var i=arguments,n=t;return window.FileReader?this.each(function(){var a=e(this),l=e.extend({},o.DEFAULTS,a.data(),"object"==typeof t&&t),r=a.data("bjui.upload");r||a.data("bjui.upload",r=new o(this,l)),"string"==typeof n&&e.isFunction(r[n])?([].shift.apply(i),i?r[n].apply(r,i):r[n]()):r.init()}):void this.each(function(){if(e.fn.uploadify){var t={swf:BJUI.PLUGINPATH+"uploadify/scripts/uploadify.swf",fileTypeExts:"*.jpg;*.png",id:"fileInput",fileObjName:"file",fileSizeLimit:204800,buttonText:"选择上传文件",auto:!1,multi:!1,height:24},o=e(this),i=o.data();if(i.id||(i.id=o.attr("id")),e.extend(t,i),!t.uploader)return void BJUI.debug("Upload Plugin: The options uploader is undefined!");if(t.uploader=decodeURI(t.uploader).replacePlh(o.closest(".unitBox")),!t.uploader.isFinishedTm())return o.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("Upload Plugin: The options uploader is incorrect: "+t.uploader);t.uploader=encodeURI(t.uploader),"fileInput"==t.id&&(t.id=t.id+(new Date).getTime());var n=e('<input type="file" name="'+t.name+'" id="'+t.id+'">');if(t.onInit&&"string"==typeof t.onInit&&(t.onInit=t.onInit.toFunc()),t.onCancel&&"string"==typeof t.onCancel&&(t.onCancel=t.onCancel.toFunc()),t.onSelect&&"string"==typeof t.onSelect&&(t.onSelect=t.onSelect.toFunc()),t.onUploadStart&&"string"==typeof t.onUploadStart&&(t.onUploadStart=t.onUploadStart.toFunc()),t.onUploadSuccess&&"string"==typeof t.onUploadSuccess&&(t.onUploadSuccess=t.onUploadSuccess.toFunc()),t.onUploadComplete&&"string"==typeof t.onUploadComplete&&(t.onUploadComplete=t.onUploadComplete.toFunc()),t.onUploadError&&"string"==typeof t.onUploadError&&(t.onUploadError=t.onUploadError.toFunc()),n.appendTo(o),!t.auto){var a=e('<button class="btn btn-orange" data-icon="cloud-upload">开始上传</button>');a.hide().insertAfter(o).click(function(){n.uploadify("upload","*"),e(this).hide()}),t.onSelect=function(){a.show()}}n.uploadify(t)}})}var o=function(t,o){this.$element=e(t),this.options=o,this.tools=this.TOOLS()};o.DEFAULTS={fileTypeExts:"*.jpg;*.png",uploader:"",auto:!1,method:"POST",multi:!1,formData:{},fileObjName:"file",fileSizeLimit:204800,previewImg:!0,previewLoadimg:null,dragDrop:!1,showUploadedPercent:!0,showUploadedSize:!0,buttonText:"选择上传文件",removeTimeout:1e3,itemTemplate:FRAG.uploadTemp,breakPoints:!1,fileSplitSize:1048576,onUploadStart:null,onUploadSuccess:null,onUploadComplete:null,onUploadError:null,onInit:null,onCancel:null,onSelect:null},o.MIMETYPES={zip:["application/x-zip-compressed"],jpg:["image/jpeg"],png:["image/png"],gif:["image/gif"],swf:["application/x-shockwave-flash"],doc:["application/msword"],xls:["application/vnd.ms-excel"],docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.document"],xlsx:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],ppt:["application/vnd.ms-powerpoint"],pptx:["application/vnd.openxmlformats-officedocument.presentationml.presentation"],mp3:["audio/mpeg"],mp4:["video/mp4"],pdf:["application/pdf"],txt:["text/plain"],xml:["text/xml"]},o.prototype.TOOLS=function(){var t=this,i=this.options,n={formatFileSize:function(e,t){return e=e>1048576&&!t?(Math.round(100*e/1048576)/100).toString()+"MB":(Math.round(100*e/1024)/100).toString()+"KB"},getFile:function(e,t){for(var o=0;o<t.length;o++)if(t[o].index==e)return t[o];return!1},getFileTypes:function(e){for(var t=[],o=e.split(";"),i=0;i<o.length;i++)t.push(o[i].split(".").pop());return t},getMimetype:function(e){return o.MIMETYPES[e]},getAcceptString:function(e){for(var t=this.getFileTypes(e),o=[],i=0;i<t.length;i++){var n=this.getMimetype(t[i]);o.push(n?n:"."+t[i])}return o.join(",")},filter:function(o){var n=[],a=this.getFileTypes(i.fileTypeExts);if(a.length>0)for(var l=0;l<o.length;l++){var r=o[l];parseInt(this.formatFileSize(r.size,!0))>i.fileSizeLimit?t.$element.alertmsg("error",'文件"'+r.name+'"大小超出限制！'):e.inArray(r.name.split(".").pop().toLowerCase(),a)>=0?n.push(r):t.$element.alertmsg("error",'文件"'+r.name+'"类型不允许！')}return n},getFiles:function(e){var o=e.target.files||e.dataTransfer.files;o=this.filter(o);for(var i=0;i<o.length;i++)o[i].id=o[i].lastModifiedDate.getTime()+"_"+o[i].size+"_"+(o[i].type||"").replace(/\W/g,""),this.renderQueueItem(o[i]),t.queueData.files++;return o},renderQueueItem:function(o){var n=0,a=e(i.itemTemplate.replace("{fileId}",o.id).replace("{fileName}",o.name).replace("#upConfirm#",BJUI.regional.upload.upConfirm).replace("#upPause#",BJUI.regional.upload.upPause).replace("#upCancel#",BJUI.regional.upload.upCancel).replace("{percent}","0.00%").replace("{uploadedSize}","0KB").replace("{fileSize}",this.formatFileSize(o.size)));if(i.auto&&a.find("> .info > .up_confirm").remove(),a.data("upfile",o),t.$uploadFileList.append(a),i.breakPoints&&(n=this.getUploadedSize(o.id),n>o.size&&(n=o.size)),this.showProgress(o.id,n,o.size),i.previewImg&&-1!=o.type.indexOf("image")){var l=a.find("> .preview > .img");i.previewLoadimg&&l.html('<img src="'+i.previewLoadimg+'" height="114">'),this.previewImg(o,l)}else a.find("> .preview").remove();if(i.showUploadedSize){var r=a.find("> .filesize");r.find("> .uploadedsize").html(this.formatFileSize(n)),r.find("> .filesize").html(this.formatFileSize(o.size))}else a.find("> .filesize").remove();i.showUploadedPercent?a.find("> .percent").html((n/o.size*100).toFixed(2)+"%"):a.find("> .percent").remove(),i.onSelect&&i.onSelect(files),i.auto&&t.fileUpload(o,n),a.on("click.bjui.upload.confirm",".up_confirm",function(o){var i=e(this),a=i.closest(".item");i.hide().next().show(),t.fileUpload(a.data("upfile"),n)}),a.on("click.bjui.upload.cancel",".up_cancel",this.removeQueueItem)},successQueueItem:function(o,a){n.showProgress(o.id,o.size,o.size),i.onUploadSuccess&&i.onUploadSuccess(o,a.responseText,t.$element),setTimeout(function(){t.$element.find("#"+o.id).fadeOut("normal",function(){e(this).remove();var o=t.$element.find("> .queue > .item:visible").length;0==o&&(t.$element.find("> .queue").hide(),t.$file.val(""))})},i.removeTimeout)},removeQueueItem:function(o,i){i&&i.abort(),e(this).closest(".item").fadeOut("normal",function(){e(this).remove();var o=t.$element.find("> .queue > .item:visible").length;0==o&&t.$element.find("> .queue").hide()}),o.preventDefault()},previewImg:function(e,t){if(e&&t.length){var o=new FileReader;o.onload=function(e){t.html('<img src="'+e.target.result+'">')},o.readAsDataURL(e)}},showProgress:function(e,o,i){{var n=o/i*100+"%";t.tools.formatFileSize(o),(o/i*100).toFixed(2)+"%"}t.$element.find("#"+e+" > .progress > .bar").css("width",n)},getUploadedSize:function(e){return 1*localStorage.getItem(e)},saveUploadedSize:function(e,t){localStorage.setItem(e,t)},sendBlob:function(e,t,o,n){var a=new FormData;if(t.open(i.method,e,!0),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.append(i.fileObjName,o),n)for(var l in n)a.append(l,n[l]);t.send(a)}};return n},o.prototype.init=function(){var t=this,o=this.$element,i=this.options;if(!i.uploader)return void BJUI.debug("Upload Plugin: The options uploader is undefined!");if(!o.hasClass("bjui-upload")){var n=e(FRAG.uploadFrag.replaceAll("#multi#",i.multi?"multiple":"").replaceAll("#accept#",t.tools.getAcceptString(i.fileTypeExts)).replaceAll("#btnTxt#",(i.icon?'<i class="fa fa-'+i.icon+'">&nbsp;&nbsp;':"")+i.buttonText));o.addClass("bjui-upload").append(n),this.$file=o.find("> .bjui-upload-select-file"),this.$uploadFileList=o.find("> .queue"),this.queueData={files:0,success:0,error:0},o.on("change.bjui.upload",".bjui-upload-select-file",function(e){t.fileSelect(e)}).on("click.bjui.upload",".bjui-upload-select",function(e){t.$file.trigger("click")}),i.formData&&"string"==typeof i.formData&&(i.formData=i.formData.toObj()),i.onInit&&"string"==typeof i.onInit&&(i.onInit=i.onInit.toFunc()),i.onCancel&&"string"==typeof i.onCancel&&(i.onCancel=i.onCancel.toFunc()),i.onSelect&&"string"==typeof i.onSelect&&(i.onSelect=i.onSelect.toFunc()),i.onUploadStart&&"string"==typeof i.onUploadStart&&(i.onUploadStart=i.onUploadStart.toFunc()),i.onUploadSuccess&&"string"==typeof i.onUploadSuccess&&(i.onUploadSuccess=i.onUploadSuccess.toFunc()),i.onUploadComplete&&"string"==typeof i.onUploadComplete&&(i.onUploadComplete=i.onUploadComplete.toFunc()),i.onUploadError&&"string"==typeof i.onUploadError&&(i.onUploadError=i.onUploadError.toFunc()),i.onInit&&i.onInit(),i.dragDrop&&(o[0].ondragover=function(e){return e.preventDefault(),!0},o[0].ondrop=function(e){t.fileSelect(e),e.stopPropagation(),e.preventDefault()})}},o.prototype.fileSelect=function(e){this.$uploadFileList.show(),this.tools.getFiles(e)},o.prototype.fileUpload=function(t,o){var i=this,n=i.$element,a=i.options,l=i.tools,r=!1,p=t,s=decodeURI(a.uploader).replacePlh(n.closest(".unitBox"));return s.isFinishedTm()?(s=encodeURI(s),r=new XMLHttpRequest,a.breakPoints&&(t=p.slice(o,o+a.fileSplitSize)),r.upload&&(r.upload.onprogress=function(e){i.onProgress(t,e.loaded,p.size)},r.onreadystatechange=function(e){if(4==r.readyState&&200==r.status){var n=(JSON.parse(r.responseText),!1);a.breakPoints?(o+=a.fileSplitSize,l.saveUploadedSize(p.id,o),o<p.size?(t=p.slice(o,o+a.fileSplitSize),l.sendBlob(s,r,t,a.formData)):n=!0):n=!0,n&&(i.queueData.success++,l.successQueueItem(p,r),a.onUploadComplete&&a.onUploadComplete(p,r.responseText))}else i.queueData.error++,a.onUploadError&&a.onUploadError(p,r.responseText);a.onQueueComplete&&(i.queueData.files=i.queueData.success+i.queueData.error)&&option.onQueueComplete(i.queueData)},a.onUploadStart&&a.onUploadStart(),a.formData.fileName=p.name,a.formData.lastModifiedDate=p.lastModifiedDate.getTime(),l.sendBlob(s,r,t,a.formData)),n.find("#"+p.id+" > .info > .up_pause").on("click.bjui.upload.pause",function(t){r.abort(),e(this).hide().prev().show()}),void n.find("#"+p.id+" > .info > .up_cancel").off("click.bjui.upload.cancel").on("click.bjui.upload.cancel",e.proxy(function(e){this.tools.removeQueueItem(e,r)},this))):(n.alertmsg("error",a.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("Upload Plugin: The options uploader is incorrect: "+s))},o.prototype.onProgress=function(e,t,o){var i=this,n=i.options,a=i.$element.find("#"+e.id+" .progress"),l=t,r=a.attr("lastLoaded")||0;t-=parseInt(r),t>e.size&&(t=e.size),i.$progressBar=a.children(".bar");var p=n.breakPoints?parseFloat(i.$progressBar.get(0).style.width||0):0,s=(t/o*100+p).toFixed(2),d=s>100?"100%":s+"%";if(n.showUploadedSize){var u=a.nextAll(".filesize");u.find("> .uploadedsize").text(i.tools.formatFileSize(t))}n.showUploadedPercent&&a.nextAll(".up_percent").text(d),i.$progressBar.css("width",d),l<n.fileSplitSize?a.attr("lastLoaded",l):a.removeAttr("lastLoaded")},o.prototype.destroy=function(){};var i=e.fn.upload;e.fn.upload=t,e.fn.upload.Constructor=o,e.fn.upload.noConflict=function(){return e.fn.upload=i,this},e(document).on(BJUI.eventType.initUI,function(o){var i=e(o.target).find('[data-toggle="upload"]');i.length&&t.call(i)})}(jQuery);
+function(e){"use strict";function t(t){var i=arguments,n=t;return this.each(function(){var s=e(this),a=e.extend({},o.DEFAULTS,s.data(),"object"==typeof t&&t),h=s.data("bjui.theme");h||s.data("bjui.theme",h=new o(this,a)),"string"==typeof n&&e.isFunction(h[n])?([].shift.apply(i),i?h[n].apply(h,i):h[n]()):h.init()})}var i,n;e(function(){var t=function(){if(i=e("#bjui-link-theme"),n=e("#bjui-themes"),e.cookie){var t=e.cookie("bjui_theme")||"blue",o=n.find("a.theme_"+t);o.theme({})}};t()});var o=function(t,i){this.$element=e(t),this.options=i};o.DEFAULTS={theme:"purple"},o.prototype.init=function(){if(i.length){var e=i.attr("href");e=e.substring(0,e.lastIndexOf("/")),e=e.substring(0,e.lastIndexOf("/")),e+="/"+this.options.theme+"/core.css",i.attr("href",e);var t=this.$element.closest("ul").prev(),o=t.attr("class");o=o.replace(/(theme[\s][a-z]*)/g,""),t.removeClass().addClass(o).addClass("theme").addClass(this.options.theme),n.find("li").removeClass("active"),this.$element.parent().addClass("active"),this.cookie()}},o.prototype.setTheme=function(e){n.find("a.theme_"+e).trigger("click")},o.prototype.cookie=function(){var t=this.options.theme;e.cookie&&e.cookie("bjui_theme",t,{path:"/",expires:30})};var s=e.fn.theme;e.fn.theme=t,e.fn.theme.Constructor=o,e.fn.theme.noConflict=function(){return e.fn.theme=s,this},e(document).on("click.bjui.theme.data-api",'[data-toggle="theme"]',function(i){t.call(e(this)),i.preventDefault()})}(jQuery);
+function(e){"use strict";function t(t){var i=arguments,r=t;return this.each(function(){var a=e(this),o=e.extend({},n.DEFAULTS,a.data(),"object"==typeof t&&t),s=a.data("bjui.initui");s||a.data("bjui.initui",s=new n(this,o)),"string"==typeof r&&e.isFunction(s[r])?([].shift.apply(i),i?s[r].apply(s,i):s[r]()):s.init()})}var n=function(t,n){this.$element=e(t),this.options=n};n.DEFAULTS={},n.prototype.init=function(){var t=this,n=t.$element;e.when(t.initUI()).done(function(){n.trigger(BJUI.eventType.afterInitUI)})},n.prototype.initUI=function(){var t=this.$element;e.when(t.trigger(BJUI.eventType.beforeInitUI)).done(function(){t.trigger(BJUI.eventType.initUI)})};var i=e.fn.initui;e.fn.initui=t,e.fn.initui.Constructor=n,e.fn.initui.noConflict=function(){return e.fn.initui=i,this},e(document).on("click.bjui.initui.data-api",'[data-toggle="initui"]',function(e){t.call($this,$this.data()),e.preventDefault()}),e(document).on(BJUI.eventType.beforeInitUI,function(t){var n=e(t.target),i=[],r=n.find("[data-noinit]");n.find("> .bjui-maskProgress").find(".progress").stop().animate({width:"85%"},"fast"),r.each(function(t){var n=e(this),r={};r.$target=n,r.$next=n.next(),r.$prev=n.prev(),r.$parent=n.parent(),r.visible=n.is(":visible")?!0:!1,i.push(r),n.remove()}),n.data("bjui.noinit",i)}),e(document).on(BJUI.eventType.initUI,function(t){var n=e(t.target);n.find("> .bjui-maskProgress").find(".progress").stop().animate({width:"95%"},"fast")}),e(document).on(BJUI.eventType.afterInitUI,function(t){var n=e(t.target),i=n.data("bjui.noinit"),r=n.find("> .bjui-pageContent").find("form");i&&e.each(i,function(e,t){t.$next.length?t.$next.before(t.$target):t.$prev.length?t.$prev.after(t.$target):t.$parent.length&&t.$parent.append(t.$target),t.visible&&t.$target.show(),n.removeData("bjui.noinit")}),n.resizePageH(),r.length&&n.find("> .bjui-pageFooter").find(":submit").on("click.bjui.submit",function(e){e.preventDefault(),r.submit()}),n.find(".bjui-maskProgress").find(".progress").stop().animate({width:"100%"},"fast",function(){n.find(".bjui-ajax-mask").fadeOut("normal",function(){e(this).remove()})})}),e(document).one(BJUI.eventType.afterInitUI,function(t){var n=e("#bjui-hnav-navbar"),i=n.find("> li.active");i.length&&i.find("> .items").length&&i.find("> a").trigger("click")});var r=function(t){var n=t,i=n,r=n.css("position");"static"==r&&(i=n.offsetParent());var a=parseInt(i.css("zIndex"))||0,o=n.find("> .bjui-maskBackground"),s=n.find("> .bjui-maskProgress");o.length||(o=e(FRAG.maskBackground),s=e(FRAG.maskProgress.replace("#msg#",BJUI.regional.progressmsg)),n.prepend(o).prepend(s));parseInt(o.css("zIndex"))||0,parseInt(s.css("zIndex"))||0;return o.css("zIndex",a+1),s.css("zIndex",a+2),{$bg:o,$pr:s}};e(document).on("bjui.ajaxStart",function(t,n,i){var a=r(e(t.target));a.$bg.fadeIn(),a.$pr.fadeIn(),a.$pr.find(".progress").animate({width:"80%"},n||500),i&&setTimeout(function(){i.toFunc().call(this)},25)}).on("bjui.ajaxStop",function(t){var n=r(e(t.target));n.$pr.find(".progress").animate({width:"100%"},"fast",function(){n.$bg.remove(),n.$pr.remove()})}).on("bjui.ajaxError",function(t){var n=r(e(t.target));n.$bg.remove(),n.$pr.remove()}),e(document).on(BJUI.eventType.ajaxStatus,function(t){var n=e(t.target),i=r(n);n.one("ajaxStart",function(){i.$bg.fadeIn(),i.$pr.fadeIn(),i.$pr.find(".progress").animate({width:"10%"},"fast")}).one("ajaxStop",function(){}).one("ajaxError",function(){i.$bg.remove(),i.$pr.remove()})});var a=function(e){e.find('select[data-toggle="selectpicker"]').selectpicker("destroyMenu"),e.find('[data-toggle="selectztree"]').trigger("destroy.bjui.selectztree")};e(document).on(BJUI.eventType.beforeLoadDialog,function(e){}).on(BJUI.eventType.beforeAjaxLoad,function(t){a(e(t.target))}).on(BJUI.eventType.beforeCloseNavtab,function(t){a(e(t.target))}).on(BJUI.eventType.beforeCloseDialog,function(t){a(e(t.target))}),e(function(){e(document).on("keydown keyup",function(e){e.which===BJUI.keyCode.CTRL&&(BJUI.KeyPressed.ctrl="keydown"==e.type?!0:!1),e.which===BJUI.keyCode.SHIFT&&(BJUI.KeyPressed.shift="keydown"==e.type?!0:!1)})})}(jQuery);
+function(e){"use strict";e(document).on(BJUI.eventType.initUI,function(t){var a=e(t.target),o=a.find('[data-toggle="icheck"]');o.each(function(t){var a=e(this),o=a.attr("id"),n=a.attr("name"),i=a.data("label");i&&a.after('<label for="'+o+'" class="ilabel">'+i+"</label>"),a.on("ifCreated",function(t){var a=e(this).closest("div"),i=a.next('[for="'+o+'"]');a.attr("data-icheck",n),i.attr("data-icheck",n)}).iCheck({checkboxClass:"icheckbox_minimal-purple",radioClass:"iradio_minimal-purple",increaseArea:"20%"}).on("ifChanged",function(){e(this).trigger("validate")}),a.prop("disabled")&&a.iCheck("disable")}),o.filter(".checkboxCtrl").on("ifChanged",function(t){var o=1==t.target.checked?"check":"uncheck",n=e(this).data("group");a.find(':checkbox[name="'+n+'"]').iCheck(o)}),a.find(":text, :password, textarea, :button, a.btn").each(function(){var t=e(this),a=t.closest("table.bjui-tabledit");if((t.is(":text")||t.is(":password")||t.isTag("textarea"))&&!t.hasClass("form-control")&&t.addClass("form-control"),t.is(":button")){var o=t.data("icon"),n=(t.data("large"),t.attr("class"));if(t.hasClass("btn")||t.removeClass().addClass("btn").addClass(n),o){var i="fa-"+o.replace("fa-","");t.data("bjui.icon")||t.html('<i class="fa '+i+'"></i> '+t.html()).data("bjui.icon",!0)}}if(t.isTag("a")){{var o=t.data("icon");t.data("large")}if(o){var i="fa-"+o.replace("fa-","");t.data("bjui.icon")||t.html('<i class="fa '+i+'"></i> '+t.html()).data("bjui.icon",!0)}}if(t.isTag("textarea")){var r=t.data("toggle");r&&"autoheight"==r&&e.fn.autosize&&t.addClass("autosize").autosize()}if(!a.length){var d=t.attr("size")||t.attr("cols"),l=10*d;if(!d)return;l&&t.css("width",l)}}),a.find('form[data-toggle="validate"]').each(function(){var t=e(this),a="undefined"==typeof t.data("alertmsg")?!0:t.data("alertmsg");e(this).validator({valid:function(t){e(t).bjuiajax("ajaxForm",e(t).data())},validClass:"ok",theme:"red_right_effect"}).on("invalid.form",function(t,o,n){a&&e(o).alertmsg("error",FRAG.validateErrorMsg.replace("#validatemsg#",BJUI.regional.validatemsg).replaceMsg(n.length))})}),a.find('[data-toggle="moresearch"]').each(function(){var t=e(this),a=t.closest(".bjui-pageHeader"),o=a&&a.find(".bjui-moreSearch"),n=t.data("name");t.attr("title")||t.attr("title","更多查询条件"),t.click(function(i){return o.length?(o.css("top",a.outerHeight()-1),o.is(":visible")?(t.html('<i class="fa fa-angle-double-down"></i>'),n&&e("body").data("moresearch."+n,!1)):(t.html('<i class="fa fa-angle-double-up"></i>'),n&&e("body").data("moresearch."+n,!0)),o.fadeToggle("slow","linear"),void i.preventDefault()):void BJUI.debug("Not created 'moresearch' box[class=\"bjui-moreSearch\"]!")}),n&&e("body").data("moresearch."+n)&&(o.css("top",a.outerHeight()-1).fadeIn(),t.html('<i class="fa fa-angle-double-up"></i>'))});var n=a.find('select[data-toggle="selectpicker"]'),i=function(t,a){var o=t.data("refurl"),n=function(t){var a=e(t.data("nextselect"));if(a&&a.length){var o=a.data("emptytxt")||"&nbsp;";a.html("<option>"+o+"</option>").selectpicker("refresh"),n(a)}};if(a&&a.length&&o){var i=t.data("val"),r=a.data("val");"undefined"==typeof i&&(i=t.val()),e.ajax({type:"POST",dataType:"json",url:o.replace("{value}",encodeURIComponent(i)),cache:!1,data:{},success:function(o){if(o){var i="",d="";e.each(o,function(e){var t,a;o[e]&&o[e].length?(t=o[e][0],a=o[e][1]):(t=o[e].value,a=o[e].label),"undefined"!=typeof r&&(d=t==r?" selected":""),i+='<option value="'+t+'"'+d+">"+a+"</option>"}),t.removeAttr("data-val").removeData("val"),a.removeAttr("data-val").removeData("val"),i||(i=a.data("emptytxt")||"&nbsp;",i="<option>"+i+"</option>"),a.html(i).selectpicker("refresh"),n(a)}},error:BJUI.ajaxError})}};n.each(function(){var t=e(this),a=t.data(),o=e(a.nextselect);t.addClass("show-tick"),a.style||t.data("style","btn-default"),a.width||t.data("width","auto"),a.container?1==a.container&&t.attr("data-container","false").data("container",!1):t.data("container","body"),t.selectpicker(),o&&o.length&&"undefined"!=typeof o.data("val")&&i(t,o)}),n.change(function(){var t=e(this),a=e(t.data("nextselect"));i(t,a),t.attr("aria-required")&&t.trigger("validate")}),a.find('[data-toggle="ztree"]').each(function(){function t(t,a,o){if(o.faicon){var n=e("#"+o.tId+"_a");if(!n.data("faicon")){var i;o.faicon.startsWith("icon-")?(o.faicon=o.faicon.substr(5),i='<i class="icon iconfont icon-'+o.faicon+'"></i>'):(o.faicon.startsWith("fa-")&&(o.faicon=o.faicon.substr(3)),i='<i class="fa fa-'+o.faicon+'"></i>'),n.data("faicon",!0).addClass("faicon").find("> span.button").append(i)}}s.onNodeCreated&&s.onNodeCreated.toFunc().call(this,t,a,o)}function a(t,a,o){o.faiconClose&&e("#"+o.tId+"_ico").find("> i").attr("class","fa fa-"+o.faiconClose),s.onCollapse&&s.onCollapse.toFunc().call(this,t,a,o)}function o(t,a,o){o.faicon&&o.faiconClose&&e("#"+o.tId+"_ico").find("> i").attr("class","fa fa-"+o.faicon),s.onExpand&&s.onExpand.toFunc().call(this,t,a,o)}function n(t,a){var o=a.level,n=e("#"+a.tId+u),i=e("#diyBtn_add_"+a.id),r=e("#diyBtn_del_"+a.id);if(i.length||o<s.maxAddLevel&&(i=e('<span class="tree_add" id="diyBtn_add_'+a.id+'" title="添加"></span>'),i.appendTo(n),i.on("click",function(){g.addNodes(a,{name:"新增Item"})})),!r.length){var r=e('<span class="tree_del" id="diyBtn_del_'+a.id+'" title="删除"></span>');r.appendTo(n).on("click",function(e){var o=function(){r.alertmsg("confirm","确认要删除 "+a.name+" 吗？",{okCall:function(){if(g.removeNode(a),s.onRemove){var o=s.onRemove.toFunc();o&&o.call(this,e,t,a)}},cancelCall:function(){}})};if(s.beforeRemove){var n=s.beforeRemove.toFunc();if(n){var i=n.call(n,t,a);i&&1==i&&o()}}else o()})}}function i(t,a){var o=e("#diyBtn_add_"+a.id),n=e("#diyBtn_del_"+a.id);o&&o.length&&o.off("click").remove(),n&&n.length&&n.off("click").remove()}function r(e,t){for(var a=0;a<t.length;a++)if(t[a].drag===!1)return!1;return!0}function d(e,t,a,o){return a?a.drop!==!1:!0}var l,c=e(this),s=c.data(),f=s.options;f&&"string"==typeof f&&(f=f.toObj()),f&&e.extend(s,"object"==typeof f&&f),l=s.setting,s.nodes?("string"==typeof s.nodes&&(s.nodes=s.nodes.trim().startsWith("[")||s.nodes.trim().startsWith("{")?s.nodes.toObj():s.nodes.toFunc()),"function"==typeof s.nodes&&(s.nodes=s.nodes.call(this)),c.removeAttr("data-nodes")):(s.nodes=[],c.find("> li").each(function(){var t=e(this),a=t.data();a.pid&&(a.pId=a.pid),a.name=t.html(),s.nodes.push(a)}),c.empty()),s.showRemoveBtn||(s.showRemoveBtn=!1),s.showRenameBtn||(s.showRenameBtn=!1),s.addHoverDom&&"function"!=typeof s.addHoverDom&&(s.addHoverDom="edit"==s.addHoverDom?n:s.addHoverDom.toFunc()),s.removeHoverDom&&"function"!=typeof s.removeHoverDom&&(s.removeHoverDom="edit"==s.removeHoverDom?i:s.removeHoverDom.toFunc()),s.maxAddLevel||(s.maxAddLevel=2);var h={view:{addHoverDom:s.addHoverDom||null,removeHoverDom:s.removeHoverDom||null,addDiyDom:s.addDiyDom?s.addDiyDom.toFunc():null},edit:{enable:s.editEnable,showRemoveBtn:s.showRemoveBtn,showRenameBtn:s.showRenameBtn},check:{enable:s.checkEnable,chkStyle:s.chkStyle,radioType:s.radioType},callback:{onClick:s.onClick?s.onClick.toFunc():null,beforeDrag:s.beforeDrag?s.beforeDrag.toFunc():r,beforeDrop:s.beforeDrop?s.beforeDrop.toFunc():d,onDrop:s.onDrop?s.onDrop.toFunc():null,onCheck:s.onCheck?s.onCheck.toFunc():null,beforeRemove:s.beforeRemove?s.beforeRemove.toFunc():null,onRemove:s.onRemove?s.onRemove.toFunc():null,onNodeCreated:t,onCollapse:a,onExpand:o},data:{simpleData:{enable:s.simpleData||!0},key:{title:s.title||""}}};l&&"string"==typeof l&&(l=l.toObj()),l&&e.extend(!0,h,"object"==typeof l&&l),e.fn.zTree.init(c,h,s.nodes);var u="_a",g=e.fn.zTree.getZTreeObj(c.attr("id"));s.expandAll&&g.expandAll(!0)});var r=a.find('[data-toggle="selectztree"]');r.each(function(){var t=e(this),a=t.data(),o=e(a.tree),n=(parseFloat(t.css("width")),t.outerHeight());if(a.width=a.width||t.outerWidth(),a.height=a.height||"auto",o&&o.length){var i=o.attr("id"),r=e("#"+i+"_select_box"),d=function(i){var r=t.offset().top,d=t.offset().left,l=o.clone().appendTo(e("body")),c=l.outerHeight();l.remove();var s=e(window).height()-c-r-n,f=e(window).height()-r-n;"auto"==a.height&&0>s&&(f+=s),i.css({top:r+n,left:d,"max-height":f})};t.click(function(){if(r&&r.length)return d(r),void r.show();var n=2,l=e.CurrentDialog;l&&l.length&&(n=l.css("zIndex")+1),r=e('<div id="'+i+'_select_box" class="tree-box"></div>').css({position:"absolute",zIndex:n,"min-width":a.width,height:a.height,overflow:"auto",background:"#FAFAFA",border:"1px #EEE solid"}).hide().appendTo(e("body")),o.appendTo(r).css("width","100%").data("fromObj",t).removeClass("hide").show(),d(r),r.show()}),e("body").on("mousedown",function(a){var o=e(a.target);t[0]==a.target||r&&r.length>0&&o.closest(".tree-box").length>0||r.hide()});var l=t.closest(".bjui-pageContent");l&&l.length&&l.scroll(function(){r&&r.length&&d(r)}),t.on("destroy.bjui.selectztree",function(){r.remove()})}}),a.find('[data-toggle="accordion"]').each(function(){var t=e(this),a=t.data("heightbox"),o=t.data("height"),n=function(a,o){var n=t.data("offsety")||0,o=o||e(a).outerHeight()-1*n,i=t.find(".panel-heading"),r=i.outerHeight();r=(r+1)*i.length,t.css("height",o),o-=r,t.find(".panel-collapse").find(".panel-body").css("height",o)};t.find("> .panel").length&&(a||o)&&(n(a,o),e(window).resize(function(){n(a,o)}),t.on("hidden.bs.collapse",function(t){var a=e(this).find("> .panel:last"),o=a.find("> .panel-heading > h4 > a");o.hasClass("collapsed")&&a.css("border-bottom","1px #ddd solid")}))}),a.find('[data-toggle="kindeditor"]').each(function(){var t=e(this),a=t.data();a.items&&"string"==typeof a.items&&(a.items=a.items.replaceAll("'","").replaceAll(" ","").split(",")),a.afterUpload&&(a.afterUpload=a.afterUpload.toFunc()),a.afterSelectFile&&(a.afterSelectFile=a.afterSelectFile.toFunc()),a.confirmSelect&&(a.confirmSelect=a.confirmSelect.toFunc());var o={font:[],span:[".color",".background-color",".font-size",".font-family"],div:[".margin",".padding",".text-align"],table:["align","width"],"td,th":["align","valign","width","height","colspan","rowspan"],a:["href","target","name"],embed:["src","width","height","type","loop","autostart","quality",".width",".height","align","allowscriptaccess"],img:["class","src","width","height","border","alt","title","align",".width",".height",".border"],"p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":["class","align",".text-align",".color",".font-weight",".font-style",".text-decoration",".vertical-align",".text-indent",".margin-left"],pre:["class"],hr:["class",".page-break-after"],"br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del":[]};KindEditor.create(t,{pasteType:a.pasteType,minHeight:a.minHeight||260,autoHeightMode:a.autoHeight||!1,items:a.items||KindEditor.options.items,uploadJson:a.uploadJson,fileManagerJson:a.fileManagerJson,allowFileManager:a.allowFileManager||!0,fillDescAfterUploadImage:a.fillDescAfterUploadImage||!0,afterUpload:a.afterUpload,afterSelectFile:a.afterSelectFile,X_afterSelect:a.confirmSelect,htmlTags:o,cssPath:[BJUI.PLUGINPATH+"kindeditor_4.1.10/editor-content.css",BJUI.PLUGINPATH+"kindeditor_4.1.10/plugins/code/prettify.css"],afterBlur:function(){this.sync()}})}),a.find('[data-toggle="colorpicker"]').each(function(){var t=e(this),a=t.data("bgcolor");t.colorpicker(),a&&t.on("changeColor",function(e){t.css("background-color",e.color.toHex())})}),a.find('[data-toggle="clearcolor"]').each(function(){var t=e(this),a=t.data("target")?e(t.data("target")):null;a&&a.length&&t.click(function(){a.val(""),a.data("bgcolor")&&a.css("background-color","")})}),a.find('[data-toggle="tooltip"]').each(function(){e(this).tooltip()}),a.find('[data-toggle="dropdown"]').parent().on("show.bs.dropdown",function(t){var a=e(this),o=a.outerWidth(),n=a.find("> .dropdown-menu"),i=n.outerWidth();o>i&&n.css("min-width",o)}),a.find('form[data-toggle="ajaxform"]').each(function(){e(this).validator({ignore:":input"}),e(this).validator("destroy")});var d=a.find('[data-toggle="highcharts"]');d.each(function(){var t=e(this),a=t.data();e.get(a.url,function(e){t.highcharts(e)},"json")});var l=a.find('[data-toggle="echarts"]');l.each(function(){var t=e(this),a=t.data(),o=a.theme?a.theme:"default",n=a.type.split(",");require.config({paths:{echarts:BJUI.PLUGINPATH+"echarts"}}),require(["echarts","echarts/theme/"+o,"echarts/chart/"+n[0],n[1]?"echarts/chart/"+n[1]:"echarts"],function(o,n){var i=o.init(t[0],n);e.get(a.url,function(e){i.setOption(e)},"json")})}),a.find('[data-toggle="lrz_file"]').each(function(){var t=e(this),a=t.data();a.done=function(e){console.log(e)},t.change(function(){lrz(t[0].files[0],a)})}),a.find('[data-toggle="qrcode"]').each(function(){var t=e(this),a=t.data();t.qrcode(a)}),a.find('[data-toggle="holder"]').each(function(){Holder.run({images:this})}),a.find('[data-toggle="cropper"]').each(function(){var t=e(this),a=t.data();a.crop=function(t){e("#dataX").val(Math.round(t.x)),e("#dataY").val(Math.round(t.y)),e("#dataHeight").val(Math.round(t.height)),e("#dataWidth").val(Math.round(t.width)),e("#dataRotate").val(Math.round(t.rotate))},t.find(".img-container > img").cropper(a)})})}(jQuery);